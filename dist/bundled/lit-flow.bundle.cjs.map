{"version":3,"file":"lit-flow.bundle.cjs","sources":["../../node_modules/d3-dispatch/src/dispatch.js","../../node_modules/d3-selection/src/namespaces.js","../../node_modules/d3-selection/src/namespace.js","../../node_modules/d3-selection/src/creator.js","../../node_modules/d3-selection/src/selector.js","../../node_modules/d3-selection/src/selection/select.js","../../node_modules/d3-selection/src/array.js","../../node_modules/d3-selection/src/selectorAll.js","../../node_modules/d3-selection/src/selection/selectAll.js","../../node_modules/d3-selection/src/matcher.js","../../node_modules/d3-selection/src/selection/selectChild.js","../../node_modules/d3-selection/src/selection/selectChildren.js","../../node_modules/d3-selection/src/selection/filter.js","../../node_modules/d3-selection/src/selection/sparse.js","../../node_modules/d3-selection/src/selection/enter.js","../../node_modules/d3-selection/src/constant.js","../../node_modules/d3-selection/src/selection/data.js","../../node_modules/d3-selection/src/selection/exit.js","../../node_modules/d3-selection/src/selection/join.js","../../node_modules/d3-selection/src/selection/merge.js","../../node_modules/d3-selection/src/selection/order.js","../../node_modules/d3-selection/src/selection/sort.js","../../node_modules/d3-selection/src/selection/call.js","../../node_modules/d3-selection/src/selection/nodes.js","../../node_modules/d3-selection/src/selection/node.js","../../node_modules/d3-selection/src/selection/size.js","../../node_modules/d3-selection/src/selection/empty.js","../../node_modules/d3-selection/src/selection/each.js","../../node_modules/d3-selection/src/selection/attr.js","../../node_modules/d3-selection/src/window.js","../../node_modules/d3-selection/src/selection/style.js","../../node_modules/d3-selection/src/selection/property.js","../../node_modules/d3-selection/src/selection/classed.js","../../node_modules/d3-selection/src/selection/text.js","../../node_modules/d3-selection/src/selection/html.js","../../node_modules/d3-selection/src/selection/raise.js","../../node_modules/d3-selection/src/selection/lower.js","../../node_modules/d3-selection/src/selection/append.js","../../node_modules/d3-selection/src/selection/insert.js","../../node_modules/d3-selection/src/selection/remove.js","../../node_modules/d3-selection/src/selection/clone.js","../../node_modules/d3-selection/src/selection/datum.js","../../node_modules/d3-selection/src/selection/on.js","../../node_modules/d3-selection/src/selection/dispatch.js","../../node_modules/d3-selection/src/selection/iterator.js","../../node_modules/d3-selection/src/selection/index.js","../../node_modules/d3-selection/src/select.js","../../node_modules/d3-selection/src/sourceEvent.js","../../node_modules/d3-selection/src/pointer.js","../../node_modules/d3-drag/src/noevent.js","../../node_modules/d3-drag/src/nodrag.js","../../node_modules/d3-color/src/define.js","../../node_modules/d3-color/src/color.js","../../node_modules/d3-interpolate/src/constant.js","../../node_modules/d3-interpolate/src/color.js","../../node_modules/d3-interpolate/src/rgb.js","../../node_modules/d3-interpolate/src/numberArray.js","../../node_modules/d3-interpolate/src/array.js","../../node_modules/d3-interpolate/src/date.js","../../node_modules/d3-interpolate/src/number.js","../../node_modules/d3-interpolate/src/object.js","../../node_modules/d3-interpolate/src/string.js","../../node_modules/d3-interpolate/src/value.js","../../node_modules/d3-interpolate/src/transform/decompose.js","../../node_modules/d3-interpolate/src/transform/parse.js","../../node_modules/d3-interpolate/src/transform/index.js","../../node_modules/d3-interpolate/src/zoom.js","../../node_modules/d3-timer/src/timer.js","../../node_modules/d3-timer/src/timeout.js","../../node_modules/d3-transition/src/transition/schedule.js","../../node_modules/d3-transition/src/interrupt.js","../../node_modules/d3-transition/src/selection/interrupt.js","../../node_modules/d3-transition/src/transition/tween.js","../../node_modules/d3-transition/src/transition/interpolate.js","../../node_modules/d3-transition/src/transition/attr.js","../../node_modules/d3-transition/src/transition/attrTween.js","../../node_modules/d3-transition/src/transition/delay.js","../../node_modules/d3-transition/src/transition/duration.js","../../node_modules/d3-transition/src/transition/ease.js","../../node_modules/d3-transition/src/transition/easeVarying.js","../../node_modules/d3-transition/src/transition/filter.js","../../node_modules/d3-transition/src/transition/merge.js","../../node_modules/d3-transition/src/transition/on.js","../../node_modules/d3-transition/src/transition/remove.js","../../node_modules/d3-transition/src/transition/select.js","../../node_modules/d3-transition/src/transition/selectAll.js","../../node_modules/d3-transition/src/transition/selection.js","../../node_modules/d3-transition/src/transition/style.js","../../node_modules/d3-transition/src/transition/styleTween.js","../../node_modules/d3-transition/src/transition/text.js","../../node_modules/d3-transition/src/transition/textTween.js","../../node_modules/d3-transition/src/transition/transition.js","../../node_modules/d3-transition/src/transition/end.js","../../node_modules/d3-transition/src/transition/index.js","../../node_modules/d3-ease/src/cubic.js","../../node_modules/d3-transition/src/selection/transition.js","../../node_modules/d3-transition/src/selection/index.js","../../node_modules/d3-zoom/src/constant.js","../../node_modules/d3-zoom/src/event.js","../../node_modules/d3-zoom/src/transform.js","../../node_modules/d3-zoom/src/noevent.js","../../node_modules/d3-zoom/src/zoom.js","../../node_modules/@xyflow/system/dist/esm/index.js","../../src/core/flow-instance.ts","../../src/core/store.ts","../../node_modules/@lit/reactive-element/css-tag.js","../../node_modules/@lit/reactive-element/reactive-element.js","../../node_modules/lit-html/lit-html.js","../../node_modules/lit-element/lit-element.js","../../node_modules/lit-html/static.js","../../node_modules/@lit/reactive-element/decorators/custom-element.js","../../node_modules/@lit/reactive-element/decorators/property.js","../../node_modules/lit-html/directive.js","../../node_modules/lit-html/directives/style-map.js","../../src/utils/geometry.ts","../../src/components/flow-canvas.ts","../../src/components/node-resizer.ts","../../src/components/flow-node.ts","../../src/components/flow-edge.ts","../../src/components/flow-background.ts","../../src/components/flow-minimap.ts","../../src/components/flow-controls.ts","../../src/components/ui/erd-table-node.ts","../../src/components/shapes/shapes/basic-shapes.ts","../../src/components/shapes/shapes/geometric-shapes.ts","../../src/components/shapes/shapes/symbolic-shapes.ts","../../src/components/shapes/shape-registry.ts","../../src/components/shapes/shape-node.ts","../../src/components/ui/base-node.ts","../../src/mixins/node-mixin.ts"],"sourcesContent":["var noop = {value: () => {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _) || /[\\s.]/.test(t)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces.js\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name; // eslint-disable-line no-prototype-builtins\n}\n","import namespace from \"./namespace.js\";\nimport {xhtml} from \"./namespaces.js\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","import {Selection} from \"./index.js\";\nimport selector from \"../selector.js\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","// Given something array like (or null), returns something that is strictly an\n// array. This is used to ensure that array-like objects passed to d3.selectAll\n// or selection.selectAll are converted into proper arrays when creating a\n// selection; we don’t ever want to create a selection backed by a live\n// HTMLCollection or NodeList. However, note that selection.selectAll will use a\n// static NodeList as a group, since it safely derived from querySelectorAll.\nexport default function array(x) {\n  return x == null ? [] : Array.isArray(x) ? x : Array.from(x);\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","import {Selection} from \"./index.js\";\nimport array from \"../array.js\";\nimport selectorAll from \"../selectorAll.js\";\n\nfunction arrayAll(select) {\n  return function() {\n    return array(select.apply(this, arguments));\n  };\n}\n\nexport default function(select) {\n  if (typeof select === \"function\") select = arrayAll(select);\n  else select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n\nexport function childMatcher(selector) {\n  return function(node) {\n    return node.matches(selector);\n  };\n}\n\n","import {childMatcher} from \"../matcher.js\";\n\nvar find = Array.prototype.find;\n\nfunction childFind(match) {\n  return function() {\n    return find.call(this.children, match);\n  };\n}\n\nfunction childFirst() {\n  return this.firstElementChild;\n}\n\nexport default function(match) {\n  return this.select(match == null ? childFirst\n      : childFind(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {childMatcher} from \"../matcher.js\";\n\nvar filter = Array.prototype.filter;\n\nfunction children() {\n  return Array.from(this.children);\n}\n\nfunction childrenFilter(match) {\n  return function() {\n    return filter.call(this.children, match);\n  };\n}\n\nexport default function(match) {\n  return this.selectAll(match == null ? children\n      : childrenFilter(typeof match === \"function\" ? match : childMatcher(match)));\n}\n","import {Selection} from \"./index.js\";\nimport matcher from \"../matcher.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import {Selection} from \"./index.js\";\nimport {EnterNode} from \"./enter.js\";\nimport constant from \"../constant.js\";\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that don’t fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = new Map,\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = key.call(node, node.__data__, i, group) + \"\";\n      if (nodeByKeyValue.has(keyValue)) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue.set(keyValue, node);\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = key.call(parent, data[i], i, data) + \"\";\n    if (node = nodeByKeyValue.get(keyValue)) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue.delete(keyValue);\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue.get(keyValues[i]) === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction datum(node) {\n  return node.__data__;\n}\n\nexport default function(value, key) {\n  if (!arguments.length) return Array.from(this, datum);\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = arraylike(value.call(parent, parent && parent.__data__, j, parents)),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n\n// Given some data, this returns an array-like view of it: an object that\n// exposes a length property and allows numeric indexing. Note that unlike\n// selectAll, this isn’t worried about “live” collections because the resulting\n// array will only be used briefly while data is being bound. (It is possible to\n// cause the data to change while iterating by using a key function, but please\n// don’t; we’d rather avoid a gratuitous copy.)\nfunction arraylike(data) {\n  return typeof data === \"object\" && \"length\" in data\n    ? data // Array, TypedArray, NodeList, array-like\n    : Array.from(data); // Map, Set, iterable, string, or anything else\n}\n","import sparse from \"./sparse.js\";\nimport {Selection} from \"./index.js\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  if (typeof onenter === \"function\") {\n    enter = onenter(enter);\n    if (enter) enter = enter.selection();\n  } else {\n    enter = enter.append(onenter + \"\");\n  }\n  if (onupdate != null) {\n    update = onupdate(update);\n    if (update) update = update.selection();\n  }\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(context) {\n  var selection = context.selection ? context.selection() : context;\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","import {Selection} from \"./index.js\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export default function() {\n  return Array.from(this);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  let size = 0;\n  for (const node of this) ++size; // eslint-disable-line no-unused-vars\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import namespace from \"../namespace.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window.js\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import creator from \"../creator.js\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","import creator from \"../creator.js\";\nimport selector from \"../selector.js\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","function contextListener(listener) {\n  return function(event) {\n    listener.call(this, event, this.__data__);\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, options) {\n  return function() {\n    var on = this.__on, o, listener = contextListener(value);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.options);\n        this.addEventListener(o.type, o.listener = listener, o.options = options);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, options);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, options: options};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, options) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, options));\n  return this;\n}\n","import defaultView from \"../window.js\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","export default function*() {\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) yield node;\n    }\n  }\n}\n","import selection_select from \"./select.js\";\nimport selection_selectAll from \"./selectAll.js\";\nimport selection_selectChild from \"./selectChild.js\";\nimport selection_selectChildren from \"./selectChildren.js\";\nimport selection_filter from \"./filter.js\";\nimport selection_data from \"./data.js\";\nimport selection_enter from \"./enter.js\";\nimport selection_exit from \"./exit.js\";\nimport selection_join from \"./join.js\";\nimport selection_merge from \"./merge.js\";\nimport selection_order from \"./order.js\";\nimport selection_sort from \"./sort.js\";\nimport selection_call from \"./call.js\";\nimport selection_nodes from \"./nodes.js\";\nimport selection_node from \"./node.js\";\nimport selection_size from \"./size.js\";\nimport selection_empty from \"./empty.js\";\nimport selection_each from \"./each.js\";\nimport selection_attr from \"./attr.js\";\nimport selection_style from \"./style.js\";\nimport selection_property from \"./property.js\";\nimport selection_classed from \"./classed.js\";\nimport selection_text from \"./text.js\";\nimport selection_html from \"./html.js\";\nimport selection_raise from \"./raise.js\";\nimport selection_lower from \"./lower.js\";\nimport selection_append from \"./append.js\";\nimport selection_insert from \"./insert.js\";\nimport selection_remove from \"./remove.js\";\nimport selection_clone from \"./clone.js\";\nimport selection_datum from \"./datum.js\";\nimport selection_on from \"./on.js\";\nimport selection_dispatch from \"./dispatch.js\";\nimport selection_iterator from \"./iterator.js\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nfunction selection_selection() {\n  return this;\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  selectChild: selection_selectChild,\n  selectChildren: selection_selectChildren,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  selection: selection_selection,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch,\n  [Symbol.iterator]: selection_iterator\n};\n\nexport default selection;\n","import {Selection, root} from \"./selection/index.js\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","export default function(event) {\n  let sourceEvent;\n  while (sourceEvent = event.sourceEvent) event = sourceEvent;\n  return event;\n}\n","import sourceEvent from \"./sourceEvent.js\";\n\nexport default function(event, node) {\n  event = sourceEvent(event);\n  if (node === undefined) node = event.currentTarget;\n  if (node) {\n    var svg = node.ownerSVGElement || node;\n    if (svg.createSVGPoint) {\n      var point = svg.createSVGPoint();\n      point.x = event.clientX, point.y = event.clientY;\n      point = point.matrixTransform(node.getScreenCTM().inverse());\n      return [point.x, point.y];\n    }\n    if (node.getBoundingClientRect) {\n      var rect = node.getBoundingClientRect();\n      return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n    }\n  }\n  return [event.pageX, event.pageY];\n}\n","// These are typically used in conjunction with noevent to ensure that we can\n// preventDefault on the event.\nexport const nonpassive = {passive: false};\nexport const nonpassivecapture = {capture: true, passive: false};\n\nexport function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {select} from \"d3-selection\";\nimport noevent, {nonpassivecapture} from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, nonpassivecapture);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, nonpassivecapture);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, nonpassivecapture);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(`^rgb\\\\(${reI},${reI},${reI}\\\\)$`),\n    reRgbPercent = new RegExp(`^rgb\\\\(${reP},${reP},${reP}\\\\)$`),\n    reRgbaInteger = new RegExp(`^rgba\\\\(${reI},${reI},${reI},${reN}\\\\)$`),\n    reRgbaPercent = new RegExp(`^rgba\\\\(${reP},${reP},${reP},${reN}\\\\)$`),\n    reHslPercent = new RegExp(`^hsl\\\\(${reN},${reP},${reP}\\\\)$`),\n    reHslaPercent = new RegExp(`^hsla\\\\(${reN},${reP},${reP},${reN}\\\\)$`);\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHex8: color_formatHex8,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHex8() {\n  return this.rgb().formatHex8();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb() {\n    return this;\n  },\n  clamp() {\n    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));\n  },\n  displayable() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatHex8: rgb_formatHex8,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;\n}\n\nfunction rgb_formatHex8() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;\n}\n\nfunction rgb_formatRgb() {\n  const a = clampa(this.opacity);\n  return `${a === 1 ? \"rgb(\" : \"rgba(\"}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? \")\" : `, ${a})`}`;\n}\n\nfunction clampa(opacity) {\n  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));\n}\n\nfunction clampi(value) {\n  return Math.max(0, Math.min(255, Math.round(value) || 0));\n}\n\nfunction hex(value) {\n  value = clampi(value);\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  clamp() {\n    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));\n  },\n  displayable() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl() {\n    const a = clampa(this.opacity);\n    return `${a === 1 ? \"hsl(\" : \"hsla(\"}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? \")\" : `, ${a})`}`;\n  }\n}));\n\nfunction clamph(value) {\n  value = (value || 0) % 360;\n  return value < 0 ? value + 360 : value;\n}\n\nfunction clampt(value) {\n  return Math.max(0, Math.min(1, value || 0));\n}\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export default x => () => x;\n","import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","export default function(a, b) {\n  if (!b) b = [];\n  var n = a ? Math.min(b.length, a.length) : 0,\n      c = b.slice(),\n      i;\n  return function(t) {\n    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;\n    return c;\n  };\n}\n\nexport function isNumberArray(x) {\n  return ArrayBuffer.isView(x) && !(x instanceof DataView);\n}\n","import value from \"./value.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  return (isNumberArray(b) ? numberArray : genericArray)(a, b);\n}\n\nexport function genericArray(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n","export default function(a, b) {\n  var d = new Date;\n  return a = +a, b = +b, function(t) {\n    return d.setTime(a * (1 - t) + b * t), d;\n  };\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n","import value from \"./value.js\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n","import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","import {color} from \"d3-color\";\nimport rgb from \"./rgb.js\";\nimport {genericArray} from \"./array.js\";\nimport date from \"./date.js\";\nimport number from \"./number.js\";\nimport object from \"./object.js\";\nimport string from \"./string.js\";\nimport constant from \"./constant.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : isNumberArray(b) ? numberArray\n      : Array.isArray(b) ? genericArray\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n","var degrees = 180 / Math.PI;\n\nexport var identity = {\n  translateX: 0,\n  translateY: 0,\n  rotate: 0,\n  skewX: 0,\n  scaleX: 1,\n  scaleY: 1\n};\n\nexport default function(a, b, c, d, e, f) {\n  var scaleX, scaleY, skewX;\n  if (scaleX = Math.sqrt(a * a + b * b)) a /= scaleX, b /= scaleX;\n  if (skewX = a * c + b * d) c -= a * skewX, d -= b * skewX;\n  if (scaleY = Math.sqrt(c * c + d * d)) c /= scaleY, d /= scaleY, skewX /= scaleY;\n  if (a * d < b * c) a = -a, b = -b, skewX = -skewX, scaleX = -scaleX;\n  return {\n    translateX: e,\n    translateY: f,\n    rotate: Math.atan2(b, a) * degrees,\n    skewX: Math.atan(skewX) * degrees,\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n","import decompose, {identity} from \"./decompose.js\";\n\nvar svgNode;\n\n/* eslint-disable no-undef */\nexport function parseCss(value) {\n  const m = new (typeof DOMMatrix === \"function\" ? DOMMatrix : WebKitCSSMatrix)(value + \"\");\n  return m.isIdentity ? identity : decompose(m.a, m.b, m.c, m.d, m.e, m.f);\n}\n\nexport function parseSvg(value) {\n  if (value == null) return identity;\n  if (!svgNode) svgNode = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\");\n  svgNode.setAttribute(\"transform\", value);\n  if (!(value = svgNode.transform.baseVal.consolidate())) return identity;\n  value = value.matrix;\n  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);\n}\n","import number from \"../number.js\";\nimport {parseCss, parseSvg} from \"./parse.js\";\n\nfunction interpolateTransform(parse, pxComma, pxParen, degParen) {\n\n  function pop(s) {\n    return s.length ? s.pop() + \" \" : \"\";\n  }\n\n  function translate(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(\"translate(\", null, pxComma, null, pxParen);\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb || yb) {\n      s.push(\"translate(\" + xb + pxComma + yb + pxParen);\n    }\n  }\n\n  function rotate(a, b, s, q) {\n    if (a !== b) {\n      if (a - b > 180) b += 360; else if (b - a > 180) a += 360; // shortest path\n      q.push({i: s.push(pop(s) + \"rotate(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"rotate(\" + b + degParen);\n    }\n  }\n\n  function skewX(a, b, s, q) {\n    if (a !== b) {\n      q.push({i: s.push(pop(s) + \"skewX(\", null, degParen) - 2, x: number(a, b)});\n    } else if (b) {\n      s.push(pop(s) + \"skewX(\" + b + degParen);\n    }\n  }\n\n  function scale(xa, ya, xb, yb, s, q) {\n    if (xa !== xb || ya !== yb) {\n      var i = s.push(pop(s) + \"scale(\", null, \",\", null, \")\");\n      q.push({i: i - 4, x: number(xa, xb)}, {i: i - 2, x: number(ya, yb)});\n    } else if (xb !== 1 || yb !== 1) {\n      s.push(pop(s) + \"scale(\" + xb + \",\" + yb + \")\");\n    }\n  }\n\n  return function(a, b) {\n    var s = [], // string constants and placeholders\n        q = []; // number interpolators\n    a = parse(a), b = parse(b);\n    translate(a.translateX, a.translateY, b.translateX, b.translateY, s, q);\n    rotate(a.rotate, b.rotate, s, q);\n    skewX(a.skewX, b.skewX, s, q);\n    scale(a.scaleX, a.scaleY, b.scaleX, b.scaleY, s, q);\n    a = b = null; // gc\n    return function(t) {\n      var i = -1, n = q.length, o;\n      while (++i < n) s[(o = q[i]).i] = o.x(t);\n      return s.join(\"\");\n    };\n  };\n}\n\nexport var interpolateTransformCss = interpolateTransform(parseCss, \"px, \", \"px)\", \"deg)\");\nexport var interpolateTransformSvg = interpolateTransform(parseSvg, \", \", \")\", \")\");\n","var epsilon2 = 1e-12;\n\nfunction cosh(x) {\n  return ((x = Math.exp(x)) + 1 / x) / 2;\n}\n\nfunction sinh(x) {\n  return ((x = Math.exp(x)) - 1 / x) / 2;\n}\n\nfunction tanh(x) {\n  return ((x = Math.exp(2 * x)) - 1) / (x + 1);\n}\n\nexport default (function zoomRho(rho, rho2, rho4) {\n\n  // p0 = [ux0, uy0, w0]\n  // p1 = [ux1, uy1, w1]\n  function zoom(p0, p1) {\n    var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],\n        ux1 = p1[0], uy1 = p1[1], w1 = p1[2],\n        dx = ux1 - ux0,\n        dy = uy1 - uy0,\n        d2 = dx * dx + dy * dy,\n        i,\n        S;\n\n    // Special case for u0 ≅ u1.\n    if (d2 < epsilon2) {\n      S = Math.log(w1 / w0) / rho;\n      i = function(t) {\n        return [\n          ux0 + t * dx,\n          uy0 + t * dy,\n          w0 * Math.exp(rho * t * S)\n        ];\n      }\n    }\n\n    // General case.\n    else {\n      var d1 = Math.sqrt(d2),\n          b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),\n          b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),\n          r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),\n          r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);\n      S = (r1 - r0) / rho;\n      i = function(t) {\n        var s = t * S,\n            coshr0 = cosh(r0),\n            u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));\n        return [\n          ux0 + u * dx,\n          uy0 + u * dy,\n          w0 * coshr0 / cosh(rho * s + r0)\n        ];\n      }\n    }\n\n    i.duration = S * 1000 * rho / Math.SQRT2;\n\n    return i;\n  }\n\n  zoom.rho = function(_) {\n    var _1 = Math.max(1e-3, +_), _2 = _1 * _1, _4 = _2 * _2;\n    return zoomRho(_1, _2, _4);\n  };\n\n  return zoom;\n})(Math.SQRT2, 2, 4);\n","var frame = 0, // is an animation frame pending?\n    timeout = 0, // is a timeout pending?\n    interval = 0, // are any timers active?\n    pokeDelay = 1000, // how frequently we check for clock skew\n    taskHead,\n    taskTail,\n    clockLast = 0,\n    clockNow = 0,\n    clockSkew = 0,\n    clock = typeof performance === \"object\" && performance.now ? performance : Date,\n    setFrame = typeof window === \"object\" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(f) { setTimeout(f, 17); };\n\nexport function now() {\n  return clockNow || (setFrame(clearNow), clockNow = clock.now() + clockSkew);\n}\n\nfunction clearNow() {\n  clockNow = 0;\n}\n\nexport function Timer() {\n  this._call =\n  this._time =\n  this._next = null;\n}\n\nTimer.prototype = timer.prototype = {\n  constructor: Timer,\n  restart: function(callback, delay, time) {\n    if (typeof callback !== \"function\") throw new TypeError(\"callback is not a function\");\n    time = (time == null ? now() : +time) + (delay == null ? 0 : +delay);\n    if (!this._next && taskTail !== this) {\n      if (taskTail) taskTail._next = this;\n      else taskHead = this;\n      taskTail = this;\n    }\n    this._call = callback;\n    this._time = time;\n    sleep();\n  },\n  stop: function() {\n    if (this._call) {\n      this._call = null;\n      this._time = Infinity;\n      sleep();\n    }\n  }\n};\n\nexport function timer(callback, delay, time) {\n  var t = new Timer;\n  t.restart(callback, delay, time);\n  return t;\n}\n\nexport function timerFlush() {\n  now(); // Get the current time, if not already set.\n  ++frame; // Pretend we’ve set an alarm, if we haven’t already.\n  var t = taskHead, e;\n  while (t) {\n    if ((e = clockNow - t._time) >= 0) t._call.call(undefined, e);\n    t = t._next;\n  }\n  --frame;\n}\n\nfunction wake() {\n  clockNow = (clockLast = clock.now()) + clockSkew;\n  frame = timeout = 0;\n  try {\n    timerFlush();\n  } finally {\n    frame = 0;\n    nap();\n    clockNow = 0;\n  }\n}\n\nfunction poke() {\n  var now = clock.now(), delay = now - clockLast;\n  if (delay > pokeDelay) clockSkew -= delay, clockLast = now;\n}\n\nfunction nap() {\n  var t0, t1 = taskHead, t2, time = Infinity;\n  while (t1) {\n    if (t1._call) {\n      if (time > t1._time) time = t1._time;\n      t0 = t1, t1 = t1._next;\n    } else {\n      t2 = t1._next, t1._next = null;\n      t1 = t0 ? t0._next = t2 : taskHead = t2;\n    }\n  }\n  taskTail = t0;\n  sleep(time);\n}\n\nfunction sleep(time) {\n  if (frame) return; // Soonest alarm already set, or will be.\n  if (timeout) timeout = clearTimeout(timeout);\n  var delay = time - clockNow; // Strictly less than if we recomputed clockNow.\n  if (delay > 24) {\n    if (time < Infinity) timeout = setTimeout(wake, time - clock.now() - clockSkew);\n    if (interval) interval = clearInterval(interval);\n  } else {\n    if (!interval) clockLast = clock.now(), interval = setInterval(poke, pokeDelay);\n    frame = 1, setFrame(wake);\n  }\n}\n","import {Timer} from \"./timer.js\";\n\nexport default function(callback, delay, time) {\n  var t = new Timer;\n  delay = delay == null ? 0 : +delay;\n  t.restart(elapsed => {\n    t.stop();\n    callback(elapsed + delay);\n  }, delay, time);\n  return t;\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {timer, timeout} from \"d3-timer\";\n\nvar emptyOn = dispatch(\"start\", \"end\", \"cancel\", \"interrupt\");\nvar emptyTween = [];\n\nexport var CREATED = 0;\nexport var SCHEDULED = 1;\nexport var STARTING = 2;\nexport var STARTED = 3;\nexport var RUNNING = 4;\nexport var ENDING = 5;\nexport var ENDED = 6;\n\nexport default function(node, name, id, index, group, timing) {\n  var schedules = node.__transition;\n  if (!schedules) node.__transition = {};\n  else if (id in schedules) return;\n  create(node, id, {\n    name: name,\n    index: index, // For context during callback.\n    group: group, // For context during callback.\n    on: emptyOn,\n    tween: emptyTween,\n    time: timing.time,\n    delay: timing.delay,\n    duration: timing.duration,\n    ease: timing.ease,\n    timer: null,\n    state: CREATED\n  });\n}\n\nexport function init(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > CREATED) throw new Error(\"too late; already scheduled\");\n  return schedule;\n}\n\nexport function set(node, id) {\n  var schedule = get(node, id);\n  if (schedule.state > STARTED) throw new Error(\"too late; already running\");\n  return schedule;\n}\n\nexport function get(node, id) {\n  var schedule = node.__transition;\n  if (!schedule || !(schedule = schedule[id])) throw new Error(\"transition not found\");\n  return schedule;\n}\n\nfunction create(node, id, self) {\n  var schedules = node.__transition,\n      tween;\n\n  // Initialize the self timer when the transition is created.\n  // Note the actual delay is not known until the first callback!\n  schedules[id] = self;\n  self.timer = timer(schedule, 0, self.time);\n\n  function schedule(elapsed) {\n    self.state = SCHEDULED;\n    self.timer.restart(start, self.delay, self.time);\n\n    // If the elapsed delay is less than our first sleep, start immediately.\n    if (self.delay <= elapsed) start(elapsed - self.delay);\n  }\n\n  function start(elapsed) {\n    var i, j, n, o;\n\n    // If the state is not SCHEDULED, then we previously errored on start.\n    if (self.state !== SCHEDULED) return stop();\n\n    for (i in schedules) {\n      o = schedules[i];\n      if (o.name !== self.name) continue;\n\n      // While this element already has a starting transition during this frame,\n      // defer starting an interrupting transition until that transition has a\n      // chance to tick (and possibly end); see d3/d3-transition#54!\n      if (o.state === STARTED) return timeout(start);\n\n      // Interrupt the active transition, if any.\n      if (o.state === RUNNING) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"interrupt\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n\n      // Cancel any pre-empted transitions.\n      else if (+i < id) {\n        o.state = ENDED;\n        o.timer.stop();\n        o.on.call(\"cancel\", node, node.__data__, o.index, o.group);\n        delete schedules[i];\n      }\n    }\n\n    // Defer the first tick to end of the current frame; see d3/d3#1576.\n    // Note the transition may be canceled after start and before the first tick!\n    // Note this must be scheduled before the start event; see d3/d3-transition#16!\n    // Assuming this is successful, subsequent callbacks go straight to tick.\n    timeout(function() {\n      if (self.state === STARTED) {\n        self.state = RUNNING;\n        self.timer.restart(tick, self.delay, self.time);\n        tick(elapsed);\n      }\n    });\n\n    // Dispatch the start event.\n    // Note this must be done before the tween are initialized.\n    self.state = STARTING;\n    self.on.call(\"start\", node, node.__data__, self.index, self.group);\n    if (self.state !== STARTING) return; // interrupted\n    self.state = STARTED;\n\n    // Initialize the tween, deleting null tween.\n    tween = new Array(n = self.tween.length);\n    for (i = 0, j = -1; i < n; ++i) {\n      if (o = self.tween[i].value.call(node, node.__data__, self.index, self.group)) {\n        tween[++j] = o;\n      }\n    }\n    tween.length = j + 1;\n  }\n\n  function tick(elapsed) {\n    var t = elapsed < self.duration ? self.ease.call(null, elapsed / self.duration) : (self.timer.restart(stop), self.state = ENDING, 1),\n        i = -1,\n        n = tween.length;\n\n    while (++i < n) {\n      tween[i].call(node, t);\n    }\n\n    // Dispatch the end event.\n    if (self.state === ENDING) {\n      self.on.call(\"end\", node, node.__data__, self.index, self.group);\n      stop();\n    }\n  }\n\n  function stop() {\n    self.state = ENDED;\n    self.timer.stop();\n    delete schedules[id];\n    for (var i in schedules) return; // eslint-disable-line no-unused-vars\n    delete node.__transition;\n  }\n}\n","import {STARTING, ENDING, ENDED} from \"./transition/schedule.js\";\n\nexport default function(node, name) {\n  var schedules = node.__transition,\n      schedule,\n      active,\n      empty = true,\n      i;\n\n  if (!schedules) return;\n\n  name = name == null ? null : name + \"\";\n\n  for (i in schedules) {\n    if ((schedule = schedules[i]).name !== name) { empty = false; continue; }\n    active = schedule.state > STARTING && schedule.state < ENDING;\n    schedule.state = ENDED;\n    schedule.timer.stop();\n    schedule.on.call(active ? \"interrupt\" : \"cancel\", node, node.__data__, schedule.index, schedule.group);\n    delete schedules[i];\n  }\n\n  if (empty) delete node.__transition;\n}\n","import interrupt from \"../interrupt.js\";\n\nexport default function(name) {\n  return this.each(function() {\n    interrupt(this, name);\n  });\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction tweenRemove(id, name) {\n  var tween0, tween1;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and we’re done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = tween0 = tween;\n      for (var i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1 = tween1.slice();\n          tween1.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nfunction tweenFunction(id, name, value) {\n  var tween0, tween1;\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    var schedule = set(this, id),\n        tween = schedule.tween;\n\n    // If this node shared tween with the previous node,\n    // just assign the updated shared tween and we’re done!\n    // Otherwise, copy-on-write.\n    if (tween !== tween0) {\n      tween1 = (tween0 = tween).slice();\n      for (var t = {name: name, value: value}, i = 0, n = tween1.length; i < n; ++i) {\n        if (tween1[i].name === name) {\n          tween1[i] = t;\n          break;\n        }\n      }\n      if (i === n) tween1.push(t);\n    }\n\n    schedule.tween = tween1;\n  };\n}\n\nexport default function(name, value) {\n  var id = this._id;\n\n  name += \"\";\n\n  if (arguments.length < 2) {\n    var tween = get(this.node(), id).tween;\n    for (var i = 0, n = tween.length, t; i < n; ++i) {\n      if ((t = tween[i]).name === name) {\n        return t.value;\n      }\n    }\n    return null;\n  }\n\n  return this.each((value == null ? tweenRemove : tweenFunction)(id, name, value));\n}\n\nexport function tweenValue(transition, name, value) {\n  var id = transition._id;\n\n  transition.each(function() {\n    var schedule = set(this, id);\n    (schedule.value || (schedule.value = {}))[name] = value.apply(this, arguments);\n  });\n\n  return function(node) {\n    return get(node, id).value[name];\n  };\n}\n","import {color} from \"d3-color\";\nimport {interpolateNumber, interpolateRgb, interpolateString} from \"d3-interpolate\";\n\nexport default function(a, b) {\n  var c;\n  return (typeof b === \"number\" ? interpolateNumber\n      : b instanceof color ? interpolateRgb\n      : (c = color(b)) ? (b = c, interpolateRgb)\n      : interpolateString)(a, b);\n}\n","import {interpolateTransformSvg as interpolateTransform} from \"d3-interpolate\";\nimport {namespace} from \"d3-selection\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttribute(name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrConstantNS(fullname, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = this.getAttributeNS(fullname.space, fullname.local);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction attrFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttribute(name);\n    string0 = this.getAttribute(name);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction attrFunctionNS(fullname, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0, value1 = value(this), string1;\n    if (value1 == null) return void this.removeAttributeNS(fullname.space, fullname.local);\n    string0 = this.getAttributeNS(fullname.space, fullname.local);\n    string1 = value1 + \"\";\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name), i = fullname === \"transform\" ? interpolateTransform : interpolate;\n  return this.attrTween(name, typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)(fullname, i, tweenValue(this, \"attr.\" + name, value))\n      : value == null ? (fullname.local ? attrRemoveNS : attrRemove)(fullname)\n      : (fullname.local ? attrConstantNS : attrConstant)(fullname, i, value));\n}\n","import {namespace} from \"d3-selection\";\n\nfunction attrInterpolate(name, i) {\n  return function(t) {\n    this.setAttribute(name, i.call(this, t));\n  };\n}\n\nfunction attrInterpolateNS(fullname, i) {\n  return function(t) {\n    this.setAttributeNS(fullname.space, fullname.local, i.call(this, t));\n  };\n}\n\nfunction attrTweenNS(fullname, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolateNS(fullname, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nfunction attrTween(name, value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && attrInterpolate(name, i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value) {\n  var key = \"attr.\" + name;\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  var fullname = namespace(name);\n  return this.tween(key, (fullname.local ? attrTweenNS : attrTween)(fullname, value));\n}\n","import {get, init} from \"./schedule.js\";\n\nfunction delayFunction(id, value) {\n  return function() {\n    init(this, id).delay = +value.apply(this, arguments);\n  };\n}\n\nfunction delayConstant(id, value) {\n  return value = +value, function() {\n    init(this, id).delay = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? delayFunction\n          : delayConstant)(id, value))\n      : get(this.node(), id).delay;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction durationFunction(id, value) {\n  return function() {\n    set(this, id).duration = +value.apply(this, arguments);\n  };\n}\n\nfunction durationConstant(id, value) {\n  return value = +value, function() {\n    set(this, id).duration = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each((typeof value === \"function\"\n          ? durationFunction\n          : durationConstant)(id, value))\n      : get(this.node(), id).duration;\n}\n","import {get, set} from \"./schedule.js\";\n\nfunction easeConstant(id, value) {\n  if (typeof value !== \"function\") throw new Error;\n  return function() {\n    set(this, id).ease = value;\n  };\n}\n\nexport default function(value) {\n  var id = this._id;\n\n  return arguments.length\n      ? this.each(easeConstant(id, value))\n      : get(this.node(), id).ease;\n}\n","import {set} from \"./schedule.js\";\n\nfunction easeVarying(id, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (typeof v !== \"function\") throw new Error;\n    set(this, id).ease = v;\n  };\n}\n\nexport default function(value) {\n  if (typeof value !== \"function\") throw new Error;\n  return this.each(easeVarying(this._id, value));\n}\n","import {matcher} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, this._name, this._id);\n}\n","import {Transition} from \"./index.js\";\n\nexport default function(transition) {\n  if (transition._id !== this._id) throw new Error;\n\n  for (var groups0 = this._groups, groups1 = transition._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Transition(merges, this._parents, this._name, this._id);\n}\n","import {get, set, init} from \"./schedule.js\";\n\nfunction start(name) {\n  return (name + \"\").trim().split(/^|\\s+/).every(function(t) {\n    var i = t.indexOf(\".\");\n    if (i >= 0) t = t.slice(0, i);\n    return !t || t === \"start\";\n  });\n}\n\nfunction onFunction(id, name, listener) {\n  var on0, on1, sit = start(name) ? init : set;\n  return function() {\n    var schedule = sit(this, id),\n        on = schedule.on;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and we’re done!\n    // Otherwise, copy-on-write.\n    if (on !== on0) (on1 = (on0 = on).copy()).on(name, listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, listener) {\n  var id = this._id;\n\n  return arguments.length < 2\n      ? get(this.node(), id).on.on(name)\n      : this.each(onFunction(id, name, listener));\n}\n","function removeFunction(id) {\n  return function() {\n    var parent = this.parentNode;\n    for (var i in this.__transition) if (+i !== id) return;\n    if (parent) parent.removeChild(this);\n  };\n}\n\nexport default function() {\n  return this.on(\"end.remove\", removeFunction(this._id));\n}\n","import {selector} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n        schedule(subgroup[i], name, id, i, subgroup, get(node, id));\n      }\n    }\n  }\n\n  return new Transition(subgroups, this._parents, name, id);\n}\n","import {selectorAll} from \"d3-selection\";\nimport {Transition} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function(select) {\n  var name = this._name,\n      id = this._id;\n\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        for (var children = select.call(node, node.__data__, i, group), child, inherit = get(node, id), k = 0, l = children.length; k < l; ++k) {\n          if (child = children[k]) {\n            schedule(child, name, id, k, children, inherit);\n          }\n        }\n        subgroups.push(children);\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Transition(subgroups, parents, name, id);\n}\n","import {selection} from \"d3-selection\";\n\nvar Selection = selection.prototype.constructor;\n\nexport default function() {\n  return new Selection(this._groups, this._parents);\n}\n","import {interpolateTransformCss as interpolateTransform} from \"d3-interpolate\";\nimport {style} from \"d3-selection\";\nimport {set} from \"./schedule.js\";\nimport {tweenValue} from \"./tween.js\";\nimport interpolate from \"./interpolate.js\";\n\nfunction styleNull(name, interpolate) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        string1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, string10 = string1);\n  };\n}\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, interpolate, value1) {\n  var string00,\n      string1 = value1 + \"\",\n      interpolate0;\n  return function() {\n    var string0 = style(this, name);\n    return string0 === string1 ? null\n        : string0 === string00 ? interpolate0\n        : interpolate0 = interpolate(string00 = string0, value1);\n  };\n}\n\nfunction styleFunction(name, interpolate, value) {\n  var string00,\n      string10,\n      interpolate0;\n  return function() {\n    var string0 = style(this, name),\n        value1 = value(this),\n        string1 = value1 + \"\";\n    if (value1 == null) string1 = value1 = (this.style.removeProperty(name), style(this, name));\n    return string0 === string1 ? null\n        : string0 === string00 && string1 === string10 ? interpolate0\n        : (string10 = string1, interpolate0 = interpolate(string00 = string0, value1));\n  };\n}\n\nfunction styleMaybeRemove(id, name) {\n  var on0, on1, listener0, key = \"style.\" + name, event = \"end.\" + key, remove;\n  return function() {\n    var schedule = set(this, id),\n        on = schedule.on,\n        listener = schedule.value[key] == null ? remove || (remove = styleRemove(name)) : undefined;\n\n    // If this node shared a dispatch with the previous node,\n    // just assign the updated shared dispatch and we’re done!\n    // Otherwise, copy-on-write.\n    if (on !== on0 || listener0 !== listener) (on1 = (on0 = on).copy()).on(event, listener0 = listener);\n\n    schedule.on = on1;\n  };\n}\n\nexport default function(name, value, priority) {\n  var i = (name += \"\") === \"transform\" ? interpolateTransform : interpolate;\n  return value == null ? this\n      .styleTween(name, styleNull(name, i))\n      .on(\"end.style.\" + name, styleRemove(name))\n    : typeof value === \"function\" ? this\n      .styleTween(name, styleFunction(name, i, tweenValue(this, \"style.\" + name, value)))\n      .each(styleMaybeRemove(this._id, name))\n    : this\n      .styleTween(name, styleConstant(name, i, value), priority)\n      .on(\"end.style.\" + name, null);\n}\n","function styleInterpolate(name, i, priority) {\n  return function(t) {\n    this.style.setProperty(name, i.call(this, t), priority);\n  };\n}\n\nfunction styleTween(name, value, priority) {\n  var t, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t = (i0 = i) && styleInterpolate(name, i, priority);\n    return t;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(name, value, priority) {\n  var key = \"style.\" + (name += \"\");\n  if (arguments.length < 2) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, styleTween(name, value, priority == null ? \"\" : priority));\n}\n","import {tweenValue} from \"./tween.js\";\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var value1 = value(this);\n    this.textContent = value1 == null ? \"\" : value1;\n  };\n}\n\nexport default function(value) {\n  return this.tween(\"text\", typeof value === \"function\"\n      ? textFunction(tweenValue(this, \"text\", value))\n      : textConstant(value == null ? \"\" : value + \"\"));\n}\n","function textInterpolate(i) {\n  return function(t) {\n    this.textContent = i.call(this, t);\n  };\n}\n\nfunction textTween(value) {\n  var t0, i0;\n  function tween() {\n    var i = value.apply(this, arguments);\n    if (i !== i0) t0 = (i0 = i) && textInterpolate(i);\n    return t0;\n  }\n  tween._value = value;\n  return tween;\n}\n\nexport default function(value) {\n  var key = \"text\";\n  if (arguments.length < 1) return (key = this.tween(key)) && key._value;\n  if (value == null) return this.tween(key, null);\n  if (typeof value !== \"function\") throw new Error;\n  return this.tween(key, textTween(value));\n}\n","import {Transition, newId} from \"./index.js\";\nimport schedule, {get} from \"./schedule.js\";\n\nexport default function() {\n  var name = this._name,\n      id0 = this._id,\n      id1 = newId();\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        var inherit = get(node, id0);\n        schedule(node, name, id1, i, group, {\n          time: inherit.time + inherit.delay + inherit.duration,\n          delay: 0,\n          duration: inherit.duration,\n          ease: inherit.ease\n        });\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id1);\n}\n","import {set} from \"./schedule.js\";\n\nexport default function() {\n  var on0, on1, that = this, id = that._id, size = that.size();\n  return new Promise(function(resolve, reject) {\n    var cancel = {value: reject},\n        end = {value: function() { if (--size === 0) resolve(); }};\n\n    that.each(function() {\n      var schedule = set(this, id),\n          on = schedule.on;\n\n      // If this node shared a dispatch with the previous node,\n      // just assign the updated shared dispatch and we’re done!\n      // Otherwise, copy-on-write.\n      if (on !== on0) {\n        on1 = (on0 = on).copy();\n        on1._.cancel.push(cancel);\n        on1._.interrupt.push(cancel);\n        on1._.end.push(end);\n      }\n\n      schedule.on = on1;\n    });\n\n    // The selection was empty, resolve end immediately\n    if (size === 0) resolve();\n  });\n}\n","import {selection} from \"d3-selection\";\nimport transition_attr from \"./attr.js\";\nimport transition_attrTween from \"./attrTween.js\";\nimport transition_delay from \"./delay.js\";\nimport transition_duration from \"./duration.js\";\nimport transition_ease from \"./ease.js\";\nimport transition_easeVarying from \"./easeVarying.js\";\nimport transition_filter from \"./filter.js\";\nimport transition_merge from \"./merge.js\";\nimport transition_on from \"./on.js\";\nimport transition_remove from \"./remove.js\";\nimport transition_select from \"./select.js\";\nimport transition_selectAll from \"./selectAll.js\";\nimport transition_selection from \"./selection.js\";\nimport transition_style from \"./style.js\";\nimport transition_styleTween from \"./styleTween.js\";\nimport transition_text from \"./text.js\";\nimport transition_textTween from \"./textTween.js\";\nimport transition_transition from \"./transition.js\";\nimport transition_tween from \"./tween.js\";\nimport transition_end from \"./end.js\";\n\nvar id = 0;\n\nexport function Transition(groups, parents, name, id) {\n  this._groups = groups;\n  this._parents = parents;\n  this._name = name;\n  this._id = id;\n}\n\nexport default function transition(name) {\n  return selection().transition(name);\n}\n\nexport function newId() {\n  return ++id;\n}\n\nvar selection_prototype = selection.prototype;\n\nTransition.prototype = transition.prototype = {\n  constructor: Transition,\n  select: transition_select,\n  selectAll: transition_selectAll,\n  selectChild: selection_prototype.selectChild,\n  selectChildren: selection_prototype.selectChildren,\n  filter: transition_filter,\n  merge: transition_merge,\n  selection: transition_selection,\n  transition: transition_transition,\n  call: selection_prototype.call,\n  nodes: selection_prototype.nodes,\n  node: selection_prototype.node,\n  size: selection_prototype.size,\n  empty: selection_prototype.empty,\n  each: selection_prototype.each,\n  on: transition_on,\n  attr: transition_attr,\n  attrTween: transition_attrTween,\n  style: transition_style,\n  styleTween: transition_styleTween,\n  text: transition_text,\n  textTween: transition_textTween,\n  remove: transition_remove,\n  tween: transition_tween,\n  delay: transition_delay,\n  duration: transition_duration,\n  ease: transition_ease,\n  easeVarying: transition_easeVarying,\n  end: transition_end,\n  [Symbol.iterator]: selection_prototype[Symbol.iterator]\n};\n","export function cubicIn(t) {\n  return t * t * t;\n}\n\nexport function cubicOut(t) {\n  return --t * t * t + 1;\n}\n\nexport function cubicInOut(t) {\n  return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\n}\n","import {Transition, newId} from \"../transition/index.js\";\nimport schedule from \"../transition/schedule.js\";\nimport {easeCubicInOut} from \"d3-ease\";\nimport {now} from \"d3-timer\";\n\nvar defaultTiming = {\n  time: null, // Set on use.\n  delay: 0,\n  duration: 250,\n  ease: easeCubicInOut\n};\n\nfunction inherit(node, id) {\n  var timing;\n  while (!(timing = node.__transition) || !(timing = timing[id])) {\n    if (!(node = node.parentNode)) {\n      throw new Error(`transition ${id} not found`);\n    }\n  }\n  return timing;\n}\n\nexport default function(name) {\n  var id,\n      timing;\n\n  if (name instanceof Transition) {\n    id = name._id, name = name._name;\n  } else {\n    id = newId(), (timing = defaultTiming).time = now(), name = name == null ? null : name + \"\";\n  }\n\n  for (var groups = this._groups, m = groups.length, j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        schedule(node, name, id, i, group, timing || inherit(node, id));\n      }\n    }\n  }\n\n  return new Transition(groups, this._parents, name, id);\n}\n","import {selection} from \"d3-selection\";\nimport selection_interrupt from \"./interrupt.js\";\nimport selection_transition from \"./transition.js\";\n\nselection.prototype.interrupt = selection_interrupt;\nselection.prototype.transition = selection_transition;\n","export default x => () => x;\n","export default function ZoomEvent(type, {\n  sourceEvent,\n  target,\n  transform,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    transform: {value: transform, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n","export function Transform(k, x, y) {\n  this.k = k;\n  this.x = x;\n  this.y = y;\n}\n\nTransform.prototype = {\n  constructor: Transform,\n  scale: function(k) {\n    return k === 1 ? this : new Transform(this.k * k, this.x, this.y);\n  },\n  translate: function(x, y) {\n    return x === 0 & y === 0 ? this : new Transform(this.k, this.x + this.k * x, this.y + this.k * y);\n  },\n  apply: function(point) {\n    return [point[0] * this.k + this.x, point[1] * this.k + this.y];\n  },\n  applyX: function(x) {\n    return x * this.k + this.x;\n  },\n  applyY: function(y) {\n    return y * this.k + this.y;\n  },\n  invert: function(location) {\n    return [(location[0] - this.x) / this.k, (location[1] - this.y) / this.k];\n  },\n  invertX: function(x) {\n    return (x - this.x) / this.k;\n  },\n  invertY: function(y) {\n    return (y - this.y) / this.k;\n  },\n  rescaleX: function(x) {\n    return x.copy().domain(x.range().map(this.invertX, this).map(x.invert, x));\n  },\n  rescaleY: function(y) {\n    return y.copy().domain(y.range().map(this.invertY, this).map(y.invert, y));\n  },\n  toString: function() {\n    return \"translate(\" + this.x + \",\" + this.y + \") scale(\" + this.k + \")\";\n  }\n};\n\nexport var identity = new Transform(1, 0, 0);\n\ntransform.prototype = Transform.prototype;\n\nexport default function transform(node) {\n  while (!node.__zoom) if (!(node = node.parentNode)) return identity;\n  return node.__zoom;\n}\n","export function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolateZoom} from \"d3-interpolate\";\nimport {select, pointer} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport ZoomEvent from \"./event.js\";\nimport {Transform, identity} from \"./transform.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\n// Ignore right-click, since that should open the context menu.\n// except for pinch-to-zoom, which is sent as a wheel+ctrlKey event\nfunction defaultFilter(event) {\n  return (!event.ctrlKey || event.type === 'wheel') && !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this;\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    if (e.hasAttribute(\"viewBox\")) {\n      e = e.viewBox.baseVal;\n      return [[e.x, e.y], [e.x + e.width, e.y + e.height]];\n    }\n    return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];\n  }\n  return [[0, 0], [e.clientWidth, e.clientHeight]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta(event) {\n  return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * (event.ctrlKey ? 10 : 1);\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(\n    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),\n    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)\n  );\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchfirst,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0,\n      tapDistance = 10;\n\n  function zoom(selection) {\n    selection\n        .property(\"__zoom\", defaultTransform)\n        .on(\"wheel.zoom\", wheeled, {passive: false})\n        .on(\"mousedown.zoom\", mousedowned)\n        .on(\"dblclick.zoom\", dblclicked)\n      .filter(touchable)\n        .on(\"touchstart.zoom\", touchstarted)\n        .on(\"touchmove.zoom\", touchmoved)\n        .on(\"touchend.zoom touchcancel.zoom\", touchended)\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function(collection, transform, point, event) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n    if (collection !== selection) {\n      schedule(collection, transform, point, event);\n    } else {\n      selection.interrupt().each(function() {\n        gesture(this, arguments)\n          .event(event)\n          .start()\n          .zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform)\n          .end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function(selection, k, p, event) {\n    zoom.scaleTo(selection, function() {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    }, p, event);\n  };\n\n  zoom.scaleTo = function(selection, k, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p,\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    }, p, event);\n  };\n\n  zoom.translateBy = function(selection, x, y, event) {\n    zoom.transform(selection, function() {\n      return constrain(this.__zoom.translate(\n        typeof x === \"function\" ? x.apply(this, arguments) : x,\n        typeof y === \"function\" ? y.apply(this, arguments) : y\n      ), extent.apply(this, arguments), translateExtent);\n    }, null, event);\n  };\n\n  zoom.translateTo = function(selection, x, y, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p;\n      return constrain(identity.translate(p0[0], p0[1]).scale(t.k).translate(\n        typeof x === \"function\" ? -x.apply(this, arguments) : -x,\n        typeof y === \"function\" ? -y.apply(this, arguments) : -y\n      ), e, translateExtent);\n    }, p, event);\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, point, event) {\n    transition\n        .on(\"start.zoom\", function() { gesture(this, arguments).event(event).start(); })\n        .on(\"interrupt.zoom end.zoom\", function() { gesture(this, arguments).event(event).end(); })\n        .tween(\"zoom\", function() {\n          var that = this,\n              args = arguments,\n              g = gesture(that, args).event(event),\n              e = extent.apply(that, args),\n              p = point == null ? centroid(e) : typeof point === \"function\" ? point.apply(that, args) : point,\n              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n              a = that.__zoom,\n              b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n          return function(t) {\n            if (t === 1) t = b; // Avoid rounding error on end.\n            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }\n            g.zoom(null, t);\n          };\n        });\n  }\n\n  function gesture(that, args, clean) {\n    return (!clean && that.__zooming) || new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.active = 0;\n    this.sourceEvent = null;\n    this.extent = extent.apply(that, args);\n    this.taps = 0;\n  }\n\n  Gesture.prototype = {\n    event: function(event) {\n      if (event) this.sourceEvent = event;\n      return this;\n    },\n    start: function() {\n      if (++this.active === 1) {\n        this.that.__zooming = this;\n        this.emit(\"start\");\n      }\n      return this;\n    },\n    zoom: function(key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) {\n        delete this.that.__zooming;\n        this.emit(\"end\");\n      }\n      return this;\n    },\n    emit: function(type) {\n      var d = select(this.that).datum();\n      listeners.call(\n        type,\n        this.that,\n        new ZoomEvent(type, {\n          sourceEvent: this.sourceEvent,\n          target: zoom,\n          type,\n          transform: this.that.__zoom,\n          dispatch: listeners\n        }),\n        d\n      );\n    }\n  };\n\n  function wheeled(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, args).event(event),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = pointer(event);\n\n    // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n      clearTimeout(g.wheel);\n    }\n\n    // If this wheel event won’t trigger a transform change, ignore it.\n    else if (t.k === k) return;\n\n    // Otherwise, capture the mouse point and location at the start.\n    else {\n      g.mouse = [p, t.invert(p)];\n      interrupt(this);\n      g.start();\n    }\n\n    noevent(event);\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned(event, ...args) {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var currentTarget = event.currentTarget,\n        g = gesture(this, args, true).event(event),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = pointer(event, currentTarget),\n        x0 = event.clientX,\n        y0 = event.clientY;\n\n    dragDisable(event.view);\n    nopropagation(event);\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved(event) {\n      noevent(event);\n      if (!g.moved) {\n        var dx = event.clientX - x0, dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n      g.event(event)\n       .zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = pointer(event, currentTarget), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped(event) {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent(event);\n      g.event(event).end();\n    }\n  }\n\n  function dblclicked(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = pointer(event.changedTouches ? event.changedTouches[0] : event, this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, args), translateExtent);\n\n    noevent(event);\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0, event);\n    else select(this).call(zoom.transform, t1, p0, event);\n  }\n\n  function touchstarted(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.touches,\n        n = touches.length,\n        g = gesture(this, args, event.changedTouches.length === n).event(event),\n        started, i, t, p;\n\n    nopropagation(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;\n      else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;\n    }\n\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n\n    if (started) {\n      if (g.taps < 2) touchfirst = p[0], touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t, p, l;\n\n    noevent(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;\n      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n    t = g.that.__zoom;\n    if (g.touch1) {\n      var p0 = g.touch0[0], l0 = g.touch0[1],\n          p1 = g.touch1[0], l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    }\n    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];\n    else return;\n\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t;\n\n    nopropagation(event);\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, touchDelay);\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;\n      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);\n    else {\n      g.end();\n      // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.\n      if (g.taps === 2) {\n        t = pointer(t, this);\n        if (Math.hypot(touchfirst[0] - t[0], touchfirst[1] - t[1]) < tapDistance) {\n          var p = select(this).on(\"dblclick.zoom\");\n          if (p) p.apply(this, arguments);\n        }\n      }\n    }\n  }\n\n  zoom.wheelDelta = function(_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function(_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function(_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function(_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function(_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  zoom.tapDistance = function(_) {\n    return arguments.length ? (tapDistance = +_, zoom) : tapDistance;\n  };\n\n  return zoom;\n}\n","import { drag } from 'd3-drag';\nimport { select, pointer } from 'd3-selection';\nimport { zoom, zoomIdentity, zoomTransform } from 'd3-zoom';\nimport { interpolateZoom, interpolate } from 'd3-interpolate';\n\nconst errorMessages = {\n    error001: () => '[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001',\n    error002: () => \"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.\",\n    error003: (nodeType) => `Node type \"${nodeType}\" not found. Using fallback type \"default\".`,\n    error004: () => 'The React Flow parent container needs a width and a height to render the graph.',\n    error005: () => 'Only child nodes can use a parent extent.',\n    error006: () => \"Can't create edge. An edge needs a source and a target.\",\n    error007: (id) => `The old edge with id=${id} does not exist.`,\n    error009: (type) => `Marker type \"${type}\" doesn't exist.`,\n    error008: (handleType, { id, sourceHandle, targetHandle }) => `Couldn't create edge for ${handleType} handle id: \"${handleType === 'source' ? sourceHandle : targetHandle}\", edge id: ${id}.`,\n    error010: () => 'Handle: No node id found. Make sure to only use a Handle inside a custom Node.',\n    error011: (edgeType) => `Edge type \"${edgeType}\" not found. Using fallback type \"default\".`,\n    error012: (id) => `Node with id \"${id}\" does not exist, it may have been removed. This can happen when a node is deleted before the \"onNodeClick\" handler is called.`,\n    error013: (lib = 'react') => `It seems that you haven't loaded the styles. Please import '@xyflow/${lib}/dist/style.css' or base.css to make sure everything is working properly.`,\n    error014: () => 'useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.',\n    error015: () => 'It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs.',\n};\nconst infiniteExtent = [\n    [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY],\n    [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY],\n];\nconst elementSelectionKeys = ['Enter', ' ', 'Escape'];\nconst defaultAriaLabelConfig = {\n    'node.a11yDescription.default': 'Press enter or space to select a node. Press delete to remove it and escape to cancel.',\n    'node.a11yDescription.keyboardDisabled': 'Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.',\n    'node.a11yDescription.ariaLiveMessage': ({ direction, x, y }) => `Moved selected node ${direction}. New position, x: ${x}, y: ${y}`,\n    'edge.a11yDescription.default': 'Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.',\n    // Control elements\n    'controls.ariaLabel': 'Control Panel',\n    'controls.zoomIn.ariaLabel': 'Zoom In',\n    'controls.zoomOut.ariaLabel': 'Zoom Out',\n    'controls.fitView.ariaLabel': 'Fit View',\n    'controls.interactive.ariaLabel': 'Toggle Interactivity',\n    // Mini map\n    'minimap.ariaLabel': 'Mini Map',\n    // Handle\n    'handle.ariaLabel': 'Handle',\n};\n\n/**\n * The `ConnectionMode` is used to set the mode of connection between nodes.\n * The `Strict` mode is the default one and only allows source to target edges.\n * `Loose` mode allows source to source and target to target edges as well.\n *\n * @public\n */\nvar ConnectionMode;\n(function (ConnectionMode) {\n    ConnectionMode[\"Strict\"] = \"strict\";\n    ConnectionMode[\"Loose\"] = \"loose\";\n})(ConnectionMode || (ConnectionMode = {}));\n/**\n * This enum is used to set the different modes of panning the viewport when the\n * user scrolls. The `Free` mode allows the user to pan in any direction by scrolling\n * with a device like a trackpad. The `Vertical` and `Horizontal` modes restrict\n * scroll panning to only the vertical or horizontal axis, respectively.\n *\n * @public\n */\nvar PanOnScrollMode;\n(function (PanOnScrollMode) {\n    PanOnScrollMode[\"Free\"] = \"free\";\n    PanOnScrollMode[\"Vertical\"] = \"vertical\";\n    PanOnScrollMode[\"Horizontal\"] = \"horizontal\";\n})(PanOnScrollMode || (PanOnScrollMode = {}));\nvar SelectionMode;\n(function (SelectionMode) {\n    SelectionMode[\"Partial\"] = \"partial\";\n    SelectionMode[\"Full\"] = \"full\";\n})(SelectionMode || (SelectionMode = {}));\nconst initialConnection = {\n    inProgress: false,\n    isValid: null,\n    from: null,\n    fromHandle: null,\n    fromPosition: null,\n    fromNode: null,\n    to: null,\n    toHandle: null,\n    toPosition: null,\n    toNode: null,\n};\n\n/**\n * If you set the `connectionLineType` prop on your [`<ReactFlow />`](/api-reference/react-flow#connection-connectionLineType)\n *component, it will dictate the style of connection line rendered when creating\n *new edges.\n *\n * @public\n *\n * @remarks If you choose to render a custom connection line component, this value will be\n *passed to your component as part of its [`ConnectionLineComponentProps`](/api-reference/types/connection-line-component-props).\n */\nvar ConnectionLineType;\n(function (ConnectionLineType) {\n    ConnectionLineType[\"Bezier\"] = \"default\";\n    ConnectionLineType[\"Straight\"] = \"straight\";\n    ConnectionLineType[\"Step\"] = \"step\";\n    ConnectionLineType[\"SmoothStep\"] = \"smoothstep\";\n    ConnectionLineType[\"SimpleBezier\"] = \"simplebezier\";\n})(ConnectionLineType || (ConnectionLineType = {}));\n/**\n * Edges may optionally have a marker on either end. The MarkerType type enumerates\n * the options available to you when configuring a given marker.\n *\n * @public\n */\nvar MarkerType;\n(function (MarkerType) {\n    MarkerType[\"Arrow\"] = \"arrow\";\n    MarkerType[\"ArrowClosed\"] = \"arrowclosed\";\n})(MarkerType || (MarkerType = {}));\n\n/**\n * While [`PanelPosition`](/api-reference/types/panel-position) can be used to place a\n * component in the corners of a container, the `Position` enum is less precise and used\n * primarily in relation to edges and handles.\n *\n * @public\n */\nvar Position;\n(function (Position) {\n    Position[\"Left\"] = \"left\";\n    Position[\"Top\"] = \"top\";\n    Position[\"Right\"] = \"right\";\n    Position[\"Bottom\"] = \"bottom\";\n})(Position || (Position = {}));\nconst oppositePosition = {\n    [Position.Left]: Position.Right,\n    [Position.Right]: Position.Left,\n    [Position.Top]: Position.Bottom,\n    [Position.Bottom]: Position.Top,\n};\n\n/**\n * @internal\n */\nfunction areConnectionMapsEqual(a, b) {\n    if (!a && !b) {\n        return true;\n    }\n    if (!a || !b || a.size !== b.size) {\n        return false;\n    }\n    if (!a.size && !b.size) {\n        return true;\n    }\n    for (const key of a.keys()) {\n        if (!b.has(key)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * We call the callback for all connections in a that are not in b\n *\n * @internal\n */\nfunction handleConnectionChange(a, b, cb) {\n    if (!cb) {\n        return;\n    }\n    const diff = [];\n    a.forEach((connection, key) => {\n        if (!b?.has(key)) {\n            diff.push(connection);\n        }\n    });\n    if (diff.length) {\n        cb(diff);\n    }\n}\nfunction getConnectionStatus(isValid) {\n    return isValid === null ? null : isValid ? 'valid' : 'invalid';\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Test whether an object is usable as an Edge\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Edge if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Edge\n */\nconst isEdgeBase = (element) => 'id' in element && 'source' in element && 'target' in element;\n/**\n * Test whether an object is usable as a Node\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Node if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Node\n */\nconst isNodeBase = (element) => 'id' in element && 'position' in element && !('source' in element) && !('target' in element);\nconst isInternalNodeBase = (element) => 'id' in element && 'internals' in element && !('source' in element) && !('target' in element);\n/**\n * This util is used to tell you what nodes, if any, are connected to the given node\n * as the _target_ of an edge.\n * @public\n * @param node - The node to get the connected nodes from.\n * @param nodes - The array of all nodes.\n * @param edges - The array of all edges.\n * @returns An array of nodes that are connected over edges where the source is the given node.\n *\n * @example\n * ```ts\n *import { getOutgoers } from '@xyflow/react';\n *\n *const nodes = [];\n *const edges = [];\n *\n *const outgoers = getOutgoers(\n *  { id: '1', position: { x: 0, y: 0 }, data: { label: 'node' } },\n *  nodes,\n *  edges,\n *);\n *```\n */\nconst getOutgoers = (node, nodes, edges) => {\n    if (!node.id) {\n        return [];\n    }\n    const outgoerIds = new Set();\n    edges.forEach((edge) => {\n        if (edge.source === node.id) {\n            outgoerIds.add(edge.target);\n        }\n    });\n    return nodes.filter((n) => outgoerIds.has(n.id));\n};\n/**\n * This util is used to tell you what nodes, if any, are connected to the given node\n * as the _source_ of an edge.\n * @public\n * @param node - The node to get the connected nodes from.\n * @param nodes - The array of all nodes.\n * @param edges - The array of all edges.\n * @returns An array of nodes that are connected over edges where the target is the given node.\n *\n * @example\n * ```ts\n *import { getIncomers } from '@xyflow/react';\n *\n *const nodes = [];\n *const edges = [];\n *\n *const incomers = getIncomers(\n *  { id: '1', position: { x: 0, y: 0 }, data: { label: 'node' } },\n *  nodes,\n *  edges,\n *);\n *```\n */\nconst getIncomers = (node, nodes, edges) => {\n    if (!node.id) {\n        return [];\n    }\n    const incomersIds = new Set();\n    edges.forEach((edge) => {\n        if (edge.target === node.id) {\n            incomersIds.add(edge.source);\n        }\n    });\n    return nodes.filter((n) => incomersIds.has(n.id));\n};\nconst getNodePositionWithOrigin = (node, nodeOrigin = [0, 0]) => {\n    const { width, height } = getNodeDimensions(node);\n    const origin = node.origin ?? nodeOrigin;\n    const offsetX = width * origin[0];\n    const offsetY = height * origin[1];\n    return {\n        x: node.position.x - offsetX,\n        y: node.position.y - offsetY,\n    };\n};\n/**\n * Returns the bounding box that contains all the given nodes in an array. This can\n * be useful when combined with [`getViewportForBounds`](/api-reference/utils/get-viewport-for-bounds)\n * to calculate the correct transform to fit the given nodes in a viewport.\n * @public\n * @remarks Useful when combined with {@link getViewportForBounds} to calculate the correct transform to fit the given nodes in a viewport.\n * @param nodes - Nodes to calculate the bounds for.\n * @returns Bounding box enclosing all nodes.\n *\n * @remarks This function was previously called `getRectOfNodes`\n *\n * @example\n * ```js\n *import { getNodesBounds } from '@xyflow/react';\n *\n *const nodes = [\n *  {\n *    id: 'a',\n *    position: { x: 0, y: 0 },\n *    data: { label: 'a' },\n *    width: 50,\n *    height: 25,\n *  },\n *  {\n *    id: 'b',\n *    position: { x: 100, y: 100 },\n *    data: { label: 'b' },\n *    width: 50,\n *    height: 25,\n *  },\n *];\n *\n *const bounds = getNodesBounds(nodes);\n *```\n */\nconst getNodesBounds = (nodes, params = { nodeOrigin: [0, 0] }) => {\n    if (process.env.NODE_ENV === 'development' && !params.nodeLookup) {\n        console.warn('Please use `getNodesBounds` from `useReactFlow`/`useSvelteFlow` hook to ensure correct values for sub flows. If not possible, you have to provide a nodeLookup to support sub flows.');\n    }\n    if (nodes.length === 0) {\n        return { x: 0, y: 0, width: 0, height: 0 };\n    }\n    const box = nodes.reduce((currBox, nodeOrId) => {\n        const isId = typeof nodeOrId === 'string';\n        let currentNode = !params.nodeLookup && !isId ? nodeOrId : undefined;\n        if (params.nodeLookup) {\n            currentNode = isId\n                ? params.nodeLookup.get(nodeOrId)\n                : !isInternalNodeBase(nodeOrId)\n                    ? params.nodeLookup.get(nodeOrId.id)\n                    : nodeOrId;\n        }\n        const nodeBox = currentNode ? nodeToBox(currentNode, params.nodeOrigin) : { x: 0, y: 0, x2: 0, y2: 0 };\n        return getBoundsOfBoxes(currBox, nodeBox);\n    }, { x: Infinity, y: Infinity, x2: -Infinity, y2: -Infinity });\n    return boxToRect(box);\n};\n/**\n * Determines a bounding box that contains all given nodes in an array\n * @internal\n */\nconst getInternalNodesBounds = (nodeLookup, params = {}) => {\n    if (nodeLookup.size === 0) {\n        return { x: 0, y: 0, width: 0, height: 0 };\n    }\n    let box = { x: Infinity, y: Infinity, x2: -Infinity, y2: -Infinity };\n    nodeLookup.forEach((node) => {\n        if (params.filter === undefined || params.filter(node)) {\n            const nodeBox = nodeToBox(node);\n            box = getBoundsOfBoxes(box, nodeBox);\n        }\n    });\n    return boxToRect(box);\n};\nconst getNodesInside = (nodes, rect, [tx, ty, tScale] = [0, 0, 1], partially = false, \n// set excludeNonSelectableNodes if you want to pay attention to the nodes \"selectable\" attribute\nexcludeNonSelectableNodes = false) => {\n    const paneRect = {\n        ...pointToRendererPoint(rect, [tx, ty, tScale]),\n        width: rect.width / tScale,\n        height: rect.height / tScale,\n    };\n    const visibleNodes = [];\n    for (const node of nodes.values()) {\n        const { measured, selectable = true, hidden = false } = node;\n        if ((excludeNonSelectableNodes && !selectable) || hidden) {\n            continue;\n        }\n        const width = measured.width ?? node.width ?? node.initialWidth ?? null;\n        const height = measured.height ?? node.height ?? node.initialHeight ?? null;\n        const overlappingArea = getOverlappingArea(paneRect, nodeToRect(node));\n        const area = (width ?? 0) * (height ?? 0);\n        const partiallyVisible = partially && overlappingArea > 0;\n        const forceInitialRender = !node.internals.handleBounds;\n        const isVisible = forceInitialRender || partiallyVisible || overlappingArea >= area;\n        if (isVisible || node.dragging) {\n            visibleNodes.push(node);\n        }\n    }\n    return visibleNodes;\n};\n/**\n * This utility filters an array of edges, keeping only those where either the source or target\n * node is present in the given array of nodes.\n * @public\n * @param nodes - Nodes you want to get the connected edges for.\n * @param edges - All edges.\n * @returns Array of edges that connect any of the given nodes with each other.\n *\n * @example\n * ```js\n *import { getConnectedEdges } from '@xyflow/react';\n *\n *const nodes = [\n *  { id: 'a', position: { x: 0, y: 0 } },\n *  { id: 'b', position: { x: 100, y: 0 } },\n *];\n *\n *const edges = [\n *  { id: 'a->c', source: 'a', target: 'c' },\n *  { id: 'c->d', source: 'c', target: 'd' },\n *];\n *\n *const connectedEdges = getConnectedEdges(nodes, edges);\n * // => [{ id: 'a->c', source: 'a', target: 'c' }]\n *```\n */\nconst getConnectedEdges = (nodes, edges) => {\n    const nodeIds = new Set();\n    nodes.forEach((node) => {\n        nodeIds.add(node.id);\n    });\n    return edges.filter((edge) => nodeIds.has(edge.source) || nodeIds.has(edge.target));\n};\nfunction getFitViewNodes(nodeLookup, options) {\n    const fitViewNodes = new Map();\n    const optionNodeIds = options?.nodes ? new Set(options.nodes.map((node) => node.id)) : null;\n    nodeLookup.forEach((n) => {\n        const isVisible = n.measured.width && n.measured.height && (options?.includeHiddenNodes || !n.hidden);\n        if (isVisible && (!optionNodeIds || optionNodeIds.has(n.id))) {\n            fitViewNodes.set(n.id, n);\n        }\n    });\n    return fitViewNodes;\n}\nasync function fitViewport({ nodes, width, height, panZoom, minZoom, maxZoom }, options) {\n    if (nodes.size === 0) {\n        return Promise.resolve(true);\n    }\n    const nodesToFit = getFitViewNodes(nodes, options);\n    const bounds = getInternalNodesBounds(nodesToFit);\n    const viewport = getViewportForBounds(bounds, width, height, options?.minZoom ?? minZoom, options?.maxZoom ?? maxZoom, options?.padding ?? 0.1);\n    await panZoom.setViewport(viewport, {\n        duration: options?.duration,\n        ease: options?.ease,\n        interpolate: options?.interpolate,\n    });\n    return Promise.resolve(true);\n}\n/**\n * This function calculates the next position of a node, taking into account the node's extent, parent node, and origin.\n *\n * @internal\n * @returns position, positionAbsolute\n */\nfunction calculateNodePosition({ nodeId, nextPosition, nodeLookup, nodeOrigin = [0, 0], nodeExtent, onError, }) {\n    const node = nodeLookup.get(nodeId);\n    const parentNode = node.parentId ? nodeLookup.get(node.parentId) : undefined;\n    const { x: parentX, y: parentY } = parentNode ? parentNode.internals.positionAbsolute : { x: 0, y: 0 };\n    const origin = node.origin ?? nodeOrigin;\n    let extent = node.extent || nodeExtent;\n    if (node.extent === 'parent' && !node.expandParent) {\n        if (!parentNode) {\n            onError?.('005', errorMessages['error005']());\n        }\n        else {\n            const parentWidth = parentNode.measured.width;\n            const parentHeight = parentNode.measured.height;\n            if (parentWidth && parentHeight) {\n                extent = [\n                    [parentX, parentY],\n                    [parentX + parentWidth, parentY + parentHeight],\n                ];\n            }\n        }\n    }\n    else if (parentNode && isCoordinateExtent(node.extent)) {\n        extent = [\n            [node.extent[0][0] + parentX, node.extent[0][1] + parentY],\n            [node.extent[1][0] + parentX, node.extent[1][1] + parentY],\n        ];\n    }\n    const positionAbsolute = isCoordinateExtent(extent)\n        ? clampPosition(nextPosition, extent, node.measured)\n        : nextPosition;\n    if (node.measured.width === undefined || node.measured.height === undefined) {\n        onError?.('015', errorMessages['error015']());\n    }\n    return {\n        position: {\n            x: positionAbsolute.x - parentX + (node.measured.width ?? 0) * origin[0],\n            y: positionAbsolute.y - parentY + (node.measured.height ?? 0) * origin[1],\n        },\n        positionAbsolute,\n    };\n}\n/**\n * Pass in nodes & edges to delete, get arrays of nodes and edges that actually can be deleted\n * @internal\n * @param param.nodesToRemove - The nodes to remove\n * @param param.edgesToRemove - The edges to remove\n * @param param.nodes - All nodes\n * @param param.edges - All edges\n * @param param.onBeforeDelete - Callback to check which nodes and edges can be deleted\n * @returns nodes: nodes that can be deleted, edges: edges that can be deleted\n */\nasync function getElementsToRemove({ nodesToRemove = [], edgesToRemove = [], nodes, edges, onBeforeDelete, }) {\n    const nodeIds = new Set(nodesToRemove.map((node) => node.id));\n    const matchingNodes = [];\n    for (const node of nodes) {\n        if (node.deletable === false) {\n            continue;\n        }\n        const isIncluded = nodeIds.has(node.id);\n        const parentHit = !isIncluded && node.parentId && matchingNodes.find((n) => n.id === node.parentId);\n        if (isIncluded || parentHit) {\n            matchingNodes.push(node);\n        }\n    }\n    const edgeIds = new Set(edgesToRemove.map((edge) => edge.id));\n    const deletableEdges = edges.filter((edge) => edge.deletable !== false);\n    const connectedEdges = getConnectedEdges(matchingNodes, deletableEdges);\n    const matchingEdges = connectedEdges;\n    for (const edge of deletableEdges) {\n        const isIncluded = edgeIds.has(edge.id);\n        if (isIncluded && !matchingEdges.find((e) => e.id === edge.id)) {\n            matchingEdges.push(edge);\n        }\n    }\n    if (!onBeforeDelete) {\n        return {\n            edges: matchingEdges,\n            nodes: matchingNodes,\n        };\n    }\n    const onBeforeDeleteResult = await onBeforeDelete({\n        nodes: matchingNodes,\n        edges: matchingEdges,\n    });\n    if (typeof onBeforeDeleteResult === 'boolean') {\n        return onBeforeDeleteResult ? { edges: matchingEdges, nodes: matchingNodes } : { edges: [], nodes: [] };\n    }\n    return onBeforeDeleteResult;\n}\n\nconst clamp = (val, min = 0, max = 1) => Math.min(Math.max(val, min), max);\nconst clampPosition = (position = { x: 0, y: 0 }, extent, dimensions) => ({\n    x: clamp(position.x, extent[0][0], extent[1][0] - (dimensions?.width ?? 0)),\n    y: clamp(position.y, extent[0][1], extent[1][1] - (dimensions?.height ?? 0)),\n});\nfunction clampPositionToParent(childPosition, childDimensions, parent) {\n    const { width: parentWidth, height: parentHeight } = getNodeDimensions(parent);\n    const { x: parentX, y: parentY } = parent.internals.positionAbsolute;\n    return clampPosition(childPosition, [\n        [parentX, parentY],\n        [parentX + parentWidth, parentY + parentHeight],\n    ], childDimensions);\n}\n/**\n * Calculates the velocity of panning when the mouse is close to the edge of the canvas\n * @internal\n * @param value - One dimensional poition of the mouse (x or y)\n * @param min - Minimal position on canvas before panning starts\n * @param max - Maximal position on canvas before panning starts\n * @returns - A number between 0 and 1 that represents the velocity of panning\n */\nconst calcAutoPanVelocity = (value, min, max) => {\n    if (value < min) {\n        return clamp(Math.abs(value - min), 1, min) / min;\n    }\n    else if (value > max) {\n        return -clamp(Math.abs(value - max), 1, min) / min;\n    }\n    return 0;\n};\nconst calcAutoPan = (pos, bounds, speed = 15, distance = 40) => {\n    const xMovement = calcAutoPanVelocity(pos.x, distance, bounds.width - distance) * speed;\n    const yMovement = calcAutoPanVelocity(pos.y, distance, bounds.height - distance) * speed;\n    return [xMovement, yMovement];\n};\nconst getBoundsOfBoxes = (box1, box2) => ({\n    x: Math.min(box1.x, box2.x),\n    y: Math.min(box1.y, box2.y),\n    x2: Math.max(box1.x2, box2.x2),\n    y2: Math.max(box1.y2, box2.y2),\n});\nconst rectToBox = ({ x, y, width, height }) => ({\n    x,\n    y,\n    x2: x + width,\n    y2: y + height,\n});\nconst boxToRect = ({ x, y, x2, y2 }) => ({\n    x,\n    y,\n    width: x2 - x,\n    height: y2 - y,\n});\nconst nodeToRect = (node, nodeOrigin = [0, 0]) => {\n    const { x, y } = isInternalNodeBase(node)\n        ? node.internals.positionAbsolute\n        : getNodePositionWithOrigin(node, nodeOrigin);\n    return {\n        x,\n        y,\n        width: node.measured?.width ?? node.width ?? node.initialWidth ?? 0,\n        height: node.measured?.height ?? node.height ?? node.initialHeight ?? 0,\n    };\n};\nconst nodeToBox = (node, nodeOrigin = [0, 0]) => {\n    const { x, y } = isInternalNodeBase(node)\n        ? node.internals.positionAbsolute\n        : getNodePositionWithOrigin(node, nodeOrigin);\n    return {\n        x,\n        y,\n        x2: x + (node.measured?.width ?? node.width ?? node.initialWidth ?? 0),\n        y2: y + (node.measured?.height ?? node.height ?? node.initialHeight ?? 0),\n    };\n};\nconst getBoundsOfRects = (rect1, rect2) => boxToRect(getBoundsOfBoxes(rectToBox(rect1), rectToBox(rect2)));\nconst getOverlappingArea = (rectA, rectB) => {\n    const xOverlap = Math.max(0, Math.min(rectA.x + rectA.width, rectB.x + rectB.width) - Math.max(rectA.x, rectB.x));\n    const yOverlap = Math.max(0, Math.min(rectA.y + rectA.height, rectB.y + rectB.height) - Math.max(rectA.y, rectB.y));\n    return Math.ceil(xOverlap * yOverlap);\n};\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst isRectObject = (obj) => isNumeric(obj.width) && isNumeric(obj.height) && isNumeric(obj.x) && isNumeric(obj.y);\n/* eslint-disable-next-line @typescript-eslint/no-explicit-any */\nconst isNumeric = (n) => !isNaN(n) && isFinite(n);\n// used for a11y key board controls for nodes and edges\nconst devWarn = (id, message) => {\n    if (process.env.NODE_ENV === 'development') {\n        console.warn(`[React Flow]: ${message} Help: https://reactflow.dev/error#${id}`);\n    }\n};\nconst snapPosition = (position, snapGrid = [1, 1]) => {\n    return {\n        x: snapGrid[0] * Math.round(position.x / snapGrid[0]),\n        y: snapGrid[1] * Math.round(position.y / snapGrid[1]),\n    };\n};\nconst pointToRendererPoint = ({ x, y }, [tx, ty, tScale], snapToGrid = false, snapGrid = [1, 1]) => {\n    const position = {\n        x: (x - tx) / tScale,\n        y: (y - ty) / tScale,\n    };\n    return snapToGrid ? snapPosition(position, snapGrid) : position;\n};\nconst rendererPointToPoint = ({ x, y }, [tx, ty, tScale]) => {\n    return {\n        x: x * tScale + tx,\n        y: y * tScale + ty,\n    };\n};\n/**\n * Parses a single padding value to a number\n * @internal\n * @param padding - Padding to parse\n * @param viewport - Width or height of the viewport\n * @returns The padding in pixels\n */\nfunction parsePadding(padding, viewport) {\n    if (typeof padding === 'number') {\n        return Math.floor((viewport - viewport / (1 + padding)) * 0.5);\n    }\n    if (typeof padding === 'string' && padding.endsWith('px')) {\n        const paddingValue = parseFloat(padding);\n        if (!Number.isNaN(paddingValue)) {\n            return Math.floor(paddingValue);\n        }\n    }\n    if (typeof padding === 'string' && padding.endsWith('%')) {\n        const paddingValue = parseFloat(padding);\n        if (!Number.isNaN(paddingValue)) {\n            return Math.floor(viewport * paddingValue * 0.01);\n        }\n    }\n    console.error(`[React Flow] The padding value \"${padding}\" is invalid. Please provide a number or a string with a valid unit (px or %).`);\n    return 0;\n}\n/**\n * Parses the paddings to an object with top, right, bottom, left, x and y paddings\n * @internal\n * @param padding - Padding to parse\n * @param width - Width of the viewport\n * @param height - Height of the viewport\n * @returns An object with the paddings in pixels\n */\nfunction parsePaddings(padding, width, height) {\n    if (typeof padding === 'string' || typeof padding === 'number') {\n        const paddingY = parsePadding(padding, height);\n        const paddingX = parsePadding(padding, width);\n        return {\n            top: paddingY,\n            right: paddingX,\n            bottom: paddingY,\n            left: paddingX,\n            x: paddingX * 2,\n            y: paddingY * 2,\n        };\n    }\n    if (typeof padding === 'object') {\n        const top = parsePadding(padding.top ?? padding.y ?? 0, height);\n        const bottom = parsePadding(padding.bottom ?? padding.y ?? 0, height);\n        const left = parsePadding(padding.left ?? padding.x ?? 0, width);\n        const right = parsePadding(padding.right ?? padding.x ?? 0, width);\n        return { top, right, bottom, left, x: left + right, y: top + bottom };\n    }\n    return { top: 0, right: 0, bottom: 0, left: 0, x: 0, y: 0 };\n}\n/**\n * Calculates the resulting paddings if the new viewport is applied\n * @internal\n * @param bounds - Bounds to fit inside viewport\n * @param x - X position of the viewport\n * @param y - Y position of the viewport\n * @param zoom - Zoom level of the viewport\n * @param width - Width of the viewport\n * @param height - Height of the viewport\n * @returns An object with the minimum padding required to fit the bounds inside the viewport\n */\nfunction calculateAppliedPaddings(bounds, x, y, zoom, width, height) {\n    const { x: left, y: top } = rendererPointToPoint(bounds, [x, y, zoom]);\n    const { x: boundRight, y: boundBottom } = rendererPointToPoint({ x: bounds.x + bounds.width, y: bounds.y + bounds.height }, [x, y, zoom]);\n    const right = width - boundRight;\n    const bottom = height - boundBottom;\n    return {\n        left: Math.floor(left),\n        top: Math.floor(top),\n        right: Math.floor(right),\n        bottom: Math.floor(bottom),\n    };\n}\n/**\n * Returns a viewport that encloses the given bounds with padding.\n * @public\n * @remarks You can determine bounds of nodes with {@link getNodesBounds} and {@link getBoundsOfRects}\n * @param bounds - Bounds to fit inside viewport.\n * @param width - Width of the viewport.\n * @param height  - Height of the viewport.\n * @param minZoom - Minimum zoom level of the resulting viewport.\n * @param maxZoom - Maximum zoom level of the resulting viewport.\n * @param padding - Padding around the bounds.\n * @returns A transformed {@link Viewport} that encloses the given bounds which you can pass to e.g. {@link setViewport}.\n * @example\n * const { x, y, zoom } = getViewportForBounds(\n * { x: 0, y: 0, width: 100, height: 100},\n * 1200, 800, 0.5, 2);\n */\nconst getViewportForBounds = (bounds, width, height, minZoom, maxZoom, padding) => {\n    // First we resolve all the paddings to actual pixel values\n    const p = parsePaddings(padding, width, height);\n    const xZoom = (width - p.x) / bounds.width;\n    const yZoom = (height - p.y) / bounds.height;\n    // We calculate the new x, y, zoom for a centered view\n    const zoom = Math.min(xZoom, yZoom);\n    const clampedZoom = clamp(zoom, minZoom, maxZoom);\n    const boundsCenterX = bounds.x + bounds.width / 2;\n    const boundsCenterY = bounds.y + bounds.height / 2;\n    const x = width / 2 - boundsCenterX * clampedZoom;\n    const y = height / 2 - boundsCenterY * clampedZoom;\n    // Then we calculate the minimum padding, to respect asymmetric paddings\n    const newPadding = calculateAppliedPaddings(bounds, x, y, clampedZoom, width, height);\n    // We only want to have an offset if the newPadding is smaller than the required padding\n    const offset = {\n        left: Math.min(newPadding.left - p.left, 0),\n        top: Math.min(newPadding.top - p.top, 0),\n        right: Math.min(newPadding.right - p.right, 0),\n        bottom: Math.min(newPadding.bottom - p.bottom, 0),\n    };\n    return {\n        x: x - offset.left + offset.right,\n        y: y - offset.top + offset.bottom,\n        zoom: clampedZoom,\n    };\n};\nconst isMacOs = () => typeof navigator !== 'undefined' && navigator?.userAgent?.indexOf('Mac') >= 0;\nfunction isCoordinateExtent(extent) {\n    return extent !== undefined && extent !== null && extent !== 'parent';\n}\nfunction getNodeDimensions(node) {\n    return {\n        width: node.measured?.width ?? node.width ?? node.initialWidth ?? 0,\n        height: node.measured?.height ?? node.height ?? node.initialHeight ?? 0,\n    };\n}\nfunction nodeHasDimensions(node) {\n    return ((node.measured?.width ?? node.width ?? node.initialWidth) !== undefined &&\n        (node.measured?.height ?? node.height ?? node.initialHeight) !== undefined);\n}\n/**\n * Convert child position to aboslute position\n *\n * @internal\n * @param position\n * @param parentId\n * @param nodeLookup\n * @param nodeOrigin\n * @returns an internal node with an absolute position\n */\nfunction evaluateAbsolutePosition(position, dimensions = { width: 0, height: 0 }, parentId, nodeLookup, nodeOrigin) {\n    const positionAbsolute = { ...position };\n    const parent = nodeLookup.get(parentId);\n    if (parent) {\n        const origin = parent.origin || nodeOrigin;\n        positionAbsolute.x += parent.internals.positionAbsolute.x - (dimensions.width ?? 0) * origin[0];\n        positionAbsolute.y += parent.internals.positionAbsolute.y - (dimensions.height ?? 0) * origin[1];\n    }\n    return positionAbsolute;\n}\nfunction areSetsEqual(a, b) {\n    if (a.size !== b.size) {\n        return false;\n    }\n    for (const item of a) {\n        if (!b.has(item)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Polyfill for Promise.withResolvers until we can use it in all browsers\n * @internal\n */\nfunction withResolvers() {\n    let resolve;\n    let reject;\n    const promise = new Promise((res, rej) => {\n        resolve = res;\n        reject = rej;\n    });\n    return { promise, resolve, reject };\n}\nfunction mergeAriaLabelConfig(partial) {\n    return { ...defaultAriaLabelConfig, ...(partial || {}) };\n}\n\nfunction getPointerPosition(event, { snapGrid = [0, 0], snapToGrid = false, transform, containerBounds }) {\n    const { x, y } = getEventPosition(event);\n    const pointerPos = pointToRendererPoint({ x: x - (containerBounds?.left ?? 0), y: y - (containerBounds?.top ?? 0) }, transform);\n    const { x: xSnapped, y: ySnapped } = snapToGrid ? snapPosition(pointerPos, snapGrid) : pointerPos;\n    // we need the snapped position in order to be able to skip unnecessary drag events\n    return {\n        xSnapped,\n        ySnapped,\n        ...pointerPos,\n    };\n}\nconst getDimensions = (node) => ({\n    width: node.offsetWidth,\n    height: node.offsetHeight,\n});\nconst getHostForElement = (element) => element?.getRootNode?.() || window?.document;\nconst inputTags = ['INPUT', 'SELECT', 'TEXTAREA'];\nfunction isInputDOMNode(event) {\n    // using composed path for handling shadow dom\n    const target = (event.composedPath?.()?.[0] || event.target);\n    if (target?.nodeType !== 1 /* Node.ELEMENT_NODE */)\n        return false;\n    const isInput = inputTags.includes(target.nodeName) || target.hasAttribute('contenteditable');\n    // when an input field is focused we don't want to trigger deletion or movement of nodes\n    return isInput || !!target.closest('.nokey');\n}\nconst isMouseEvent = (event) => 'clientX' in event;\nconst getEventPosition = (event, bounds) => {\n    const isMouse = isMouseEvent(event);\n    const evtX = isMouse ? event.clientX : event.touches?.[0].clientX;\n    const evtY = isMouse ? event.clientY : event.touches?.[0].clientY;\n    return {\n        x: evtX - (bounds?.left ?? 0),\n        y: evtY - (bounds?.top ?? 0),\n    };\n};\n/*\n * The handle bounds are calculated relative to the node element.\n * We store them in the internals object of the node in order to avoid\n * unnecessary recalculations.\n */\nconst getHandleBounds = (type, nodeElement, nodeBounds, zoom, nodeId) => {\n    const handles = nodeElement.querySelectorAll(`.${type}`);\n    if (!handles || !handles.length) {\n        return null;\n    }\n    return Array.from(handles).map((handle) => {\n        const handleBounds = handle.getBoundingClientRect();\n        return {\n            id: handle.getAttribute('data-handleid'),\n            type,\n            nodeId,\n            position: handle.getAttribute('data-handlepos'),\n            x: (handleBounds.left - nodeBounds.left) / zoom,\n            y: (handleBounds.top - nodeBounds.top) / zoom,\n            ...getDimensions(handle),\n        };\n    });\n};\n\nfunction getBezierEdgeCenter({ sourceX, sourceY, targetX, targetY, sourceControlX, sourceControlY, targetControlX, targetControlY, }) {\n    /*\n     * cubic bezier t=0.5 mid point, not the actual mid point, but easy to calculate\n     * https://stackoverflow.com/questions/67516101/how-to-find-distance-mid-point-of-bezier-curve\n     */\n    const centerX = sourceX * 0.125 + sourceControlX * 0.375 + targetControlX * 0.375 + targetX * 0.125;\n    const centerY = sourceY * 0.125 + sourceControlY * 0.375 + targetControlY * 0.375 + targetY * 0.125;\n    const offsetX = Math.abs(centerX - sourceX);\n    const offsetY = Math.abs(centerY - sourceY);\n    return [centerX, centerY, offsetX, offsetY];\n}\nfunction calculateControlOffset(distance, curvature) {\n    if (distance >= 0) {\n        return 0.5 * distance;\n    }\n    return curvature * 25 * Math.sqrt(-distance);\n}\nfunction getControlWithCurvature({ pos, x1, y1, x2, y2, c }) {\n    switch (pos) {\n        case Position.Left:\n            return [x1 - calculateControlOffset(x1 - x2, c), y1];\n        case Position.Right:\n            return [x1 + calculateControlOffset(x2 - x1, c), y1];\n        case Position.Top:\n            return [x1, y1 - calculateControlOffset(y1 - y2, c)];\n        case Position.Bottom:\n            return [x1, y1 + calculateControlOffset(y2 - y1, c)];\n    }\n}\n/**\n * The `getBezierPath` util returns everything you need to render a bezier edge\n *between two nodes.\n * @public\n * @returns A path string you can use in an SVG, the `labelX` and `labelY` position (center of path)\n * and `offsetX`, `offsetY` between source handle and label.\n * - `path`: the path to use in an SVG `<path>` element.\n * - `labelX`: the `x` position you can use to render a label for this edge.\n * - `labelY`: the `y` position you can use to render a label for this edge.\n * - `offsetX`: the absolute difference between the source `x` position and the `x` position of the\n * middle of this path.\n * - `offsetY`: the absolute difference between the source `y` position and the `y` position of the\n * middle of this path.\n * @example\n * ```js\n *  const source = { x: 0, y: 20 };\n *  const target = { x: 150, y: 100 };\n *\n *  const [path, labelX, labelY, offsetX, offsetY] = getBezierPath({\n *    sourceX: source.x,\n *    sourceY: source.y,\n *    sourcePosition: Position.Right,\n *    targetX: target.x,\n *    targetY: target.y,\n *    targetPosition: Position.Left,\n *});\n *```\n *\n * @remarks This function returns a tuple (aka a fixed-size array) to make it easier to\n *work with multiple edge paths at once.\n */\nfunction getBezierPath({ sourceX, sourceY, sourcePosition = Position.Bottom, targetX, targetY, targetPosition = Position.Top, curvature = 0.25, }) {\n    const [sourceControlX, sourceControlY] = getControlWithCurvature({\n        pos: sourcePosition,\n        x1: sourceX,\n        y1: sourceY,\n        x2: targetX,\n        y2: targetY,\n        c: curvature,\n    });\n    const [targetControlX, targetControlY] = getControlWithCurvature({\n        pos: targetPosition,\n        x1: targetX,\n        y1: targetY,\n        x2: sourceX,\n        y2: sourceY,\n        c: curvature,\n    });\n    const [labelX, labelY, offsetX, offsetY] = getBezierEdgeCenter({\n        sourceX,\n        sourceY,\n        targetX,\n        targetY,\n        sourceControlX,\n        sourceControlY,\n        targetControlX,\n        targetControlY,\n    });\n    return [\n        `M${sourceX},${sourceY} C${sourceControlX},${sourceControlY} ${targetControlX},${targetControlY} ${targetX},${targetY}`,\n        labelX,\n        labelY,\n        offsetX,\n        offsetY,\n    ];\n}\n\n// this is used for straight edges and simple smoothstep edges (LTR, RTL, BTT, TTB)\nfunction getEdgeCenter({ sourceX, sourceY, targetX, targetY, }) {\n    const xOffset = Math.abs(targetX - sourceX) / 2;\n    const centerX = targetX < sourceX ? targetX + xOffset : targetX - xOffset;\n    const yOffset = Math.abs(targetY - sourceY) / 2;\n    const centerY = targetY < sourceY ? targetY + yOffset : targetY - yOffset;\n    return [centerX, centerY, xOffset, yOffset];\n}\n/**\n * Returns the z-index for an edge based on the node it connects and whether it is selected.\n * By default, edges are rendered below nodes. This behaviour is different for edges that are\n * connected to nodes with a parent, as they are rendered above the parent node.\n */\nfunction getElevatedEdgeZIndex({ sourceNode, targetNode, selected = false, zIndex, elevateOnSelect = false, }) {\n    if (zIndex !== undefined) {\n        return zIndex;\n    }\n    const edgeZ = elevateOnSelect && selected ? 1000 : 0;\n    const nodeZ = Math.max(sourceNode.parentId || (elevateOnSelect && sourceNode.selected) ? sourceNode.internals.z : 0, targetNode.parentId || (elevateOnSelect && targetNode.selected) ? targetNode.internals.z : 0);\n    return edgeZ + nodeZ;\n}\nfunction isEdgeVisible({ sourceNode, targetNode, width, height, transform }) {\n    const edgeBox = getBoundsOfBoxes(nodeToBox(sourceNode), nodeToBox(targetNode));\n    if (edgeBox.x === edgeBox.x2) {\n        edgeBox.x2 += 1;\n    }\n    if (edgeBox.y === edgeBox.y2) {\n        edgeBox.y2 += 1;\n    }\n    const viewRect = {\n        x: -transform[0] / transform[2],\n        y: -transform[1] / transform[2],\n        width: width / transform[2],\n        height: height / transform[2],\n    };\n    return getOverlappingArea(viewRect, boxToRect(edgeBox)) > 0;\n}\nconst getEdgeId = ({ source, sourceHandle, target, targetHandle }) => `xy-edge__${source}${sourceHandle || ''}-${target}${targetHandle || ''}`;\nconst connectionExists = (edge, edges) => {\n    return edges.some((el) => el.source === edge.source &&\n        el.target === edge.target &&\n        (el.sourceHandle === edge.sourceHandle || (!el.sourceHandle && !edge.sourceHandle)) &&\n        (el.targetHandle === edge.targetHandle || (!el.targetHandle && !edge.targetHandle)));\n};\n/**\n * This util is a convenience function to add a new Edge to an array of edges. It also performs some validation to make sure you don't add an invalid edge or duplicate an existing one.\n * @public\n * @param edgeParams - Either an `Edge` or a `Connection` you want to add.\n * @param edges - The array of all current edges.\n * @returns A new array of edges with the new edge added.\n *\n * @remarks If an edge with the same `target` and `source` already exists (and the same\n *`targetHandle` and `sourceHandle` if those are set), then this util won't add\n *a new edge even if the `id` property is different.\n *\n */\nconst addEdge = (edgeParams, edges) => {\n    if (!edgeParams.source || !edgeParams.target) {\n        devWarn('006', errorMessages['error006']());\n        return edges;\n    }\n    let edge;\n    if (isEdgeBase(edgeParams)) {\n        edge = { ...edgeParams };\n    }\n    else {\n        edge = {\n            ...edgeParams,\n            id: getEdgeId(edgeParams),\n        };\n    }\n    if (connectionExists(edge, edges)) {\n        return edges;\n    }\n    if (edge.sourceHandle === null) {\n        delete edge.sourceHandle;\n    }\n    if (edge.targetHandle === null) {\n        delete edge.targetHandle;\n    }\n    return edges.concat(edge);\n};\n/**\n * A handy utility to update an existing [`Edge`](/api-reference/types/edge) with new properties.\n *This searches your edge array for an edge with a matching `id` and updates its\n *properties with the connection you provide.\n * @public\n * @param oldEdge - The edge you want to update.\n * @param newConnection - The new connection you want to update the edge with.\n * @param edges - The array of all current edges.\n * @returns The updated edges array.\n *\n * @example\n * ```js\n *const onReconnect = useCallback(\n *  (oldEdge: Edge, newConnection: Connection) => setEdges((els) => reconnectEdge(oldEdge, newConnection, els)),[]);\n *```\n */\nconst reconnectEdge = (oldEdge, newConnection, edges, options = { shouldReplaceId: true }) => {\n    const { id: oldEdgeId, ...rest } = oldEdge;\n    if (!newConnection.source || !newConnection.target) {\n        devWarn('006', errorMessages['error006']());\n        return edges;\n    }\n    const foundEdge = edges.find((e) => e.id === oldEdge.id);\n    if (!foundEdge) {\n        devWarn('007', errorMessages['error007'](oldEdgeId));\n        return edges;\n    }\n    // Remove old edge and create the new edge with parameters of old edge.\n    const edge = {\n        ...rest,\n        id: options.shouldReplaceId ? getEdgeId(newConnection) : oldEdgeId,\n        source: newConnection.source,\n        target: newConnection.target,\n        sourceHandle: newConnection.sourceHandle,\n        targetHandle: newConnection.targetHandle,\n    };\n    return edges.filter((e) => e.id !== oldEdgeId).concat(edge);\n};\n\n/**\n * Calculates the straight line path between two points.\n * @public\n * @returns A path string you can use in an SVG, the `labelX` and `labelY` position (center of path)\n * and `offsetX`, `offsetY` between source handle and label.\n *\n * - `path`: the path to use in an SVG `<path>` element.\n * - `labelX`: the `x` position you can use to render a label for this edge.\n * - `labelY`: the `y` position you can use to render a label for this edge.\n * - `offsetX`: the absolute difference between the source `x` position and the `x` position of the\n * middle of this path.\n * - `offsetY`: the absolute difference between the source `y` position and the `y` position of the\n * middle of this path.\n * @example\n * ```js\n *  const source = { x: 0, y: 20 };\n *  const target = { x: 150, y: 100 };\n *\n *  const [path, labelX, labelY, offsetX, offsetY] = getStraightPath({\n *    sourceX: source.x,\n *    sourceY: source.y,\n *    sourcePosition: Position.Right,\n *    targetX: target.x,\n *    targetY: target.y,\n *    targetPosition: Position.Left,\n *  });\n * ```\n * @remarks This function returns a tuple (aka a fixed-size array) to make it easier to work with multiple edge paths at once.\n */\nfunction getStraightPath({ sourceX, sourceY, targetX, targetY, }) {\n    const [labelX, labelY, offsetX, offsetY] = getEdgeCenter({\n        sourceX,\n        sourceY,\n        targetX,\n        targetY,\n    });\n    return [`M ${sourceX},${sourceY}L ${targetX},${targetY}`, labelX, labelY, offsetX, offsetY];\n}\n\nconst handleDirections = {\n    [Position.Left]: { x: -1, y: 0 },\n    [Position.Right]: { x: 1, y: 0 },\n    [Position.Top]: { x: 0, y: -1 },\n    [Position.Bottom]: { x: 0, y: 1 },\n};\nconst getDirection = ({ source, sourcePosition = Position.Bottom, target, }) => {\n    if (sourcePosition === Position.Left || sourcePosition === Position.Right) {\n        return source.x < target.x ? { x: 1, y: 0 } : { x: -1, y: 0 };\n    }\n    return source.y < target.y ? { x: 0, y: 1 } : { x: 0, y: -1 };\n};\nconst distance = (a, b) => Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\n/*\n * With this function we try to mimic an orthogonal edge routing behaviour\n * It's not as good as a real orthogonal edge routing, but it's faster and good enough as a default for step and smooth step edges\n */\nfunction getPoints({ source, sourcePosition = Position.Bottom, target, targetPosition = Position.Top, center, offset, stepPosition, }) {\n    const sourceDir = handleDirections[sourcePosition];\n    const targetDir = handleDirections[targetPosition];\n    const sourceGapped = { x: source.x + sourceDir.x * offset, y: source.y + sourceDir.y * offset };\n    const targetGapped = { x: target.x + targetDir.x * offset, y: target.y + targetDir.y * offset };\n    const dir = getDirection({\n        source: sourceGapped,\n        sourcePosition,\n        target: targetGapped,\n    });\n    const dirAccessor = dir.x !== 0 ? 'x' : 'y';\n    const currDir = dir[dirAccessor];\n    let points = [];\n    let centerX, centerY;\n    const sourceGapOffset = { x: 0, y: 0 };\n    const targetGapOffset = { x: 0, y: 0 };\n    const [, , defaultOffsetX, defaultOffsetY] = getEdgeCenter({\n        sourceX: source.x,\n        sourceY: source.y,\n        targetX: target.x,\n        targetY: target.y,\n    });\n    // opposite handle positions, default case\n    if (sourceDir[dirAccessor] * targetDir[dirAccessor] === -1) {\n        if (dirAccessor === 'x') {\n            // Primary direction is horizontal, so stepPosition affects X coordinate\n            centerX = center.x ?? (sourceGapped.x + (targetGapped.x - sourceGapped.x) * stepPosition);\n            centerY = center.y ?? (sourceGapped.y + targetGapped.y) / 2;\n        }\n        else {\n            // Primary direction is vertical, so stepPosition affects Y coordinate  \n            centerX = center.x ?? (sourceGapped.x + targetGapped.x) / 2;\n            centerY = center.y ?? (sourceGapped.y + (targetGapped.y - sourceGapped.y) * stepPosition);\n        }\n        /*\n         *    --->\n         *    |\n         * >---\n         */\n        const verticalSplit = [\n            { x: centerX, y: sourceGapped.y },\n            { x: centerX, y: targetGapped.y },\n        ];\n        /*\n         *    |\n         *  ---\n         *  |\n         */\n        const horizontalSplit = [\n            { x: sourceGapped.x, y: centerY },\n            { x: targetGapped.x, y: centerY },\n        ];\n        if (sourceDir[dirAccessor] === currDir) {\n            points = dirAccessor === 'x' ? verticalSplit : horizontalSplit;\n        }\n        else {\n            points = dirAccessor === 'x' ? horizontalSplit : verticalSplit;\n        }\n    }\n    else {\n        // sourceTarget means we take x from source and y from target, targetSource is the opposite\n        const sourceTarget = [{ x: sourceGapped.x, y: targetGapped.y }];\n        const targetSource = [{ x: targetGapped.x, y: sourceGapped.y }];\n        // this handles edges with same handle positions\n        if (dirAccessor === 'x') {\n            points = sourceDir.x === currDir ? targetSource : sourceTarget;\n        }\n        else {\n            points = sourceDir.y === currDir ? sourceTarget : targetSource;\n        }\n        if (sourcePosition === targetPosition) {\n            const diff = Math.abs(source[dirAccessor] - target[dirAccessor]);\n            // if an edge goes from right to right for example (sourcePosition === targetPosition) and the distance between source.x and target.x is less than the offset, the added point and the gapped source/target will overlap. This leads to a weird edge path. To avoid this we add a gapOffset to the source/target\n            if (diff <= offset) {\n                const gapOffset = Math.min(offset - 1, offset - diff);\n                if (sourceDir[dirAccessor] === currDir) {\n                    sourceGapOffset[dirAccessor] = (sourceGapped[dirAccessor] > source[dirAccessor] ? -1 : 1) * gapOffset;\n                }\n                else {\n                    targetGapOffset[dirAccessor] = (targetGapped[dirAccessor] > target[dirAccessor] ? -1 : 1) * gapOffset;\n                }\n            }\n        }\n        // these are conditions for handling mixed handle positions like Right -> Bottom for example\n        if (sourcePosition !== targetPosition) {\n            const dirAccessorOpposite = dirAccessor === 'x' ? 'y' : 'x';\n            const isSameDir = sourceDir[dirAccessor] === targetDir[dirAccessorOpposite];\n            const sourceGtTargetOppo = sourceGapped[dirAccessorOpposite] > targetGapped[dirAccessorOpposite];\n            const sourceLtTargetOppo = sourceGapped[dirAccessorOpposite] < targetGapped[dirAccessorOpposite];\n            const flipSourceTarget = (sourceDir[dirAccessor] === 1 && ((!isSameDir && sourceGtTargetOppo) || (isSameDir && sourceLtTargetOppo))) ||\n                (sourceDir[dirAccessor] !== 1 && ((!isSameDir && sourceLtTargetOppo) || (isSameDir && sourceGtTargetOppo)));\n            if (flipSourceTarget) {\n                points = dirAccessor === 'x' ? sourceTarget : targetSource;\n            }\n        }\n        const sourceGapPoint = { x: sourceGapped.x + sourceGapOffset.x, y: sourceGapped.y + sourceGapOffset.y };\n        const targetGapPoint = { x: targetGapped.x + targetGapOffset.x, y: targetGapped.y + targetGapOffset.y };\n        const maxXDistance = Math.max(Math.abs(sourceGapPoint.x - points[0].x), Math.abs(targetGapPoint.x - points[0].x));\n        const maxYDistance = Math.max(Math.abs(sourceGapPoint.y - points[0].y), Math.abs(targetGapPoint.y - points[0].y));\n        // we want to place the label on the longest segment of the edge\n        if (maxXDistance >= maxYDistance) {\n            centerX = (sourceGapPoint.x + targetGapPoint.x) / 2;\n            centerY = points[0].y;\n        }\n        else {\n            centerX = points[0].x;\n            centerY = (sourceGapPoint.y + targetGapPoint.y) / 2;\n        }\n    }\n    const pathPoints = [\n        source,\n        { x: sourceGapped.x + sourceGapOffset.x, y: sourceGapped.y + sourceGapOffset.y },\n        ...points,\n        { x: targetGapped.x + targetGapOffset.x, y: targetGapped.y + targetGapOffset.y },\n        target,\n    ];\n    return [pathPoints, centerX, centerY, defaultOffsetX, defaultOffsetY];\n}\nfunction getBend(a, b, c, size) {\n    const bendSize = Math.min(distance(a, b) / 2, distance(b, c) / 2, size);\n    const { x, y } = b;\n    // no bend\n    if ((a.x === x && x === c.x) || (a.y === y && y === c.y)) {\n        return `L${x} ${y}`;\n    }\n    // first segment is horizontal\n    if (a.y === y) {\n        const xDir = a.x < c.x ? -1 : 1;\n        const yDir = a.y < c.y ? 1 : -1;\n        return `L ${x + bendSize * xDir},${y}Q ${x},${y} ${x},${y + bendSize * yDir}`;\n    }\n    const xDir = a.x < c.x ? 1 : -1;\n    const yDir = a.y < c.y ? -1 : 1;\n    return `L ${x},${y + bendSize * yDir}Q ${x},${y} ${x + bendSize * xDir},${y}`;\n}\n/**\n * The `getSmoothStepPath` util returns everything you need to render a stepped path\n * between two nodes. The `borderRadius` property can be used to choose how rounded\n * the corners of those steps are.\n * @public\n * @returns A path string you can use in an SVG, the `labelX` and `labelY` position (center of path)\n * and `offsetX`, `offsetY` between source handle and label.\n *\n * - `path`: the path to use in an SVG `<path>` element.\n * - `labelX`: the `x` position you can use to render a label for this edge.\n * - `labelY`: the `y` position you can use to render a label for this edge.\n * - `offsetX`: the absolute difference between the source `x` position and the `x` position of the\n * middle of this path.\n * - `offsetY`: the absolute difference between the source `y` position and the `y` position of the\n * middle of this path.\n * @example\n * ```js\n *  const source = { x: 0, y: 20 };\n *  const target = { x: 150, y: 100 };\n *\n *  const [path, labelX, labelY, offsetX, offsetY] = getSmoothStepPath({\n *    sourceX: source.x,\n *    sourceY: source.y,\n *    sourcePosition: Position.Right,\n *    targetX: target.x,\n *    targetY: target.y,\n *    targetPosition: Position.Left,\n *  });\n * ```\n * @remarks This function returns a tuple (aka a fixed-size array) to make it easier to work with multiple edge paths at once.\n */\nfunction getSmoothStepPath({ sourceX, sourceY, sourcePosition = Position.Bottom, targetX, targetY, targetPosition = Position.Top, borderRadius = 5, centerX, centerY, offset = 20, stepPosition = 0.5, }) {\n    const [points, labelX, labelY, offsetX, offsetY] = getPoints({\n        source: { x: sourceX, y: sourceY },\n        sourcePosition,\n        target: { x: targetX, y: targetY },\n        targetPosition,\n        center: { x: centerX, y: centerY },\n        offset,\n        stepPosition,\n    });\n    const path = points.reduce((res, p, i) => {\n        let segment = '';\n        if (i > 0 && i < points.length - 1) {\n            segment = getBend(points[i - 1], p, points[i + 1], borderRadius);\n        }\n        else {\n            segment = `${i === 0 ? 'M' : 'L'}${p.x} ${p.y}`;\n        }\n        res += segment;\n        return res;\n    }, '');\n    return [path, labelX, labelY, offsetX, offsetY];\n}\n\nfunction isNodeInitialized(node) {\n    return (node &&\n        !!(node.internals.handleBounds || node.handles?.length) &&\n        !!(node.measured.width || node.width || node.initialWidth));\n}\nfunction getEdgePosition(params) {\n    const { sourceNode, targetNode } = params;\n    if (!isNodeInitialized(sourceNode) || !isNodeInitialized(targetNode)) {\n        return null;\n    }\n    const sourceHandleBounds = sourceNode.internals.handleBounds || toHandleBounds(sourceNode.handles);\n    const targetHandleBounds = targetNode.internals.handleBounds || toHandleBounds(targetNode.handles);\n    const sourceHandle = getHandle$1(sourceHandleBounds?.source ?? [], params.sourceHandle);\n    const targetHandle = getHandle$1(\n    // when connection type is loose we can define all handles as sources and connect source -> source\n    params.connectionMode === ConnectionMode.Strict\n        ? targetHandleBounds?.target ?? []\n        : (targetHandleBounds?.target ?? []).concat(targetHandleBounds?.source ?? []), params.targetHandle);\n    if (!sourceHandle || !targetHandle) {\n        params.onError?.('008', errorMessages['error008'](!sourceHandle ? 'source' : 'target', {\n            id: params.id,\n            sourceHandle: params.sourceHandle,\n            targetHandle: params.targetHandle,\n        }));\n        return null;\n    }\n    const sourcePosition = sourceHandle?.position || Position.Bottom;\n    const targetPosition = targetHandle?.position || Position.Top;\n    const source = getHandlePosition(sourceNode, sourceHandle, sourcePosition);\n    const target = getHandlePosition(targetNode, targetHandle, targetPosition);\n    return {\n        sourceX: source.x,\n        sourceY: source.y,\n        targetX: target.x,\n        targetY: target.y,\n        sourcePosition,\n        targetPosition,\n    };\n}\nfunction toHandleBounds(handles) {\n    if (!handles) {\n        return null;\n    }\n    const source = [];\n    const target = [];\n    for (const handle of handles) {\n        handle.width = handle.width ?? 1;\n        handle.height = handle.height ?? 1;\n        if (handle.type === 'source') {\n            source.push(handle);\n        }\n        else if (handle.type === 'target') {\n            target.push(handle);\n        }\n    }\n    return {\n        source,\n        target,\n    };\n}\nfunction getHandlePosition(node, handle, fallbackPosition = Position.Left, center = false) {\n    const x = (handle?.x ?? 0) + node.internals.positionAbsolute.x;\n    const y = (handle?.y ?? 0) + node.internals.positionAbsolute.y;\n    const { width, height } = handle ?? getNodeDimensions(node);\n    if (center) {\n        return { x: x + width / 2, y: y + height / 2 };\n    }\n    const position = handle?.position ?? fallbackPosition;\n    switch (position) {\n        case Position.Top:\n            return { x: x + width / 2, y };\n        case Position.Right:\n            return { x: x + width, y: y + height / 2 };\n        case Position.Bottom:\n            return { x: x + width / 2, y: y + height };\n        case Position.Left:\n            return { x, y: y + height / 2 };\n    }\n}\nfunction getHandle$1(bounds, handleId) {\n    if (!bounds) {\n        return null;\n    }\n    // if no handleId is given, we use the first handle, otherwise we check for the id\n    return (!handleId ? bounds[0] : bounds.find((d) => d.id === handleId)) || null;\n}\n\nfunction getMarkerId(marker, id) {\n    if (!marker) {\n        return '';\n    }\n    if (typeof marker === 'string') {\n        return marker;\n    }\n    const idPrefix = id ? `${id}__` : '';\n    return `${idPrefix}${Object.keys(marker)\n        .sort()\n        .map((key) => `${key}=${marker[key]}`)\n        .join('&')}`;\n}\nfunction createMarkerIds(edges, { id, defaultColor, defaultMarkerStart, defaultMarkerEnd, }) {\n    const ids = new Set();\n    return edges\n        .reduce((markers, edge) => {\n        [edge.markerStart || defaultMarkerStart, edge.markerEnd || defaultMarkerEnd].forEach((marker) => {\n            if (marker && typeof marker === 'object') {\n                const markerId = getMarkerId(marker, id);\n                if (!ids.has(markerId)) {\n                    markers.push({ id: markerId, color: marker.color || defaultColor, ...marker });\n                    ids.add(markerId);\n                }\n            }\n        });\n        return markers;\n    }, [])\n        .sort((a, b) => a.id.localeCompare(b.id));\n}\n\nfunction getNodeToolbarTransform(nodeRect, viewport, position, offset, align) {\n    let alignmentOffset = 0.5;\n    if (align === 'start') {\n        alignmentOffset = 0;\n    }\n    else if (align === 'end') {\n        alignmentOffset = 1;\n    }\n    /*\n     * position === Position.Top\n     * we set the x any y position of the toolbar based on the nodes position\n     */\n    let pos = [\n        (nodeRect.x + nodeRect.width * alignmentOffset) * viewport.zoom + viewport.x,\n        nodeRect.y * viewport.zoom + viewport.y - offset,\n    ];\n    // and than shift it based on the alignment. The shift values are in %.\n    let shift = [-100 * alignmentOffset, -100];\n    switch (position) {\n        case Position.Right:\n            pos = [\n                (nodeRect.x + nodeRect.width) * viewport.zoom + viewport.x + offset,\n                (nodeRect.y + nodeRect.height * alignmentOffset) * viewport.zoom + viewport.y,\n            ];\n            shift = [0, -100 * alignmentOffset];\n            break;\n        case Position.Bottom:\n            pos[1] = (nodeRect.y + nodeRect.height) * viewport.zoom + viewport.y + offset;\n            shift[1] = 0;\n            break;\n        case Position.Left:\n            pos = [\n                nodeRect.x * viewport.zoom + viewport.x - offset,\n                (nodeRect.y + nodeRect.height * alignmentOffset) * viewport.zoom + viewport.y,\n            ];\n            shift = [-100, -100 * alignmentOffset];\n            break;\n    }\n    return `translate(${pos[0]}px, ${pos[1]}px) translate(${shift[0]}%, ${shift[1]}%)`;\n}\n\nconst defaultOptions = {\n    nodeOrigin: [0, 0],\n    nodeExtent: infiniteExtent,\n    elevateNodesOnSelect: true,\n    defaults: {},\n};\nconst adoptUserNodesDefaultOptions = {\n    ...defaultOptions,\n    checkEquality: true,\n};\nfunction mergeObjects(base, incoming) {\n    const result = { ...base };\n    for (const key in incoming) {\n        if (incoming[key] !== undefined) {\n            // typecast is safe here, because we check for undefined\n            result[key] = incoming[key];\n        }\n    }\n    return result;\n}\nfunction updateAbsolutePositions(nodeLookup, parentLookup, options) {\n    const _options = mergeObjects(defaultOptions, options);\n    for (const node of nodeLookup.values()) {\n        if (node.parentId) {\n            updateChildNode(node, nodeLookup, parentLookup, _options);\n        }\n        else {\n            const positionWithOrigin = getNodePositionWithOrigin(node, _options.nodeOrigin);\n            const extent = isCoordinateExtent(node.extent) ? node.extent : _options.nodeExtent;\n            const clampedPosition = clampPosition(positionWithOrigin, extent, getNodeDimensions(node));\n            node.internals.positionAbsolute = clampedPosition;\n        }\n    }\n}\nfunction parseHandles(userNode, internalNode) {\n    if (!userNode.handles) {\n        return !userNode.measured ? undefined : internalNode?.internals.handleBounds;\n    }\n    const source = [];\n    const target = [];\n    for (const handle of userNode.handles) {\n        const handleBounds = {\n            id: handle.id,\n            width: handle.width ?? 1,\n            height: handle.height ?? 1,\n            nodeId: userNode.id,\n            x: handle.x,\n            y: handle.y,\n            position: handle.position,\n            type: handle.type,\n        };\n        if (handle.type === 'source') {\n            source.push(handleBounds);\n        }\n        else if (handle.type === 'target') {\n            target.push(handleBounds);\n        }\n    }\n    return {\n        source,\n        target,\n    };\n}\nfunction adoptUserNodes(nodes, nodeLookup, parentLookup, options) {\n    const _options = mergeObjects(adoptUserNodesDefaultOptions, options);\n    let nodesInitialized = nodes.length > 0;\n    const tmpLookup = new Map(nodeLookup);\n    const selectedNodeZ = _options?.elevateNodesOnSelect ? 1000 : 0;\n    nodeLookup.clear();\n    parentLookup.clear();\n    for (const userNode of nodes) {\n        let internalNode = tmpLookup.get(userNode.id);\n        if (_options.checkEquality && userNode === internalNode?.internals.userNode) {\n            nodeLookup.set(userNode.id, internalNode);\n        }\n        else {\n            const positionWithOrigin = getNodePositionWithOrigin(userNode, _options.nodeOrigin);\n            const extent = isCoordinateExtent(userNode.extent) ? userNode.extent : _options.nodeExtent;\n            const clampedPosition = clampPosition(positionWithOrigin, extent, getNodeDimensions(userNode));\n            internalNode = {\n                ..._options.defaults,\n                ...userNode,\n                measured: {\n                    width: userNode.measured?.width,\n                    height: userNode.measured?.height,\n                },\n                internals: {\n                    positionAbsolute: clampedPosition,\n                    // if user re-initializes the node or removes `measured` for whatever reason, we reset the handleBounds so that the node gets re-measured\n                    handleBounds: parseHandles(userNode, internalNode),\n                    z: calculateZ(userNode, selectedNodeZ),\n                    userNode,\n                },\n            };\n            nodeLookup.set(userNode.id, internalNode);\n        }\n        if ((internalNode.measured === undefined ||\n            internalNode.measured.width === undefined ||\n            internalNode.measured.height === undefined) &&\n            !internalNode.hidden) {\n            nodesInitialized = false;\n        }\n        if (userNode.parentId) {\n            updateChildNode(internalNode, nodeLookup, parentLookup, options);\n        }\n    }\n    return nodesInitialized;\n}\nfunction updateParentLookup(node, parentLookup) {\n    if (!node.parentId) {\n        return;\n    }\n    const childNodes = parentLookup.get(node.parentId);\n    if (childNodes) {\n        childNodes.set(node.id, node);\n    }\n    else {\n        parentLookup.set(node.parentId, new Map([[node.id, node]]));\n    }\n}\n/**\n * Updates positionAbsolute and zIndex of a child node and the parentLookup.\n */\nfunction updateChildNode(node, nodeLookup, parentLookup, options) {\n    const { elevateNodesOnSelect, nodeOrigin, nodeExtent } = mergeObjects(defaultOptions, options);\n    const parentId = node.parentId;\n    const parentNode = nodeLookup.get(parentId);\n    if (!parentNode) {\n        console.warn(`Parent node ${parentId} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);\n        return;\n    }\n    updateParentLookup(node, parentLookup);\n    const selectedNodeZ = elevateNodesOnSelect ? 1000 : 0;\n    const { x, y, z } = calculateChildXYZ(node, parentNode, nodeOrigin, nodeExtent, selectedNodeZ);\n    const { positionAbsolute } = node.internals;\n    const positionChanged = x !== positionAbsolute.x || y !== positionAbsolute.y;\n    if (positionChanged || z !== node.internals.z) {\n        // we create a new object to mark the node as updated\n        nodeLookup.set(node.id, {\n            ...node,\n            internals: {\n                ...node.internals,\n                positionAbsolute: positionChanged ? { x, y } : positionAbsolute,\n                z,\n            },\n        });\n    }\n}\nfunction calculateZ(node, selectedNodeZ) {\n    return (isNumeric(node.zIndex) ? node.zIndex : 0) + (node.selected ? selectedNodeZ : 0);\n}\nfunction calculateChildXYZ(childNode, parentNode, nodeOrigin, nodeExtent, selectedNodeZ) {\n    const { x: parentX, y: parentY } = parentNode.internals.positionAbsolute;\n    const childDimensions = getNodeDimensions(childNode);\n    const positionWithOrigin = getNodePositionWithOrigin(childNode, nodeOrigin);\n    const clampedPosition = isCoordinateExtent(childNode.extent)\n        ? clampPosition(positionWithOrigin, childNode.extent, childDimensions)\n        : positionWithOrigin;\n    let absolutePosition = clampPosition({ x: parentX + clampedPosition.x, y: parentY + clampedPosition.y }, nodeExtent, childDimensions);\n    if (childNode.extent === 'parent') {\n        absolutePosition = clampPositionToParent(absolutePosition, childDimensions, parentNode);\n    }\n    const childZ = calculateZ(childNode, selectedNodeZ);\n    const parentZ = parentNode.internals.z ?? 0;\n    return {\n        x: absolutePosition.x,\n        y: absolutePosition.y,\n        z: parentZ >= childZ ? parentZ + 1 : childZ,\n    };\n}\nfunction handleExpandParent(children, nodeLookup, parentLookup, nodeOrigin = [0, 0]) {\n    const changes = [];\n    const parentExpansions = new Map();\n    // determine the expanded rectangle the child nodes would take for each parent\n    for (const child of children) {\n        const parent = nodeLookup.get(child.parentId);\n        if (!parent) {\n            continue;\n        }\n        const parentRect = parentExpansions.get(child.parentId)?.expandedRect ?? nodeToRect(parent);\n        const expandedRect = getBoundsOfRects(parentRect, child.rect);\n        parentExpansions.set(child.parentId, { expandedRect, parent });\n    }\n    if (parentExpansions.size > 0) {\n        parentExpansions.forEach(({ expandedRect, parent }, parentId) => {\n            // determine the position & dimensions of the parent\n            const positionAbsolute = parent.internals.positionAbsolute;\n            const dimensions = getNodeDimensions(parent);\n            const origin = parent.origin ?? nodeOrigin;\n            // determine how much the parent expands in width and position\n            const xChange = expandedRect.x < positionAbsolute.x ? Math.round(Math.abs(positionAbsolute.x - expandedRect.x)) : 0;\n            const yChange = expandedRect.y < positionAbsolute.y ? Math.round(Math.abs(positionAbsolute.y - expandedRect.y)) : 0;\n            const newWidth = Math.max(dimensions.width, Math.round(expandedRect.width));\n            const newHeight = Math.max(dimensions.height, Math.round(expandedRect.height));\n            const widthChange = (newWidth - dimensions.width) * origin[0];\n            const heightChange = (newHeight - dimensions.height) * origin[1];\n            // We need to correct the position of the parent node if the origin is not [0,0]\n            if (xChange > 0 || yChange > 0 || widthChange || heightChange) {\n                changes.push({\n                    id: parentId,\n                    type: 'position',\n                    position: {\n                        x: parent.position.x - xChange + widthChange,\n                        y: parent.position.y - yChange + heightChange,\n                    },\n                });\n                /*\n                 * We move all child nodes in the oppsite direction\n                 * so the x,y changes of the parent do not move the children\n                 */\n                parentLookup.get(parentId)?.forEach((childNode) => {\n                    if (!children.some((child) => child.id === childNode.id)) {\n                        changes.push({\n                            id: childNode.id,\n                            type: 'position',\n                            position: {\n                                x: childNode.position.x + xChange,\n                                y: childNode.position.y + yChange,\n                            },\n                        });\n                    }\n                });\n            }\n            // We need to correct the dimensions of the parent node if the origin is not [0,0]\n            if (dimensions.width < expandedRect.width || dimensions.height < expandedRect.height || xChange || yChange) {\n                changes.push({\n                    id: parentId,\n                    type: 'dimensions',\n                    setAttributes: true,\n                    dimensions: {\n                        width: newWidth + (xChange ? origin[0] * xChange - widthChange : 0),\n                        height: newHeight + (yChange ? origin[1] * yChange - heightChange : 0),\n                    },\n                });\n            }\n        });\n    }\n    return changes;\n}\nfunction updateNodeInternals(updates, nodeLookup, parentLookup, domNode, nodeOrigin, nodeExtent) {\n    const viewportNode = domNode?.querySelector('.xyflow__viewport');\n    let updatedInternals = false;\n    if (!viewportNode) {\n        return { changes: [], updatedInternals };\n    }\n    const changes = [];\n    const style = window.getComputedStyle(viewportNode);\n    const { m22: zoom } = new window.DOMMatrixReadOnly(style.transform);\n    // in this array we collect nodes, that might trigger changes (like expanding parent)\n    const parentExpandChildren = [];\n    for (const update of updates.values()) {\n        const node = nodeLookup.get(update.id);\n        if (!node) {\n            continue;\n        }\n        if (node.hidden) {\n            nodeLookup.set(node.id, {\n                ...node,\n                internals: {\n                    ...node.internals,\n                    handleBounds: undefined,\n                },\n            });\n            updatedInternals = true;\n            continue;\n        }\n        const dimensions = getDimensions(update.nodeElement);\n        const dimensionChanged = node.measured.width !== dimensions.width || node.measured.height !== dimensions.height;\n        const doUpdate = !!(dimensions.width &&\n            dimensions.height &&\n            (dimensionChanged || !node.internals.handleBounds || update.force));\n        if (doUpdate) {\n            const nodeBounds = update.nodeElement.getBoundingClientRect();\n            const extent = isCoordinateExtent(node.extent) ? node.extent : nodeExtent;\n            let { positionAbsolute } = node.internals;\n            if (node.parentId && node.extent === 'parent') {\n                positionAbsolute = clampPositionToParent(positionAbsolute, dimensions, nodeLookup.get(node.parentId));\n            }\n            else if (extent) {\n                positionAbsolute = clampPosition(positionAbsolute, extent, dimensions);\n            }\n            const newNode = {\n                ...node,\n                measured: dimensions,\n                internals: {\n                    ...node.internals,\n                    positionAbsolute,\n                    handleBounds: {\n                        source: getHandleBounds('source', update.nodeElement, nodeBounds, zoom, node.id),\n                        target: getHandleBounds('target', update.nodeElement, nodeBounds, zoom, node.id),\n                    },\n                },\n            };\n            nodeLookup.set(node.id, newNode);\n            if (node.parentId) {\n                updateChildNode(newNode, nodeLookup, parentLookup, { nodeOrigin });\n            }\n            updatedInternals = true;\n            if (dimensionChanged) {\n                changes.push({\n                    id: node.id,\n                    type: 'dimensions',\n                    dimensions,\n                });\n                if (node.expandParent && node.parentId) {\n                    parentExpandChildren.push({\n                        id: node.id,\n                        parentId: node.parentId,\n                        rect: nodeToRect(newNode, nodeOrigin),\n                    });\n                }\n            }\n        }\n    }\n    if (parentExpandChildren.length > 0) {\n        const parentExpandChanges = handleExpandParent(parentExpandChildren, nodeLookup, parentLookup, nodeOrigin);\n        changes.push(...parentExpandChanges);\n    }\n    return { changes, updatedInternals };\n}\nasync function panBy({ delta, panZoom, transform, translateExtent, width, height, }) {\n    if (!panZoom || (!delta.x && !delta.y)) {\n        return Promise.resolve(false);\n    }\n    const nextViewport = await panZoom.setViewportConstrained({\n        x: transform[0] + delta.x,\n        y: transform[1] + delta.y,\n        zoom: transform[2],\n    }, [\n        [0, 0],\n        [width, height],\n    ], translateExtent);\n    const transformChanged = !!nextViewport &&\n        (nextViewport.x !== transform[0] || nextViewport.y !== transform[1] || nextViewport.k !== transform[2]);\n    return Promise.resolve(transformChanged);\n}\n/**\n * this function adds the connection to the connectionLookup\n * at the following keys: nodeId-type-handleId, nodeId-type and nodeId\n * @param type type of the connection\n * @param connection connection that should be added to the lookup\n * @param connectionKey at which key the connection should be added\n * @param connectionLookup reference to the connection lookup\n * @param nodeId nodeId of the connection\n * @param handleId handleId of the conneciton\n */\nfunction addConnectionToLookup(type, connection, connectionKey, connectionLookup, nodeId, handleId) {\n    /*\n     * We add the connection to the connectionLookup at the following keys\n     * 1. nodeId, 2. nodeId-type, 3. nodeId-type-handleId\n     * If the key already exists, we add the connection to the existing map\n     */\n    let key = nodeId;\n    const nodeMap = connectionLookup.get(key) || new Map();\n    connectionLookup.set(key, nodeMap.set(connectionKey, connection));\n    key = `${nodeId}-${type}`;\n    const typeMap = connectionLookup.get(key) || new Map();\n    connectionLookup.set(key, typeMap.set(connectionKey, connection));\n    if (handleId) {\n        key = `${nodeId}-${type}-${handleId}`;\n        const handleMap = connectionLookup.get(key) || new Map();\n        connectionLookup.set(key, handleMap.set(connectionKey, connection));\n    }\n}\nfunction updateConnectionLookup(connectionLookup, edgeLookup, edges) {\n    connectionLookup.clear();\n    edgeLookup.clear();\n    for (const edge of edges) {\n        const { source: sourceNode, target: targetNode, sourceHandle = null, targetHandle = null } = edge;\n        const connection = { edgeId: edge.id, source: sourceNode, target: targetNode, sourceHandle, targetHandle };\n        const sourceKey = `${sourceNode}-${sourceHandle}--${targetNode}-${targetHandle}`;\n        const targetKey = `${targetNode}-${targetHandle}--${sourceNode}-${sourceHandle}`;\n        addConnectionToLookup('source', connection, targetKey, connectionLookup, sourceNode, sourceHandle);\n        addConnectionToLookup('target', connection, sourceKey, connectionLookup, targetNode, targetHandle);\n        edgeLookup.set(edge.id, edge);\n    }\n}\n\nfunction shallowNodeData(a, b) {\n    if (a === null || b === null) {\n        return false;\n    }\n    const _a = Array.isArray(a) ? a : [a];\n    const _b = Array.isArray(b) ? b : [b];\n    if (_a.length !== _b.length) {\n        return false;\n    }\n    for (let i = 0; i < _a.length; i++) {\n        if (_a[i].id !== _b[i].id || _a[i].type !== _b[i].type || !Object.is(_a[i].data, _b[i].data)) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction isParentSelected(node, nodeLookup) {\n    if (!node.parentId) {\n        return false;\n    }\n    const parentNode = nodeLookup.get(node.parentId);\n    if (!parentNode) {\n        return false;\n    }\n    if (parentNode.selected) {\n        return true;\n    }\n    return isParentSelected(parentNode, nodeLookup);\n}\nfunction hasSelector(target, selector, domNode) {\n    let current = target;\n    do {\n        if (current?.matches?.(selector))\n            return true;\n        if (current === domNode)\n            return false;\n        current = current?.parentElement;\n    } while (current);\n    return false;\n}\n// looks for all selected nodes and created a NodeDragItem for each of them\nfunction getDragItems(nodeLookup, nodesDraggable, mousePos, nodeId) {\n    const dragItems = new Map();\n    for (const [id, node] of nodeLookup) {\n        if ((node.selected || node.id === nodeId) &&\n            (!node.parentId || !isParentSelected(node, nodeLookup)) &&\n            (node.draggable || (nodesDraggable && typeof node.draggable === 'undefined'))) {\n            const internalNode = nodeLookup.get(id);\n            if (internalNode) {\n                dragItems.set(id, {\n                    id,\n                    position: internalNode.position || { x: 0, y: 0 },\n                    distance: {\n                        x: mousePos.x - internalNode.internals.positionAbsolute.x,\n                        y: mousePos.y - internalNode.internals.positionAbsolute.y,\n                    },\n                    extent: internalNode.extent,\n                    parentId: internalNode.parentId,\n                    origin: internalNode.origin,\n                    expandParent: internalNode.expandParent,\n                    internals: {\n                        positionAbsolute: internalNode.internals.positionAbsolute || { x: 0, y: 0 },\n                    },\n                    measured: {\n                        width: internalNode.measured.width ?? 0,\n                        height: internalNode.measured.height ?? 0,\n                    },\n                });\n            }\n        }\n    }\n    return dragItems;\n}\n/*\n * returns two params:\n * 1. the dragged node (or the first of the list, if we are dragging a node selection)\n * 2. array of selected nodes (for multi selections)\n */\nfunction getEventHandlerParams({ nodeId, dragItems, nodeLookup, dragging = true, }) {\n    const nodesFromDragItems = [];\n    for (const [id, dragItem] of dragItems) {\n        const node = nodeLookup.get(id)?.internals.userNode;\n        if (node) {\n            nodesFromDragItems.push({\n                ...node,\n                position: dragItem.position,\n                dragging,\n            });\n        }\n    }\n    if (!nodeId) {\n        return [nodesFromDragItems[0], nodesFromDragItems];\n    }\n    const node = nodeLookup.get(nodeId)?.internals.userNode;\n    return [\n        !node\n            ? nodesFromDragItems[0]\n            : {\n                ...node,\n                position: dragItems.get(nodeId)?.position || node.position,\n                dragging,\n            },\n        nodesFromDragItems,\n    ];\n}\n/**\n * If a selection is being dragged we want to apply the same snap offset to all nodes in the selection.\n * This function calculates the snap offset based on the first node in the selection.\n */\nfunction calculateSnapOffset({ dragItems, snapGrid, x, y, }) {\n    const refDragItem = dragItems.values().next().value;\n    if (!refDragItem) {\n        return null;\n    }\n    const refPos = {\n        x: x - refDragItem.distance.x,\n        y: y - refDragItem.distance.y,\n    };\n    const refPosSnapped = snapPosition(refPos, snapGrid);\n    return {\n        x: refPosSnapped.x - refPos.x,\n        y: refPosSnapped.y - refPos.y,\n    };\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction XYDrag({ onNodeMouseDown, getStoreItems, onDragStart, onDrag, onDragStop, }) {\n    let lastPos = { x: null, y: null };\n    let autoPanId = 0;\n    let dragItems = new Map();\n    let autoPanStarted = false;\n    let mousePosition = { x: 0, y: 0 };\n    let containerBounds = null;\n    let dragStarted = false;\n    let d3Selection = null;\n    let abortDrag = false; // prevents unintentional dragging on multitouch\n    let nodePositionsChanged = false;\n    // we store the last drag event to be able to use it in the update function\n    let dragEvent = null;\n    // public functions\n    function update({ noDragClassName, handleSelector, domNode, isSelectable, nodeId, nodeClickDistance = 0, }) {\n        d3Selection = select(domNode);\n        function updateNodes({ x, y }) {\n            const { nodeLookup, nodeExtent, snapGrid, snapToGrid, nodeOrigin, onNodeDrag, onSelectionDrag, onError, updateNodePositions, } = getStoreItems();\n            lastPos = { x, y };\n            let hasChange = false;\n            const isMultiDrag = dragItems.size > 1;\n            const nodesBox = isMultiDrag && nodeExtent ? rectToBox(getInternalNodesBounds(dragItems)) : null;\n            const multiDragSnapOffset = isMultiDrag && snapToGrid\n                ? calculateSnapOffset({\n                    dragItems,\n                    snapGrid,\n                    x,\n                    y,\n                })\n                : null;\n            for (const [id, dragItem] of dragItems) {\n                /*\n                 * if the node is not in the nodeLookup anymore, it was probably deleted while dragging\n                 */\n                if (!nodeLookup.has(id)) {\n                    continue;\n                }\n                let nextPosition = { x: x - dragItem.distance.x, y: y - dragItem.distance.y };\n                if (snapToGrid) {\n                    nextPosition = multiDragSnapOffset\n                        ? {\n                            x: Math.round(nextPosition.x + multiDragSnapOffset.x),\n                            y: Math.round(nextPosition.y + multiDragSnapOffset.y),\n                        }\n                        : snapPosition(nextPosition, snapGrid);\n                }\n                let adjustedNodeExtent = null;\n                if (isMultiDrag && nodeExtent && !dragItem.extent && nodesBox) {\n                    const { positionAbsolute } = dragItem.internals;\n                    const x1 = positionAbsolute.x - nodesBox.x + nodeExtent[0][0];\n                    const x2 = positionAbsolute.x + dragItem.measured.width - nodesBox.x2 + nodeExtent[1][0];\n                    const y1 = positionAbsolute.y - nodesBox.y + nodeExtent[0][1];\n                    const y2 = positionAbsolute.y + dragItem.measured.height - nodesBox.y2 + nodeExtent[1][1];\n                    adjustedNodeExtent = [\n                        [x1, y1],\n                        [x2, y2],\n                    ];\n                }\n                const { position, positionAbsolute } = calculateNodePosition({\n                    nodeId: id,\n                    nextPosition,\n                    nodeLookup,\n                    nodeExtent: adjustedNodeExtent ? adjustedNodeExtent : nodeExtent,\n                    nodeOrigin,\n                    onError,\n                });\n                // we want to make sure that we only fire a change event when there is a change\n                hasChange = hasChange || dragItem.position.x !== position.x || dragItem.position.y !== position.y;\n                dragItem.position = position;\n                dragItem.internals.positionAbsolute = positionAbsolute;\n            }\n            nodePositionsChanged = nodePositionsChanged || hasChange;\n            if (!hasChange) {\n                return;\n            }\n            updateNodePositions(dragItems, true);\n            if (dragEvent && (onDrag || onNodeDrag || (!nodeId && onSelectionDrag))) {\n                const [currentNode, currentNodes] = getEventHandlerParams({\n                    nodeId,\n                    dragItems,\n                    nodeLookup,\n                });\n                onDrag?.(dragEvent, dragItems, currentNode, currentNodes);\n                onNodeDrag?.(dragEvent, currentNode, currentNodes);\n                if (!nodeId) {\n                    onSelectionDrag?.(dragEvent, currentNodes);\n                }\n            }\n        }\n        async function autoPan() {\n            if (!containerBounds) {\n                return;\n            }\n            const { transform, panBy, autoPanSpeed, autoPanOnNodeDrag } = getStoreItems();\n            if (!autoPanOnNodeDrag) {\n                autoPanStarted = false;\n                cancelAnimationFrame(autoPanId);\n                return;\n            }\n            const [xMovement, yMovement] = calcAutoPan(mousePosition, containerBounds, autoPanSpeed);\n            if (xMovement !== 0 || yMovement !== 0) {\n                lastPos.x = (lastPos.x ?? 0) - xMovement / transform[2];\n                lastPos.y = (lastPos.y ?? 0) - yMovement / transform[2];\n                if (await panBy({ x: xMovement, y: yMovement })) {\n                    updateNodes(lastPos);\n                }\n            }\n            autoPanId = requestAnimationFrame(autoPan);\n        }\n        function startDrag(event) {\n            const { nodeLookup, multiSelectionActive, nodesDraggable, transform, snapGrid, snapToGrid, selectNodesOnDrag, onNodeDragStart, onSelectionDragStart, unselectNodesAndEdges, } = getStoreItems();\n            dragStarted = true;\n            if ((!selectNodesOnDrag || !isSelectable) && !multiSelectionActive && nodeId) {\n                if (!nodeLookup.get(nodeId)?.selected) {\n                    // we need to reset selected nodes when selectNodesOnDrag=false\n                    unselectNodesAndEdges();\n                }\n            }\n            if (isSelectable && selectNodesOnDrag && nodeId) {\n                onNodeMouseDown?.(nodeId);\n            }\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid, containerBounds });\n            lastPos = pointerPos;\n            dragItems = getDragItems(nodeLookup, nodesDraggable, pointerPos, nodeId);\n            if (dragItems.size > 0 && (onDragStart || onNodeDragStart || (!nodeId && onSelectionDragStart))) {\n                const [currentNode, currentNodes] = getEventHandlerParams({\n                    nodeId,\n                    dragItems,\n                    nodeLookup,\n                });\n                onDragStart?.(event.sourceEvent, dragItems, currentNode, currentNodes);\n                onNodeDragStart?.(event.sourceEvent, currentNode, currentNodes);\n                if (!nodeId) {\n                    onSelectionDragStart?.(event.sourceEvent, currentNodes);\n                }\n            }\n        }\n        const d3DragInstance = drag()\n            .clickDistance(nodeClickDistance)\n            .on('start', (event) => {\n            const { domNode, nodeDragThreshold, transform, snapGrid, snapToGrid } = getStoreItems();\n            containerBounds = domNode?.getBoundingClientRect() || null;\n            abortDrag = false;\n            nodePositionsChanged = false;\n            dragEvent = event.sourceEvent;\n            if (nodeDragThreshold === 0) {\n                startDrag(event);\n            }\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid, containerBounds });\n            lastPos = pointerPos;\n            mousePosition = getEventPosition(event.sourceEvent, containerBounds);\n        })\n            .on('drag', (event) => {\n            const { autoPanOnNodeDrag, transform, snapGrid, snapToGrid, nodeDragThreshold, nodeLookup } = getStoreItems();\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid, containerBounds });\n            dragEvent = event.sourceEvent;\n            if ((event.sourceEvent.type === 'touchmove' && event.sourceEvent.touches.length > 1) ||\n                // if user deletes a node while dragging, we need to abort the drag to prevent errors\n                (nodeId && !nodeLookup.has(nodeId))) {\n                abortDrag = true;\n            }\n            if (abortDrag) {\n                return;\n            }\n            if (!autoPanStarted && autoPanOnNodeDrag && dragStarted) {\n                autoPanStarted = true;\n                autoPan();\n            }\n            if (!dragStarted) {\n                // Calculate distance in client coordinates for consistent drag threshold behavior across zoom levels\n                const currentMousePosition = getEventPosition(event.sourceEvent, containerBounds);\n                const x = currentMousePosition.x - mousePosition.x;\n                const y = currentMousePosition.y - mousePosition.y;\n                const distance = Math.sqrt(x * x + y * y);\n                if (distance > nodeDragThreshold) {\n                    startDrag(event);\n                }\n            }\n            // skip events without movement\n            if ((lastPos.x !== pointerPos.xSnapped || lastPos.y !== pointerPos.ySnapped) && dragItems && dragStarted) {\n                mousePosition = getEventPosition(event.sourceEvent, containerBounds);\n                updateNodes(pointerPos);\n            }\n        })\n            .on('end', (event) => {\n            if (!dragStarted || abortDrag) {\n                return;\n            }\n            autoPanStarted = false;\n            dragStarted = false;\n            cancelAnimationFrame(autoPanId);\n            if (dragItems.size > 0) {\n                const { nodeLookup, updateNodePositions, onNodeDragStop, onSelectionDragStop } = getStoreItems();\n                if (nodePositionsChanged) {\n                    updateNodePositions(dragItems, false);\n                    nodePositionsChanged = false;\n                }\n                if (onDragStop || onNodeDragStop || (!nodeId && onSelectionDragStop)) {\n                    const [currentNode, currentNodes] = getEventHandlerParams({\n                        nodeId,\n                        dragItems,\n                        nodeLookup,\n                        dragging: false,\n                    });\n                    onDragStop?.(event.sourceEvent, dragItems, currentNode, currentNodes);\n                    onNodeDragStop?.(event.sourceEvent, currentNode, currentNodes);\n                    if (!nodeId) {\n                        onSelectionDragStop?.(event.sourceEvent, currentNodes);\n                    }\n                }\n            }\n        })\n            .filter((event) => {\n            const target = event.target;\n            const isDraggable = !event.button &&\n                (!noDragClassName || !hasSelector(target, `.${noDragClassName}`, domNode)) &&\n                (!handleSelector || hasSelector(target, handleSelector, domNode));\n            return isDraggable;\n        });\n        d3Selection.call(d3DragInstance);\n    }\n    function destroy() {\n        d3Selection?.on('.drag', null);\n    }\n    return {\n        update,\n        destroy,\n    };\n}\n\nfunction getNodesWithinDistance(position, nodeLookup, distance) {\n    const nodes = [];\n    const rect = {\n        x: position.x - distance,\n        y: position.y - distance,\n        width: distance * 2,\n        height: distance * 2,\n    };\n    for (const node of nodeLookup.values()) {\n        if (getOverlappingArea(rect, nodeToRect(node)) > 0) {\n            nodes.push(node);\n        }\n    }\n    return nodes;\n}\n/*\n * this distance is used for the area around the user pointer\n * while doing a connection for finding the closest nodes\n */\nconst ADDITIONAL_DISTANCE = 250;\nfunction getClosestHandle(position, connectionRadius, nodeLookup, fromHandle) {\n    let closestHandles = [];\n    let minDistance = Infinity;\n    const closeNodes = getNodesWithinDistance(position, nodeLookup, connectionRadius + ADDITIONAL_DISTANCE);\n    for (const node of closeNodes) {\n        const allHandles = [...(node.internals.handleBounds?.source ?? []), ...(node.internals.handleBounds?.target ?? [])];\n        for (const handle of allHandles) {\n            // if the handle is the same as the fromHandle we skip it\n            if (fromHandle.nodeId === handle.nodeId && fromHandle.type === handle.type && fromHandle.id === handle.id) {\n                continue;\n            }\n            // determine absolute position of the handle\n            const { x, y } = getHandlePosition(node, handle, handle.position, true);\n            const distance = Math.sqrt(Math.pow(x - position.x, 2) + Math.pow(y - position.y, 2));\n            if (distance > connectionRadius) {\n                continue;\n            }\n            if (distance < minDistance) {\n                closestHandles = [{ ...handle, x, y }];\n                minDistance = distance;\n            }\n            else if (distance === minDistance) {\n                // when multiple handles are on the same distance we collect all of them\n                closestHandles.push({ ...handle, x, y });\n            }\n        }\n    }\n    if (!closestHandles.length) {\n        return null;\n    }\n    // when multiple handles overlay each other we prefer the opposite handle\n    if (closestHandles.length > 1) {\n        const oppositeHandleType = fromHandle.type === 'source' ? 'target' : 'source';\n        return closestHandles.find((handle) => handle.type === oppositeHandleType) ?? closestHandles[0];\n    }\n    return closestHandles[0];\n}\nfunction getHandle(nodeId, handleType, handleId, nodeLookup, connectionMode, withAbsolutePosition = false) {\n    const node = nodeLookup.get(nodeId);\n    if (!node) {\n        return null;\n    }\n    const handles = connectionMode === 'strict'\n        ? node.internals.handleBounds?.[handleType]\n        : [...(node.internals.handleBounds?.source ?? []), ...(node.internals.handleBounds?.target ?? [])];\n    const handle = (handleId ? handles?.find((h) => h.id === handleId) : handles?.[0]) ?? null;\n    return handle && withAbsolutePosition\n        ? { ...handle, ...getHandlePosition(node, handle, handle.position, true) }\n        : handle;\n}\nfunction getHandleType(edgeUpdaterType, handleDomNode) {\n    if (edgeUpdaterType) {\n        return edgeUpdaterType;\n    }\n    else if (handleDomNode?.classList.contains('target')) {\n        return 'target';\n    }\n    else if (handleDomNode?.classList.contains('source')) {\n        return 'source';\n    }\n    return null;\n}\nfunction isConnectionValid(isInsideConnectionRadius, isHandleValid) {\n    let isValid = null;\n    if (isHandleValid) {\n        isValid = true;\n    }\n    else if (isInsideConnectionRadius && !isHandleValid) {\n        isValid = false;\n    }\n    return isValid;\n}\n\nconst alwaysValid = () => true;\nfunction onPointerDown(event, { connectionMode, connectionRadius, handleId, nodeId, edgeUpdaterType, isTarget, domNode, nodeLookup, lib, autoPanOnConnect, flowId, panBy, cancelConnection, onConnectStart, onConnect, onConnectEnd, isValidConnection = alwaysValid, onReconnectEnd, updateConnection, getTransform, getFromHandle, autoPanSpeed, dragThreshold = 1, handleDomNode, }) {\n    // when xyflow is used inside a shadow root we can't use document\n    const doc = getHostForElement(event.target);\n    let autoPanId = 0;\n    let closestHandle;\n    const { x, y } = getEventPosition(event);\n    const handleType = getHandleType(edgeUpdaterType, handleDomNode);\n    const containerBounds = domNode?.getBoundingClientRect();\n    let connectionStarted = false;\n    if (!containerBounds || !handleType) {\n        return;\n    }\n    const fromHandleInternal = getHandle(nodeId, handleType, handleId, nodeLookup, connectionMode);\n    if (!fromHandleInternal) {\n        return;\n    }\n    let position = getEventPosition(event, containerBounds);\n    let autoPanStarted = false;\n    let connection = null;\n    let isValid = false;\n    let resultHandleDomNode = null;\n    // when the user is moving the mouse close to the edge of the canvas while connecting we move the canvas\n    function autoPan() {\n        if (!autoPanOnConnect || !containerBounds) {\n            return;\n        }\n        const [x, y] = calcAutoPan(position, containerBounds, autoPanSpeed);\n        panBy({ x, y });\n        autoPanId = requestAnimationFrame(autoPan);\n    }\n    // Stays the same for all consecutive pointermove events\n    const fromHandle = {\n        ...fromHandleInternal,\n        nodeId,\n        type: handleType,\n        position: fromHandleInternal.position,\n    };\n    const fromNodeInternal = nodeLookup.get(nodeId);\n    const from = getHandlePosition(fromNodeInternal, fromHandle, Position.Left, true);\n    let previousConnection = {\n        inProgress: true,\n        isValid: null,\n        from,\n        fromHandle,\n        fromPosition: fromHandle.position,\n        fromNode: fromNodeInternal,\n        to: position,\n        toHandle: null,\n        toPosition: oppositePosition[fromHandle.position],\n        toNode: null,\n    };\n    function startConnection() {\n        connectionStarted = true;\n        updateConnection(previousConnection);\n        onConnectStart?.(event, { nodeId, handleId, handleType });\n    }\n    if (dragThreshold === 0) {\n        startConnection();\n    }\n    function onPointerMove(event) {\n        if (!connectionStarted) {\n            const { x: evtX, y: evtY } = getEventPosition(event);\n            const dx = evtX - x;\n            const dy = evtY - y;\n            const nextConnectionStarted = dx * dx + dy * dy > dragThreshold * dragThreshold;\n            if (!nextConnectionStarted) {\n                return;\n            }\n            startConnection();\n        }\n        if (!getFromHandle() || !fromHandle) {\n            onPointerUp(event);\n            return;\n        }\n        const transform = getTransform();\n        position = getEventPosition(event, containerBounds);\n        closestHandle = getClosestHandle(pointToRendererPoint(position, transform, false, [1, 1]), connectionRadius, nodeLookup, fromHandle);\n        if (!autoPanStarted) {\n            autoPan();\n            autoPanStarted = true;\n        }\n        const result = isValidHandle(event, {\n            handle: closestHandle,\n            connectionMode,\n            fromNodeId: nodeId,\n            fromHandleId: handleId,\n            fromType: isTarget ? 'target' : 'source',\n            isValidConnection,\n            doc,\n            lib,\n            flowId,\n            nodeLookup,\n        });\n        resultHandleDomNode = result.handleDomNode;\n        connection = result.connection;\n        isValid = isConnectionValid(!!closestHandle, result.isValid);\n        const newConnection = {\n            // from stays the same\n            ...previousConnection,\n            isValid,\n            to: result.toHandle && isValid\n                ? rendererPointToPoint({ x: result.toHandle.x, y: result.toHandle.y }, transform)\n                : position,\n            toHandle: result.toHandle,\n            toPosition: isValid && result.toHandle ? result.toHandle.position : oppositePosition[fromHandle.position],\n            toNode: result.toHandle ? nodeLookup.get(result.toHandle.nodeId) : null,\n        };\n        /*\n         * we don't want to trigger an update when the connection\n         * is snapped to the same handle as before\n         */\n        if (isValid &&\n            closestHandle &&\n            previousConnection.toHandle &&\n            newConnection.toHandle &&\n            previousConnection.toHandle.type === newConnection.toHandle.type &&\n            previousConnection.toHandle.nodeId === newConnection.toHandle.nodeId &&\n            previousConnection.toHandle.id === newConnection.toHandle.id &&\n            previousConnection.to.x === newConnection.to.x &&\n            previousConnection.to.y === newConnection.to.y) {\n            return;\n        }\n        updateConnection(newConnection);\n        previousConnection = newConnection;\n    }\n    function onPointerUp(event) {\n        // Prevent multi-touch aborting connection\n        if ('touches' in event && event.touches.length > 0) {\n            return;\n        }\n        if (connectionStarted) {\n            if ((closestHandle || resultHandleDomNode) && connection && isValid) {\n                onConnect?.(connection);\n            }\n            /*\n             * it's important to get a fresh reference from the store here\n             * in order to get the latest state of onConnectEnd\n             */\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            const { inProgress, ...connectionState } = previousConnection;\n            const finalConnectionState = {\n                ...connectionState,\n                toPosition: previousConnection.toHandle ? previousConnection.toPosition : null,\n            };\n            onConnectEnd?.(event, finalConnectionState);\n            if (edgeUpdaterType) {\n                onReconnectEnd?.(event, finalConnectionState);\n            }\n        }\n        cancelConnection();\n        cancelAnimationFrame(autoPanId);\n        autoPanStarted = false;\n        isValid = false;\n        connection = null;\n        resultHandleDomNode = null;\n        doc.removeEventListener('mousemove', onPointerMove);\n        doc.removeEventListener('mouseup', onPointerUp);\n        doc.removeEventListener('touchmove', onPointerMove);\n        doc.removeEventListener('touchend', onPointerUp);\n    }\n    doc.addEventListener('mousemove', onPointerMove);\n    doc.addEventListener('mouseup', onPointerUp);\n    doc.addEventListener('touchmove', onPointerMove);\n    doc.addEventListener('touchend', onPointerUp);\n}\n// checks if  and returns connection in fom of an object { source: 123, target: 312 }\nfunction isValidHandle(event, { handle, connectionMode, fromNodeId, fromHandleId, fromType, doc, lib, flowId, isValidConnection = alwaysValid, nodeLookup, }) {\n    const isTarget = fromType === 'target';\n    const handleDomNode = handle\n        ? doc.querySelector(`.${lib}-flow__handle[data-id=\"${flowId}-${handle?.nodeId}-${handle?.id}-${handle?.type}\"]`)\n        : null;\n    const { x, y } = getEventPosition(event);\n    const handleBelow = doc.elementFromPoint(x, y);\n    /*\n     * we always want to prioritize the handle below the mouse cursor over the closest distance handle,\n     * because it could be that the center of another handle is closer to the mouse pointer than the handle below the cursor\n     */\n    const handleToCheck = handleBelow?.classList.contains(`${lib}-flow__handle`) ? handleBelow : handleDomNode;\n    const result = {\n        handleDomNode: handleToCheck,\n        isValid: false,\n        connection: null,\n        toHandle: null,\n    };\n    if (handleToCheck) {\n        const handleType = getHandleType(undefined, handleToCheck);\n        const handleNodeId = handleToCheck.getAttribute('data-nodeid');\n        const handleId = handleToCheck.getAttribute('data-handleid');\n        const connectable = handleToCheck.classList.contains('connectable');\n        const connectableEnd = handleToCheck.classList.contains('connectableend');\n        if (!handleNodeId || !handleType) {\n            return result;\n        }\n        const connection = {\n            source: isTarget ? handleNodeId : fromNodeId,\n            sourceHandle: isTarget ? handleId : fromHandleId,\n            target: isTarget ? fromNodeId : handleNodeId,\n            targetHandle: isTarget ? fromHandleId : handleId,\n        };\n        result.connection = connection;\n        const isConnectable = connectable && connectableEnd;\n        // in strict mode we don't allow target to target or source to source connections\n        const isValid = isConnectable &&\n            (connectionMode === ConnectionMode.Strict\n                ? (isTarget && handleType === 'source') || (!isTarget && handleType === 'target')\n                : handleNodeId !== fromNodeId || handleId !== fromHandleId);\n        result.isValid = isValid && isValidConnection(connection);\n        result.toHandle = getHandle(handleNodeId, handleType, handleId, nodeLookup, connectionMode, true);\n    }\n    return result;\n}\nconst XYHandle = {\n    onPointerDown,\n    isValid: isValidHandle,\n};\n\nfunction XYMinimap({ domNode, panZoom, getTransform, getViewScale }) {\n    const selection = select(domNode);\n    function update({ translateExtent, width, height, zoomStep = 1, pannable = true, zoomable = true, inversePan = false, }) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const zoomHandler = (event) => {\n            if (event.sourceEvent.type !== 'wheel' || !panZoom) {\n                return;\n            }\n            const transform = getTransform();\n            const factor = event.sourceEvent.ctrlKey && isMacOs() ? 10 : 1;\n            const pinchDelta = -event.sourceEvent.deltaY *\n                (event.sourceEvent.deltaMode === 1 ? 0.05 : event.sourceEvent.deltaMode ? 1 : 0.002) *\n                zoomStep;\n            const nextZoom = transform[2] * Math.pow(2, pinchDelta * factor);\n            panZoom.scaleTo(nextZoom);\n        };\n        let panStart = [0, 0];\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const panStartHandler = (event) => {\n            if (event.sourceEvent.type === 'mousedown' || event.sourceEvent.type === 'touchstart') {\n                panStart = [\n                    event.sourceEvent.clientX ?? event.sourceEvent.touches[0].clientX,\n                    event.sourceEvent.clientY ?? event.sourceEvent.touches[0].clientY,\n                ];\n            }\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const panHandler = (event) => {\n            const transform = getTransform();\n            if ((event.sourceEvent.type !== 'mousemove' && event.sourceEvent.type !== 'touchmove') || !panZoom) {\n                return;\n            }\n            const panCurrent = [\n                event.sourceEvent.clientX ?? event.sourceEvent.touches[0].clientX,\n                event.sourceEvent.clientY ?? event.sourceEvent.touches[0].clientY,\n            ];\n            const panDelta = [panCurrent[0] - panStart[0], panCurrent[1] - panStart[1]];\n            panStart = panCurrent;\n            const moveScale = getViewScale() * Math.max(transform[2], Math.log(transform[2])) * (inversePan ? -1 : 1);\n            const position = {\n                x: transform[0] - panDelta[0] * moveScale,\n                y: transform[1] - panDelta[1] * moveScale,\n            };\n            const extent = [\n                [0, 0],\n                [width, height],\n            ];\n            panZoom.setViewportConstrained({\n                x: position.x,\n                y: position.y,\n                zoom: transform[2],\n            }, extent, translateExtent);\n        };\n        const zoomAndPanHandler = zoom()\n            .on('start', panStartHandler)\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            .on('zoom', pannable ? panHandler : null)\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            .on('zoom.wheel', zoomable ? zoomHandler : null);\n        selection.call(zoomAndPanHandler, {});\n    }\n    function destroy() {\n        selection.on('zoom', null);\n    }\n    return {\n        update,\n        destroy,\n        pointer,\n    };\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst viewChanged = (prevViewport, eventViewport) => prevViewport.x !== eventViewport.x || prevViewport.y !== eventViewport.y || prevViewport.zoom !== eventViewport.k;\nconst transformToViewport = (transform) => ({\n    x: transform.x,\n    y: transform.y,\n    zoom: transform.k,\n});\nconst viewportToTransform = ({ x, y, zoom }) => zoomIdentity.translate(x, y).scale(zoom);\nconst isWrappedWithClass = (event, className) => event.target.closest(`.${className}`);\nconst isRightClickPan = (panOnDrag, usedButton) => usedButton === 2 && Array.isArray(panOnDrag) && panOnDrag.includes(2);\n// taken from d3-ease: https://github.com/d3/d3-ease/blob/main/src/cubic.js\nconst defaultEase = (t) => ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2;\nconst getD3Transition = (selection, duration = 0, ease = defaultEase, onEnd = () => { }) => {\n    const hasDuration = typeof duration === 'number' && duration > 0;\n    if (!hasDuration) {\n        onEnd();\n    }\n    return hasDuration ? selection.transition().duration(duration).ease(ease).on('end', onEnd) : selection;\n};\nconst wheelDelta = (event) => {\n    const factor = event.ctrlKey && isMacOs() ? 10 : 1;\n    return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * factor;\n};\n\nfunction createPanOnScrollHandler({ zoomPanValues, noWheelClassName, d3Selection, d3Zoom, panOnScrollMode, panOnScrollSpeed, zoomOnPinch, onPanZoomStart, onPanZoom, onPanZoomEnd, }) {\n    return (event) => {\n        if (isWrappedWithClass(event, noWheelClassName)) {\n            if (event.ctrlKey) {\n                event.preventDefault(); // stop native page zoom for pinch zooming\n            }\n            return false;\n        }\n        event.preventDefault();\n        event.stopImmediatePropagation();\n        const currentZoom = d3Selection.property('__zoom').k || 1;\n        // macos sets ctrlKey=true for pinch gesture on a trackpad\n        if (event.ctrlKey && zoomOnPinch) {\n            const point = pointer(event);\n            const pinchDelta = wheelDelta(event);\n            const zoom = currentZoom * Math.pow(2, pinchDelta);\n            // @ts-ignore\n            d3Zoom.scaleTo(d3Selection, zoom, point, event);\n            return;\n        }\n        /*\n         * increase scroll speed in firefox\n         * firefox: deltaMode === 1; chrome: deltaMode === 0\n         */\n        const deltaNormalize = event.deltaMode === 1 ? 20 : 1;\n        let deltaX = panOnScrollMode === PanOnScrollMode.Vertical ? 0 : event.deltaX * deltaNormalize;\n        let deltaY = panOnScrollMode === PanOnScrollMode.Horizontal ? 0 : event.deltaY * deltaNormalize;\n        // this enables vertical scrolling with shift + scroll on windows\n        if (!isMacOs() && event.shiftKey && panOnScrollMode !== PanOnScrollMode.Vertical) {\n            deltaX = event.deltaY * deltaNormalize;\n            deltaY = 0;\n        }\n        d3Zoom.translateBy(d3Selection, -(deltaX / currentZoom) * panOnScrollSpeed, -(deltaY / currentZoom) * panOnScrollSpeed, \n        // @ts-ignore\n        { internal: true });\n        const nextViewport = transformToViewport(d3Selection.property('__zoom'));\n        clearTimeout(zoomPanValues.panScrollTimeout);\n        /*\n         * for pan on scroll we need to handle the event calls on our own\n         * we can't use the start, zoom and end events from d3-zoom\n         * because start and move gets called on every scroll event and not once at the beginning\n         */\n        if (!zoomPanValues.isPanScrolling) {\n            zoomPanValues.isPanScrolling = true;\n            onPanZoomStart?.(event, nextViewport);\n        }\n        if (zoomPanValues.isPanScrolling) {\n            onPanZoom?.(event, nextViewport);\n            zoomPanValues.panScrollTimeout = setTimeout(() => {\n                onPanZoomEnd?.(event, nextViewport);\n                zoomPanValues.isPanScrolling = false;\n            }, 150);\n        }\n    };\n}\nfunction createZoomOnScrollHandler({ noWheelClassName, preventScrolling, d3ZoomHandler }) {\n    return function (event, d) {\n        const isWheel = event.type === 'wheel';\n        // we still want to enable pinch zooming even if preventScrolling is set to false\n        const preventZoom = !preventScrolling && isWheel && !event.ctrlKey;\n        const hasNoWheelClass = isWrappedWithClass(event, noWheelClassName);\n        // if user is pinch zooming above a nowheel element, we don't want the browser to zoom\n        if (event.ctrlKey && isWheel && hasNoWheelClass) {\n            event.preventDefault();\n        }\n        if (preventZoom || hasNoWheelClass) {\n            return null;\n        }\n        event.preventDefault();\n        d3ZoomHandler.call(this, event, d);\n    };\n}\nfunction createPanZoomStartHandler({ zoomPanValues, onDraggingChange, onPanZoomStart }) {\n    return (event) => {\n        if (event.sourceEvent?.internal) {\n            return;\n        }\n        const viewport = transformToViewport(event.transform);\n        // we need to remember it here, because it's always 0 in the \"zoom\" event\n        zoomPanValues.mouseButton = event.sourceEvent?.button || 0;\n        zoomPanValues.isZoomingOrPanning = true;\n        zoomPanValues.prevViewport = viewport;\n        if (event.sourceEvent?.type === 'mousedown') {\n            onDraggingChange(true);\n        }\n        if (onPanZoomStart) {\n            onPanZoomStart?.(event.sourceEvent, viewport);\n        }\n    };\n}\nfunction createPanZoomHandler({ zoomPanValues, panOnDrag, onPaneContextMenu, onTransformChange, onPanZoom, }) {\n    return (event) => {\n        zoomPanValues.usedRightMouseButton = !!(onPaneContextMenu && isRightClickPan(panOnDrag, zoomPanValues.mouseButton ?? 0));\n        if (!event.sourceEvent?.sync) {\n            onTransformChange([event.transform.x, event.transform.y, event.transform.k]);\n        }\n        if (onPanZoom && !event.sourceEvent?.internal) {\n            onPanZoom?.(event.sourceEvent, transformToViewport(event.transform));\n        }\n    };\n}\nfunction createPanZoomEndHandler({ zoomPanValues, panOnDrag, panOnScroll, onDraggingChange, onPanZoomEnd, onPaneContextMenu, }) {\n    return (event) => {\n        if (event.sourceEvent?.internal) {\n            return;\n        }\n        zoomPanValues.isZoomingOrPanning = false;\n        if (onPaneContextMenu &&\n            isRightClickPan(panOnDrag, zoomPanValues.mouseButton ?? 0) &&\n            !zoomPanValues.usedRightMouseButton &&\n            event.sourceEvent) {\n            onPaneContextMenu(event.sourceEvent);\n        }\n        zoomPanValues.usedRightMouseButton = false;\n        onDraggingChange(false);\n        if (onPanZoomEnd && viewChanged(zoomPanValues.prevViewport, event.transform)) {\n            const viewport = transformToViewport(event.transform);\n            zoomPanValues.prevViewport = viewport;\n            clearTimeout(zoomPanValues.timerId);\n            zoomPanValues.timerId = setTimeout(() => {\n                onPanZoomEnd?.(event.sourceEvent, viewport);\n            }, \n            // we need a setTimeout for panOnScroll to supress multiple end events fired during scroll\n            panOnScroll ? 150 : 0);\n        }\n    };\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction createFilter({ zoomActivationKeyPressed, zoomOnScroll, zoomOnPinch, panOnDrag, panOnScroll, zoomOnDoubleClick, userSelectionActive, noWheelClassName, noPanClassName, lib, connectionInProgress, }) {\n    return (event) => {\n        const zoomScroll = zoomActivationKeyPressed || zoomOnScroll;\n        const pinchZoom = zoomOnPinch && event.ctrlKey;\n        const isWheelEvent = event.type === 'wheel';\n        if (event.button === 1 &&\n            event.type === 'mousedown' &&\n            (isWrappedWithClass(event, `${lib}-flow__node`) || isWrappedWithClass(event, `${lib}-flow__edge`))) {\n            return true;\n        }\n        // if all interactions are disabled, we prevent all zoom events\n        if (!panOnDrag && !zoomScroll && !panOnScroll && !zoomOnDoubleClick && !zoomOnPinch) {\n            return false;\n        }\n        // during a selection we prevent all other interactions\n        if (userSelectionActive) {\n            return false;\n        }\n        // we want to disable pinch-zooming while making a connection\n        if (connectionInProgress && !isWheelEvent) {\n            return false;\n        }\n        // if the target element is inside an element with the nowheel class, we prevent zooming\n        if (isWrappedWithClass(event, noWheelClassName) && isWheelEvent) {\n            return false;\n        }\n        // if the target element is inside an element with the nopan class, we prevent panning\n        if (isWrappedWithClass(event, noPanClassName) &&\n            (!isWheelEvent || (panOnScroll && isWheelEvent && !zoomActivationKeyPressed))) {\n            return false;\n        }\n        if (!zoomOnPinch && event.ctrlKey && isWheelEvent) {\n            return false;\n        }\n        if (!zoomOnPinch && event.type === 'touchstart' && event.touches?.length > 1) {\n            event.preventDefault(); // if you manage to start with 2 touches, we prevent native zoom\n            return false;\n        }\n        // when there is no scroll handling enabled, we prevent all wheel events\n        if (!zoomScroll && !panOnScroll && !pinchZoom && isWheelEvent) {\n            return false;\n        }\n        // if the pane is not movable, we prevent dragging it with mousestart or touchstart\n        if (!panOnDrag && (event.type === 'mousedown' || event.type === 'touchstart')) {\n            return false;\n        }\n        // if the pane is only movable using allowed clicks\n        if (Array.isArray(panOnDrag) && !panOnDrag.includes(event.button) && event.type === 'mousedown') {\n            return false;\n        }\n        // We only allow right clicks if pan on drag is set to right click\n        const buttonAllowed = (Array.isArray(panOnDrag) && panOnDrag.includes(event.button)) || !event.button || event.button <= 1;\n        // default filter for d3-zoom\n        return (!event.ctrlKey || isWheelEvent) && buttonAllowed;\n    };\n}\n\nfunction XYPanZoom({ domNode, minZoom, maxZoom, paneClickDistance, translateExtent, viewport, onPanZoom, onPanZoomStart, onPanZoomEnd, onDraggingChange, }) {\n    const zoomPanValues = {\n        isZoomingOrPanning: false,\n        usedRightMouseButton: false,\n        prevViewport: { x: 0, y: 0, zoom: 0 },\n        mouseButton: 0,\n        timerId: undefined,\n        panScrollTimeout: undefined,\n        isPanScrolling: false,\n    };\n    const bbox = domNode.getBoundingClientRect();\n    const d3ZoomInstance = zoom()\n        .clickDistance(!isNumeric(paneClickDistance) || paneClickDistance < 0 ? 0 : paneClickDistance)\n        .scaleExtent([minZoom, maxZoom])\n        .translateExtent(translateExtent);\n    const d3Selection = select(domNode).call(d3ZoomInstance);\n    setViewportConstrained({\n        x: viewport.x,\n        y: viewport.y,\n        zoom: clamp(viewport.zoom, minZoom, maxZoom),\n    }, [\n        [0, 0],\n        [bbox.width, bbox.height],\n    ], translateExtent);\n    const d3ZoomHandler = d3Selection.on('wheel.zoom');\n    const d3DblClickZoomHandler = d3Selection.on('dblclick.zoom');\n    d3ZoomInstance.wheelDelta(wheelDelta);\n    function setTransform(transform, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.interpolate(options?.interpolate === 'linear' ? interpolate : interpolateZoom).transform(getD3Transition(d3Selection, options?.duration, options?.ease, () => resolve(true)), transform);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    // public functions\n    function update({ noWheelClassName, noPanClassName, onPaneContextMenu, userSelectionActive, panOnScroll, panOnDrag, panOnScrollMode, panOnScrollSpeed, preventScrolling, zoomOnPinch, zoomOnScroll, zoomOnDoubleClick, zoomActivationKeyPressed, lib, onTransformChange, connectionInProgress, }) {\n        if (userSelectionActive && !zoomPanValues.isZoomingOrPanning) {\n            destroy();\n        }\n        const isPanOnScroll = panOnScroll && !zoomActivationKeyPressed && !userSelectionActive;\n        const wheelHandler = isPanOnScroll\n            ? createPanOnScrollHandler({\n                zoomPanValues,\n                noWheelClassName,\n                d3Selection,\n                d3Zoom: d3ZoomInstance,\n                panOnScrollMode,\n                panOnScrollSpeed,\n                zoomOnPinch,\n                onPanZoomStart,\n                onPanZoom,\n                onPanZoomEnd,\n            })\n            : createZoomOnScrollHandler({\n                noWheelClassName,\n                preventScrolling,\n                d3ZoomHandler,\n            });\n        d3Selection.on('wheel.zoom', wheelHandler, { passive: false });\n        if (!userSelectionActive) {\n            // pan zoom start\n            const startHandler = createPanZoomStartHandler({\n                zoomPanValues,\n                onDraggingChange,\n                onPanZoomStart,\n            });\n            d3ZoomInstance.on('start', startHandler);\n            // pan zoom\n            const panZoomHandler = createPanZoomHandler({\n                zoomPanValues,\n                panOnDrag,\n                onPaneContextMenu: !!onPaneContextMenu,\n                onPanZoom,\n                onTransformChange,\n            });\n            d3ZoomInstance.on('zoom', panZoomHandler);\n            // pan zoom end\n            const panZoomEndHandler = createPanZoomEndHandler({\n                zoomPanValues,\n                panOnDrag,\n                panOnScroll,\n                onPaneContextMenu,\n                onPanZoomEnd,\n                onDraggingChange,\n            });\n            d3ZoomInstance.on('end', panZoomEndHandler);\n        }\n        const filter = createFilter({\n            zoomActivationKeyPressed,\n            panOnDrag,\n            zoomOnScroll,\n            panOnScroll,\n            zoomOnDoubleClick,\n            zoomOnPinch,\n            userSelectionActive,\n            noPanClassName,\n            noWheelClassName,\n            lib,\n            connectionInProgress,\n        });\n        d3ZoomInstance.filter(filter);\n        /*\n         * We cannot add zoomOnDoubleClick to the filter above because\n         * double tapping on touch screens circumvents the filter and\n         * dblclick.zoom is fired on the selection directly\n         */\n        if (zoomOnDoubleClick) {\n            d3Selection.on('dblclick.zoom', d3DblClickZoomHandler);\n        }\n        else {\n            d3Selection.on('dblclick.zoom', null);\n        }\n    }\n    function destroy() {\n        d3ZoomInstance.on('zoom', null);\n    }\n    async function setViewportConstrained(viewport, extent, translateExtent) {\n        const nextTransform = viewportToTransform(viewport);\n        const contrainedTransform = d3ZoomInstance?.constrain()(nextTransform, extent, translateExtent);\n        if (contrainedTransform) {\n            await setTransform(contrainedTransform);\n        }\n        return new Promise((resolve) => resolve(contrainedTransform));\n    }\n    async function setViewport(viewport, options) {\n        const nextTransform = viewportToTransform(viewport);\n        await setTransform(nextTransform, options);\n        return new Promise((resolve) => resolve(nextTransform));\n    }\n    function syncViewport(viewport) {\n        if (d3Selection) {\n            const nextTransform = viewportToTransform(viewport);\n            const currentTransform = d3Selection.property('__zoom');\n            if (currentTransform.k !== viewport.zoom ||\n                currentTransform.x !== viewport.x ||\n                currentTransform.y !== viewport.y) {\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                d3ZoomInstance?.transform(d3Selection, nextTransform, null, { sync: true });\n            }\n        }\n    }\n    function getViewport() {\n        const transform = d3Selection ? zoomTransform(d3Selection.node()) : { x: 0, y: 0, k: 1 };\n        return { x: transform.x, y: transform.y, zoom: transform.k };\n    }\n    function scaleTo(zoom, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.interpolate(options?.interpolate === 'linear' ? interpolate : interpolateZoom).scaleTo(getD3Transition(d3Selection, options?.duration, options?.ease, () => resolve(true)), zoom);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    function scaleBy(factor, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.interpolate(options?.interpolate === 'linear' ? interpolate : interpolateZoom).scaleBy(getD3Transition(d3Selection, options?.duration, options?.ease, () => resolve(true)), factor);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    function setScaleExtent(scaleExtent) {\n        d3ZoomInstance?.scaleExtent(scaleExtent);\n    }\n    function setTranslateExtent(translateExtent) {\n        d3ZoomInstance?.translateExtent(translateExtent);\n    }\n    function setClickDistance(distance) {\n        const validDistance = !isNumeric(distance) || distance < 0 ? 0 : distance;\n        d3ZoomInstance?.clickDistance(validDistance);\n    }\n    return {\n        update,\n        destroy,\n        setViewport,\n        setViewportConstrained,\n        getViewport,\n        scaleTo,\n        scaleBy,\n        setScaleExtent,\n        setTranslateExtent,\n        syncViewport,\n        setClickDistance,\n    };\n}\n\n/**\n * Used to determine the variant of the resize control\n *\n * @public\n */\nvar ResizeControlVariant;\n(function (ResizeControlVariant) {\n    ResizeControlVariant[\"Line\"] = \"line\";\n    ResizeControlVariant[\"Handle\"] = \"handle\";\n})(ResizeControlVariant || (ResizeControlVariant = {}));\nconst XY_RESIZER_HANDLE_POSITIONS = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];\nconst XY_RESIZER_LINE_POSITIONS = ['top', 'right', 'bottom', 'left'];\n\n/**\n * Get all connecting edges for a given set of nodes\n * @param width - new width of the node\n * @param prevWidth - previous width of the node\n * @param height - new height of the node\n * @param prevHeight - previous height of the node\n * @param affectsX - whether to invert the resize direction for the x axis\n * @param affectsY - whether to invert the resize direction for the y axis\n * @returns array of two numbers representing the direction of the resize for each axis, 0 = no change, 1 = increase, -1 = decrease\n */\nfunction getResizeDirection({ width, prevWidth, height, prevHeight, affectsX, affectsY, }) {\n    const deltaWidth = width - prevWidth;\n    const deltaHeight = height - prevHeight;\n    const direction = [deltaWidth > 0 ? 1 : deltaWidth < 0 ? -1 : 0, deltaHeight > 0 ? 1 : deltaHeight < 0 ? -1 : 0];\n    if (deltaWidth && affectsX) {\n        direction[0] = direction[0] * -1;\n    }\n    if (deltaHeight && affectsY) {\n        direction[1] = direction[1] * -1;\n    }\n    return direction;\n}\n/**\n * Parses the control position that is being dragged to dimensions that are being resized\n * @param controlPosition - position of the control that is being dragged\n * @returns isHorizontal, isVertical, affectsX, affectsY,\n */\nfunction getControlDirection(controlPosition) {\n    const isHorizontal = controlPosition.includes('right') || controlPosition.includes('left');\n    const isVertical = controlPosition.includes('bottom') || controlPosition.includes('top');\n    const affectsX = controlPosition.includes('left');\n    const affectsY = controlPosition.includes('top');\n    return {\n        isHorizontal,\n        isVertical,\n        affectsX,\n        affectsY,\n    };\n}\nfunction getLowerExtentClamp(lowerExtent, lowerBound) {\n    return Math.max(0, lowerBound - lowerExtent);\n}\nfunction getUpperExtentClamp(upperExtent, upperBound) {\n    return Math.max(0, upperExtent - upperBound);\n}\nfunction getSizeClamp(size, minSize, maxSize) {\n    return Math.max(0, minSize - size, size - maxSize);\n}\nfunction xor(a, b) {\n    return a ? !b : b;\n}\n/**\n * Calculates new width & height and x & y of node after resize based on pointer position\n * @description - Buckle up, this is a chunky one... If you want to determine the new dimensions of a node after a resize,\n * you have to account for all possible restrictions: min/max width/height of the node, the maximum extent the node is allowed\n * to move in (in this case: resize into) determined by the parent node, the minimal extent determined by child nodes\n * with expandParent or extent: 'parent' set and oh yeah, these things also have to work with keepAspectRatio!\n * The way this is done is by determining how much each of these restricting actually restricts the resize and then applying the\n * strongest restriction. Because the resize affects x, y and width, height and width, height of a opposing side with keepAspectRatio,\n * the resize amount is always kept in distX & distY amount (the distance in mouse movement)\n * Instead of clamping each value, we first calculate the biggest 'clamp' (for the lack of a better name) and then apply it to all values.\n * To complicate things nodeOrigin has to be taken into account as well. This is done by offsetting the nodes as if their origin is [0, 0],\n * then calculating the restrictions as usual\n * @param startValues - starting values of resize\n * @param controlDirection - dimensions affected by the resize\n * @param pointerPosition - the current pointer position corrected for snapping\n * @param boundaries - minimum and maximum dimensions of the node\n * @param keepAspectRatio - prevent changes of asprect ratio\n * @returns x, y, width and height of the node after resize\n */\nfunction getDimensionsAfterResize(startValues, controlDirection, pointerPosition, boundaries, keepAspectRatio, nodeOrigin, extent, childExtent) {\n    let { affectsX, affectsY } = controlDirection;\n    const { isHorizontal, isVertical } = controlDirection;\n    const isDiagonal = isHorizontal && isVertical;\n    const { xSnapped, ySnapped } = pointerPosition;\n    const { minWidth, maxWidth, minHeight, maxHeight } = boundaries;\n    const { x: startX, y: startY, width: startWidth, height: startHeight, aspectRatio } = startValues;\n    let distX = Math.floor(isHorizontal ? xSnapped - startValues.pointerX : 0);\n    let distY = Math.floor(isVertical ? ySnapped - startValues.pointerY : 0);\n    const newWidth = startWidth + (affectsX ? -distX : distX);\n    const newHeight = startHeight + (affectsY ? -distY : distY);\n    const originOffsetX = -nodeOrigin[0] * startWidth;\n    const originOffsetY = -nodeOrigin[1] * startHeight;\n    // Check if maxWidth, minWWidth, maxHeight, minHeight are restricting the resize\n    let clampX = getSizeClamp(newWidth, minWidth, maxWidth);\n    let clampY = getSizeClamp(newHeight, minHeight, maxHeight);\n    // Check if extent is restricting the resize\n    if (extent) {\n        let xExtentClamp = 0;\n        let yExtentClamp = 0;\n        if (affectsX && distX < 0) {\n            xExtentClamp = getLowerExtentClamp(startX + distX + originOffsetX, extent[0][0]);\n        }\n        else if (!affectsX && distX > 0) {\n            xExtentClamp = getUpperExtentClamp(startX + newWidth + originOffsetX, extent[1][0]);\n        }\n        if (affectsY && distY < 0) {\n            yExtentClamp = getLowerExtentClamp(startY + distY + originOffsetY, extent[0][1]);\n        }\n        else if (!affectsY && distY > 0) {\n            yExtentClamp = getUpperExtentClamp(startY + newHeight + originOffsetY, extent[1][1]);\n        }\n        clampX = Math.max(clampX, xExtentClamp);\n        clampY = Math.max(clampY, yExtentClamp);\n    }\n    // Check if the child extent is restricting the resize\n    if (childExtent) {\n        let xExtentClamp = 0;\n        let yExtentClamp = 0;\n        if (affectsX && distX > 0) {\n            xExtentClamp = getUpperExtentClamp(startX + distX, childExtent[0][0]);\n        }\n        else if (!affectsX && distX < 0) {\n            xExtentClamp = getLowerExtentClamp(startX + newWidth, childExtent[1][0]);\n        }\n        if (affectsY && distY > 0) {\n            yExtentClamp = getUpperExtentClamp(startY + distY, childExtent[0][1]);\n        }\n        else if (!affectsY && distY < 0) {\n            yExtentClamp = getLowerExtentClamp(startY + newHeight, childExtent[1][1]);\n        }\n        clampX = Math.max(clampX, xExtentClamp);\n        clampY = Math.max(clampY, yExtentClamp);\n    }\n    // Check if the aspect ratio resizing of the other side is restricting the resize\n    if (keepAspectRatio) {\n        if (isHorizontal) {\n            // Check if the max dimensions might be restricting the resize\n            const aspectHeightClamp = getSizeClamp(newWidth / aspectRatio, minHeight, maxHeight) * aspectRatio;\n            clampX = Math.max(clampX, aspectHeightClamp);\n            // Check if the extent is restricting the resize\n            if (extent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsX && !affectsY && isDiagonal)) {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startY + originOffsetY + newWidth / aspectRatio, extent[1][1]) * aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getLowerExtentClamp(startY + originOffsetY + (affectsX ? distX : -distX) / aspectRatio, extent[0][1]) *\n                            aspectRatio;\n                }\n                clampX = Math.max(clampX, aspectExtentClamp);\n            }\n            // Check if the child extent is restricting the resize\n            if (childExtent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsX && !affectsY && isDiagonal)) {\n                    aspectExtentClamp = getLowerExtentClamp(startY + newWidth / aspectRatio, childExtent[1][1]) * aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startY + (affectsX ? distX : -distX) / aspectRatio, childExtent[0][1]) * aspectRatio;\n                }\n                clampX = Math.max(clampX, aspectExtentClamp);\n            }\n        }\n        // Do the same thing for vertical resizing\n        if (isVertical) {\n            const aspectWidthClamp = getSizeClamp(newHeight * aspectRatio, minWidth, maxWidth) / aspectRatio;\n            clampY = Math.max(clampY, aspectWidthClamp);\n            if (extent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsY && !affectsX && isDiagonal)) {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startX + newHeight * aspectRatio + originOffsetX, extent[1][0]) / aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getLowerExtentClamp(startX + (affectsY ? distY : -distY) * aspectRatio + originOffsetX, extent[0][0]) /\n                            aspectRatio;\n                }\n                clampY = Math.max(clampY, aspectExtentClamp);\n            }\n            if (childExtent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsY && !affectsX && isDiagonal)) {\n                    aspectExtentClamp = getLowerExtentClamp(startX + newHeight * aspectRatio, childExtent[1][0]) / aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startX + (affectsY ? distY : -distY) * aspectRatio, childExtent[0][0]) / aspectRatio;\n                }\n                clampY = Math.max(clampY, aspectExtentClamp);\n            }\n        }\n    }\n    distY = distY + (distY < 0 ? clampY : -clampY);\n    distX = distX + (distX < 0 ? clampX : -clampX);\n    if (keepAspectRatio) {\n        if (isDiagonal) {\n            if (newWidth > newHeight * aspectRatio) {\n                distY = (xor(affectsX, affectsY) ? -distX : distX) / aspectRatio;\n            }\n            else {\n                distX = (xor(affectsX, affectsY) ? -distY : distY) * aspectRatio;\n            }\n        }\n        else {\n            if (isHorizontal) {\n                distY = distX / aspectRatio;\n                affectsY = affectsX;\n            }\n            else {\n                distX = distY * aspectRatio;\n                affectsX = affectsY;\n            }\n        }\n    }\n    const x = affectsX ? startX + distX : startX;\n    const y = affectsY ? startY + distY : startY;\n    return {\n        width: startWidth + (affectsX ? -distX : distX),\n        height: startHeight + (affectsY ? -distY : distY),\n        x: nodeOrigin[0] * distX * (!affectsX ? 1 : -1) + x,\n        y: nodeOrigin[1] * distY * (!affectsY ? 1 : -1) + y,\n    };\n}\n\nconst initPrevValues = { width: 0, height: 0, x: 0, y: 0 };\nconst initStartValues = {\n    ...initPrevValues,\n    pointerX: 0,\n    pointerY: 0,\n    aspectRatio: 1,\n};\nfunction nodeToParentExtent(node) {\n    return [\n        [0, 0],\n        [node.measured.width, node.measured.height],\n    ];\n}\nfunction nodeToChildExtent(child, parent, nodeOrigin) {\n    const x = parent.position.x + child.position.x;\n    const y = parent.position.y + child.position.y;\n    const width = child.measured.width ?? 0;\n    const height = child.measured.height ?? 0;\n    const originOffsetX = nodeOrigin[0] * width;\n    const originOffsetY = nodeOrigin[1] * height;\n    return [\n        [x - originOffsetX, y - originOffsetY],\n        [x + width - originOffsetX, y + height - originOffsetY],\n    ];\n}\nfunction XYResizer({ domNode, nodeId, getStoreItems, onChange, onEnd }) {\n    const selection = select(domNode);\n    function update({ controlPosition, boundaries, keepAspectRatio, resizeDirection, onResizeStart, onResize, onResizeEnd, shouldResize, }) {\n        let prevValues = { ...initPrevValues };\n        let startValues = { ...initStartValues };\n        const controlDirection = getControlDirection(controlPosition);\n        let node = undefined;\n        let containerBounds = null;\n        let childNodes = [];\n        let parentNode = undefined; // Needed to fix expandParent\n        let parentExtent = undefined;\n        let childExtent = undefined;\n        // we only want to trigger onResizeEnd if onResize was actually called\n        let resizeDetected = false;\n        const dragHandler = drag()\n            .on('start', (event) => {\n            const { nodeLookup, transform, snapGrid, snapToGrid, nodeOrigin, paneDomNode } = getStoreItems();\n            node = nodeLookup.get(nodeId);\n            if (!node) {\n                return;\n            }\n            containerBounds = paneDomNode?.getBoundingClientRect() ?? null;\n            const { xSnapped, ySnapped } = getPointerPosition(event.sourceEvent, {\n                transform,\n                snapGrid,\n                snapToGrid,\n                containerBounds,\n            });\n            prevValues = {\n                width: node.measured.width ?? 0,\n                height: node.measured.height ?? 0,\n                x: node.position.x ?? 0,\n                y: node.position.y ?? 0,\n            };\n            startValues = {\n                ...prevValues,\n                pointerX: xSnapped,\n                pointerY: ySnapped,\n                aspectRatio: prevValues.width / prevValues.height,\n            };\n            parentNode = undefined;\n            if (node.parentId && (node.extent === 'parent' || node.expandParent)) {\n                parentNode = nodeLookup.get(node.parentId);\n                parentExtent = parentNode && node.extent === 'parent' ? nodeToParentExtent(parentNode) : undefined;\n            }\n            /*\n             * Collect all child nodes to correct their relative positions when top/left changes\n             * Determine largest minimal extent the parent node is allowed to resize to\n             */\n            childNodes = [];\n            childExtent = undefined;\n            for (const [childId, child] of nodeLookup) {\n                if (child.parentId === nodeId) {\n                    childNodes.push({\n                        id: childId,\n                        position: { ...child.position },\n                        extent: child.extent,\n                    });\n                    if (child.extent === 'parent' || child.expandParent) {\n                        const extent = nodeToChildExtent(child, node, child.origin ?? nodeOrigin);\n                        if (childExtent) {\n                            childExtent = [\n                                [Math.min(extent[0][0], childExtent[0][0]), Math.min(extent[0][1], childExtent[0][1])],\n                                [Math.max(extent[1][0], childExtent[1][0]), Math.max(extent[1][1], childExtent[1][1])],\n                            ];\n                        }\n                        else {\n                            childExtent = extent;\n                        }\n                    }\n                }\n            }\n            onResizeStart?.(event, { ...prevValues });\n        })\n            .on('drag', (event) => {\n            const { transform, snapGrid, snapToGrid, nodeOrigin: storeNodeOrigin } = getStoreItems();\n            const pointerPosition = getPointerPosition(event.sourceEvent, {\n                transform,\n                snapGrid,\n                snapToGrid,\n                containerBounds,\n            });\n            const childChanges = [];\n            if (!node) {\n                return;\n            }\n            const { x: prevX, y: prevY, width: prevWidth, height: prevHeight } = prevValues;\n            const change = {};\n            const nodeOrigin = node.origin ?? storeNodeOrigin;\n            const { width, height, x, y } = getDimensionsAfterResize(startValues, controlDirection, pointerPosition, boundaries, keepAspectRatio, nodeOrigin, parentExtent, childExtent);\n            const isWidthChange = width !== prevWidth;\n            const isHeightChange = height !== prevHeight;\n            const isXPosChange = x !== prevX && isWidthChange;\n            const isYPosChange = y !== prevY && isHeightChange;\n            if (!isXPosChange && !isYPosChange && !isWidthChange && !isHeightChange) {\n                return;\n            }\n            if (isXPosChange || isYPosChange || nodeOrigin[0] === 1 || nodeOrigin[1] === 1) {\n                change.x = isXPosChange ? x : prevValues.x;\n                change.y = isYPosChange ? y : prevValues.y;\n                prevValues.x = change.x;\n                prevValues.y = change.y;\n                /*\n                 * when top/left changes, correct the relative positions of child nodes\n                 * so that they stay in the same position\n                 */\n                if (childNodes.length > 0) {\n                    const xChange = x - prevX;\n                    const yChange = y - prevY;\n                    for (const childNode of childNodes) {\n                        childNode.position = {\n                            x: childNode.position.x - xChange + nodeOrigin[0] * (width - prevWidth),\n                            y: childNode.position.y - yChange + nodeOrigin[1] * (height - prevHeight),\n                        };\n                        childChanges.push(childNode);\n                    }\n                }\n            }\n            if (isWidthChange || isHeightChange) {\n                change.width =\n                    isWidthChange && (!resizeDirection || resizeDirection === 'horizontal') ? width : prevValues.width;\n                change.height =\n                    isHeightChange && (!resizeDirection || resizeDirection === 'vertical') ? height : prevValues.height;\n                prevValues.width = change.width;\n                prevValues.height = change.height;\n            }\n            // Fix expandParent when resizing from top/left\n            if (parentNode && node.expandParent) {\n                const xLimit = nodeOrigin[0] * (change.width ?? 0);\n                if (change.x && change.x < xLimit) {\n                    prevValues.x = xLimit;\n                    startValues.x = startValues.x - (change.x - xLimit);\n                }\n                const yLimit = nodeOrigin[1] * (change.height ?? 0);\n                if (change.y && change.y < yLimit) {\n                    prevValues.y = yLimit;\n                    startValues.y = startValues.y - (change.y - yLimit);\n                }\n            }\n            const direction = getResizeDirection({\n                width: prevValues.width,\n                prevWidth,\n                height: prevValues.height,\n                prevHeight,\n                affectsX: controlDirection.affectsX,\n                affectsY: controlDirection.affectsY,\n            });\n            const nextValues = { ...prevValues, direction };\n            const callResize = shouldResize?.(event, nextValues);\n            if (callResize === false) {\n                return;\n            }\n            resizeDetected = true;\n            onResize?.(event, nextValues);\n            onChange(change, childChanges);\n        })\n            .on('end', (event) => {\n            if (!resizeDetected) {\n                return;\n            }\n            onResizeEnd?.(event, { ...prevValues });\n            onEnd?.({ ...prevValues });\n            resizeDetected = false;\n        });\n        selection.call(dragHandler);\n    }\n    function destroy() {\n        selection.on('.drag', null);\n    }\n    return {\n        update,\n        destroy,\n    };\n}\n\nexport { ConnectionLineType, ConnectionMode, MarkerType, PanOnScrollMode, Position, ResizeControlVariant, SelectionMode, XYDrag, XYHandle, XYMinimap, XYPanZoom, XYResizer, XY_RESIZER_HANDLE_POSITIONS, XY_RESIZER_LINE_POSITIONS, addEdge, adoptUserNodes, areConnectionMapsEqual, areSetsEqual, boxToRect, calcAutoPan, calculateNodePosition, clamp, clampPosition, clampPositionToParent, createMarkerIds, defaultAriaLabelConfig, devWarn, elementSelectionKeys, errorMessages, evaluateAbsolutePosition, fitViewport, getBezierEdgeCenter, getBezierPath, getBoundsOfBoxes, getBoundsOfRects, getConnectedEdges, getConnectionStatus, getDimensions, getEdgeCenter, getEdgePosition, getElementsToRemove, getElevatedEdgeZIndex, getEventPosition, getHandleBounds, getHandlePosition, getHostForElement, getIncomers, getInternalNodesBounds, getMarkerId, getNodeDimensions, getNodePositionWithOrigin, getNodeToolbarTransform, getNodesBounds, getNodesInside, getOutgoers, getOverlappingArea, getPointerPosition, getSmoothStepPath, getStraightPath, getViewportForBounds, handleConnectionChange, handleExpandParent, infiniteExtent, initialConnection, isCoordinateExtent, isEdgeBase, isEdgeVisible, isInputDOMNode, isInternalNodeBase, isMacOs, isMouseEvent, isNodeBase, isNumeric, isRectObject, mergeAriaLabelConfig, nodeHasDimensions, nodeToBox, nodeToRect, oppositePosition, panBy, pointToRendererPoint, reconnectEdge, rectToBox, rendererPointToPoint, shallowNodeData, snapPosition, updateAbsolutePositions, updateConnectionLookup, updateNodeInternals, withResolvers };\n","/**\r\n * FlowInstance - Core wrapper around @xyflow/system\r\n * This class provides the main API for interacting with the flow\r\n */\r\n\r\nimport { XYPanZoom } from '@xyflow/system';\r\nimport type { PanOnScrollMode, Transform } from '@xyflow/system';\r\nimport type { Node, Edge, FlowOptions, FlowState, InternalNode, Viewport } from './types';\r\n\r\nexport class FlowInstance {\r\n  private container: HTMLElement | null = null;\r\n  private state: FlowState = {\r\n    nodes: [],\r\n    edges: [],\r\n    viewport: { x: 0, y: 0, zoom: 1 },\r\n    nodeLookup: new Map(),\r\n    edgeLookup: new Map()\r\n  };\r\n  private subscribers: Set<(state: FlowState) => void> = new Set();\r\n  private panZoomInstance: ReturnType<typeof XYPanZoom> | null = null;\r\n  private options: FlowOptions;\r\n  \r\n  // Track nodes that are pending rendering\r\n  private pendingNodes: string[] = [];\r\n\r\n  constructor(options: FlowOptions = {}) {\r\n    this.options = {\r\n      minZoom: 0.5,\r\n      maxZoom: 2,\r\n      defaultZoom: 1,\r\n      nodesDraggable: true,\r\n      nodesConnectable: true,\r\n      elementsSelectable: true,\r\n      ...options\r\n    };\r\n    \r\n    this.state.nodes = options.nodes || [];\r\n    this.state.edges = options.edges || [];\r\n    this.updateLookups();\r\n  }\r\n\r\n  mount(container: HTMLElement) {\r\n    this.container = container;\r\n    \r\n    // Initialize XYPanZoom for viewport control\r\n    this.panZoomInstance = XYPanZoom({\r\n      domNode: container,\r\n      minZoom: this.options.minZoom || 0.5,\r\n      maxZoom: this.options.maxZoom || 2,\r\n      paneClickDistance: 0,\r\n      translateExtent: [[-Infinity, -Infinity], [Infinity, Infinity]],\r\n      viewport: this.state.viewport,\r\n      onDraggingChange: (isDragging: boolean) => {\r\n        // Toggle panning cursor\r\n        this.container?.classList.toggle('panning', isDragging);\r\n      },\r\n      onPanZoom: (_event, viewport) => {\r\n        this.state.viewport = viewport;\r\n        this.notifySubscribers();\r\n      },\r\n      onPanZoomStart: (_event, _viewport) => {\r\n        // Handle pan/zoom start\r\n      },\r\n      onPanZoomEnd: (_event, _viewport) => {\r\n        // Handle pan/zoom end\r\n      }\r\n    });\r\n\r\n    // Enable panning/zooming interactions\r\n    this.panZoomInstance.update({\r\n      noWheelClassName: 'nowheel',\r\n      noPanClassName: 'nopan',\r\n      onPaneContextMenu: undefined,\r\n      preventScrolling: true,\r\n      panOnScroll: true,\r\n      panOnDrag: true,\r\n      panOnScrollMode: 'free' as unknown as PanOnScrollMode,\r\n      panOnScrollSpeed: 0.8,\r\n      userSelectionActive: false,\r\n      zoomOnPinch: true,\r\n      zoomOnScroll: true,\r\n      zoomOnDoubleClick: true,\r\n      zoomActivationKeyPressed: false,\r\n      lib: 'lit-flow',\r\n      onTransformChange: (_t: Transform) => {},\r\n      connectionInProgress: false,\r\n    });\r\n\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  destroy() {\r\n    this.panZoomInstance?.destroy();\r\n    this.panZoomInstance = null;\r\n    this.container = null;\r\n    this.subscribers.clear();\r\n  }\r\n\r\n  getState(): FlowState {\r\n    return this.state;\r\n  }\r\n\r\n  get nodes(): Node[] {\r\n    return this.state.nodes;\r\n  }\r\n\r\n  get edges(): Edge[] {\r\n    return this.state.edges;\r\n  }\r\n\r\n  getViewport(): Viewport {\r\n    return this.state.viewport;\r\n  }\r\n\r\n  setViewport(viewport: Viewport) {\r\n    this.state.viewport = viewport;\r\n    this.panZoomInstance?.setViewport?.(viewport);\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  setNodes(nodes: Node[]) {\r\n    // Register all node IDs as pending\r\n    this.pendingNodes.push(...nodes.map(node => node.id));\r\n    \r\n    this.state.nodes = nodes;\r\n    this.updateLookups();\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  setEdges(edges: Edge[]) {\r\n    this.retryEdgeRendering(edges);\r\n  }\r\n\r\n  updateNode(id: string, updates: Partial<Node>) {\r\n    this.state.nodes = this.state.nodes.map(node => \r\n      node.id === id ? { ...node, ...updates } : node\r\n    );\r\n    this.updateLookups();\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  updateEdge(id: string, updates: Partial<Edge>) {\r\n    this.state.edges = this.state.edges.map(edge => \r\n      edge.id === id ? { ...edge, ...updates } : edge\r\n    );\r\n    this.updateLookups();\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  addNode(node: Node) {\r\n    this.state.nodes = [...this.state.nodes, node];\r\n    this.updateLookups();\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  removeNode(id: string) {\r\n    this.state.nodes = this.state.nodes.filter(node => node.id !== id);\r\n    // Also remove connected edges\r\n    this.state.edges = this.state.edges.filter(\r\n      edge => edge.source !== id && edge.target !== id\r\n    );\r\n    this.updateLookups();\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  addEdge(edge: Edge) {\r\n    this.state.edges = [...this.state.edges, edge];\r\n    this.updateLookups();\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  removeEdge(id: string) {\r\n    this.state.edges = this.state.edges.filter(edge => edge.id !== id);\r\n    this.updateLookups();\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  subscribe(callback: (state: FlowState) => void): () => void {\r\n    this.subscribers.add(callback);\r\n    return () => this.subscribers.delete(callback);\r\n  }\r\n\r\n  zoomIn() {\r\n    const currentZoom = this.state.viewport.zoom;\r\n    const newZoom = Math.min(currentZoom * 1.2, this.options.maxZoom || 2);\r\n    this.setViewport({ ...this.state.viewport, zoom: newZoom });\r\n  }\r\n\r\n  zoomOut() {\r\n    const currentZoom = this.state.viewport.zoom;\r\n    const newZoom = Math.max(currentZoom / 1.2, this.options.minZoom || 0.5);\r\n    this.setViewport({ ...this.state.viewport, zoom: newZoom });\r\n  }\r\n\r\n  fitView() {\r\n    if (this.state.nodes.length === 0 || !this.container) return;\r\n\r\n    // Calculate bounds of all nodes\r\n    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n    \r\n    this.state.nodes.forEach(node => {\r\n      const width = node.measured?.width || node.width || 150;\r\n      const height = node.measured?.height || node.height || 50;\r\n      \r\n      minX = Math.min(minX, node.position.x);\r\n      minY = Math.min(minY, node.position.y);\r\n      maxX = Math.max(maxX, node.position.x + width);\r\n      maxY = Math.max(maxY, node.position.y + height);\r\n    });\r\n\r\n    const bounds = {\r\n      x: minX,\r\n      y: minY,\r\n      width: maxX - minX,\r\n      height: maxY - minY\r\n    };\r\n\r\n    const containerWidth = this.container.clientWidth;\r\n    const containerHeight = this.container.clientHeight;\r\n    \r\n    const padding = 50;\r\n    const zoomX = (containerWidth - padding * 2) / bounds.width;\r\n    const zoomY = (containerHeight - padding * 2) / bounds.height;\r\n    const zoom = Math.min(zoomX, zoomY, this.options.maxZoom || 2);\r\n\r\n    const x = (containerWidth - bounds.width * zoom) / 2 - bounds.x * zoom;\r\n    const y = (containerHeight - bounds.height * zoom) / 2 - bounds.y * zoom;\r\n\r\n    this.setViewport({ x, y, zoom });\r\n  }\r\n\r\n  private updateLookups() {\r\n    // Update node lookup\r\n    this.state.nodeLookup.clear();\r\n    this.state.nodes.forEach(node => {\r\n      const internalNode: InternalNode = {\r\n        ...node,\r\n        measured: node.measured || { width: node.width, height: node.height },\r\n        internals: {\r\n          positionAbsolute: node.position,\r\n          z: node.zIndex || 0,\r\n          userNode: node\r\n        }\r\n      };\r\n      this.state.nodeLookup.set(node.id, internalNode);\r\n    });\r\n\r\n    // Update edge lookup\r\n    this.state.edgeLookup.clear();\r\n    this.state.edges.forEach(edge => {\r\n      this.state.edgeLookup.set(edge.id, edge);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check if a node is fully rendered\r\n   */\r\n  private isNodeRendered(nodeId: string): boolean {\r\n    if (!this.container) return false;\r\n    const nodeEl = this.container.querySelector(`[id=\"${CSS.escape(nodeId)}\"]`) as HTMLElement | null;\r\n    if (!nodeEl) return false;\r\n    \r\n    const rect = nodeEl.getBoundingClientRect();\r\n    return rect.width > 0 && rect.height > 0;\r\n  }\r\n\r\n  /**\r\n   * Check if any of the required nodes are still pending\r\n   */\r\n  private hasPendingNodes(nodeIds: string[]): boolean {\r\n    return nodeIds.some(id => this.pendingNodes.includes(id) || !this.isNodeRendered(id));\r\n  }\r\n\r\n  /**\r\n   * Remove node from pending list when it's rendered\r\n   */\r\n  private markNodeAsRendered(nodeId: string) {\r\n    const index = this.pendingNodes.indexOf(nodeId);\r\n    if (index > -1) {\r\n      this.pendingNodes.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retry edge rendering with delay if nodes are still pending\r\n   */\r\n  private retryEdgeRendering(edges: Edge[], retryCount: number = 0, maxRetries: number = 10) {\r\n    const allNodeIds = edges.flatMap(edge => [edge.source, edge.target]);\r\n    const uniqueNodeIds = [...new Set(allNodeIds)];\r\n    \r\n    if (this.hasPendingNodes(uniqueNodeIds) && retryCount < maxRetries) {\r\n      setTimeout(() => {\r\n        this.retryEdgeRendering(edges, retryCount + 1, maxRetries);\r\n      }, 100);\r\n    } else {\r\n      // All nodes are rendered, proceed with edge rendering\r\n      this.state.edges = edges;\r\n      this.updateLookups();\r\n      this.notifySubscribers();\r\n      \r\n      // Mark nodes as rendered\r\n      uniqueNodeIds.forEach(id => this.markNodeAsRendered(id));\r\n    }\r\n  }\r\n\r\n  private notifySubscribers() {\r\n    this.subscribers.forEach(callback => callback(this.state));\r\n  }\r\n}\r\n\r\n","/**\r\n * Store utilities for managing flow state\r\n * Placeholder for future state management integration with @xyflow/system\r\n */\r\n\r\nimport type { FlowState, InternalNode, Node, Edge } from './types';\r\n\r\nexport function createStore(initialState: Partial<FlowState> = {}) {\r\n  const state: FlowState = {\r\n    nodes: initialState.nodes || [],\r\n    edges: initialState.edges || [],\r\n    viewport: initialState.viewport || { x: 0, y: 0, zoom: 1 },\r\n    nodeLookup: new Map(),\r\n    edgeLookup: new Map()\r\n  };\r\n\r\n  const listeners = new Set<(state: FlowState) => void>();\r\n\r\n  const updateLookups = () => {\r\n    state.nodeLookup.clear();\r\n    state.nodes.forEach((node: Node) => {\r\n      const internalNode: InternalNode = {\r\n        ...node,\r\n        measured: node.measured || { width: node.width, height: node.height },\r\n        internals: {\r\n          positionAbsolute: node.position,\r\n          z: node.zIndex || 0,\r\n          userNode: node\r\n        }\r\n      };\r\n      state.nodeLookup.set(node.id, internalNode);\r\n    });\r\n\r\n    state.edgeLookup.clear();\r\n    state.edges.forEach((edge: Edge) => {\r\n      state.edgeLookup.set(edge.id, edge);\r\n    });\r\n  };\r\n\r\n  // initialize lookups based on provided initial state\r\n  updateLookups();\r\n\r\n  return {\r\n    getState: () => state,\r\n    setState: (updates: Partial<FlowState>) => {\r\n      Object.assign(state, updates);\r\n      updateLookups();\r\n      listeners.forEach(listener => listener(state));\r\n    },\r\n    subscribe: (listener: (state: FlowState) => void) => {\r\n      listeners.add(listener);\r\n      return () => listeners.delete(listener);\r\n    }\r\n  };\r\n}\r\n\r\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1]),t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e;const r=h.fromAttribute(s,t.type);this[e]=r??this._$Ej?.get(e)??r,this._$Em=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.1\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,e=\"$lit$\",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=\"?\"+h,n=`<${o}>`,r=document,l=()=>r.createComment(\"\"),c=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a=Array.isArray,u=t=>a(t)||\"function\"==typeof t?.[Symbol.iterator],d=\"[ \\t\\n\\f\\r]\",f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\\\s\"'>=/]+)(${d}*=${d}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),p=/'/g,g=/\"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==s?s.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?\"!--\"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp(\"</\"+u[2],\"g\")),c=m):void 0!==u[3]&&(c=m):c===m?\">\"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'\"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x)}return[P(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:\".\"===e[1]?H:\"?\"===e[1]?I:\"@\"===e[1]?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:\"\";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(8===r.nodeType)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){const s=r.createElement(\"template\");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(\"3.3.1\");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h};export{Z as _$LH,x as html,w as mathml,T as noChange,E as nothing,B as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.1\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","import{html as t,svg as r,mathml as e}from\"./lit-html.js\";\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst a=Symbol.for(\"\"),o=t=>{if(t?.r===a)return t?._$litStatic$},s=t=>({_$litStatic$:t,r:a}),i=(t,...r)=>({_$litStatic$:r.reduce(((r,e,a)=>r+(t=>{if(void 0!==t._$litStatic$)return t._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${t}. Use 'unsafeStatic' to pass non-literal values, but\\n            take care to ensure page security.`)})(e)+t[a+1]),t[0]),r:a}),l=new Map,n=t=>(r,...e)=>{const a=e.length;let s,i;const n=[],u=[];let c,$=0,f=!1;for(;$<a;){for(c=r[$];$<a&&void 0!==(i=e[$],s=o(i));)c+=s+r[++$],f=!0;$!==a&&u.push(i),n.push(c),$++}if($===a&&n.push(r[a]),f){const t=n.join(\"$$lit$$\");void 0===(r=l.get(t))&&(n.raw=n,l.set(t,r=n)),e=u}return t(r,...e)},u=n(t),c=n(r),$=n(e);export{u as html,i as literal,$ as mathml,c as svg,s as unsafeStatic,n as withStatic};\n//# sourceMappingURL=static.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=t=>(e,o)=>{void 0!==o?o.addInitializer((()=>{customElements.define(t,e)})):customElements.define(t,e)};export{t as customElement};\n//# sourceMappingURL=custom-element.js.map\n","import{defaultConverter as t,notEqual as e}from\"../reactive-element.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const o={attribute:!0,type:String,converter:t,reflect:!1,hasChanged:e},r=(t=o,e,r)=>{const{kind:n,metadata:i}=r;let s=globalThis.litPropertyMetadata.get(i);if(void 0===s&&globalThis.litPropertyMetadata.set(i,s=new Map),\"setter\"===n&&((t=Object.create(t)).wrapped=!0),s.set(r.name,t),\"accessor\"===n){const{name:o}=r;return{set(r){const n=e.get.call(this);e.set.call(this,r),this.requestUpdate(o,n,t)},init(e){return void 0!==e&&this.C(o,void 0,t,e),e}}}if(\"setter\"===n){const{name:o}=r;return function(r){const n=this[o];e.call(this,r),this.requestUpdate(o,n,t)}}throw Error(\"Unsupported decorator location: \"+n)};function n(t){return(e,o)=>\"object\"==typeof o?r(t,e,o):((t,e,o)=>{const r=e.hasOwnProperty(o);return e.constructor.createProperty(o,t),r?Object.getOwnPropertyDescriptor(e,o):void 0})(t,e,o)}export{n as property,r as standardProperty};\n//# sourceMappingURL=property.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=t=>(...e)=>({_$litDirective$:t,values:e});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}export{i as Directive,t as PartType,e as directive};\n//# sourceMappingURL=directive.js.map\n","import{noChange as t}from\"../lit-html.js\";import{directive as e,Directive as r,PartType as s}from\"../directive.js\";\n/**\n * @license\n * Copyright 2018 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const n=\"important\",i=\" !\"+n,o=e(class extends r{constructor(t){if(super(t),t.type!==s.ATTRIBUTE||\"style\"!==t.name||t.strings?.length>2)throw Error(\"The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.\")}render(t){return Object.keys(t).reduce(((e,r)=>{const s=t[r];return null==s?e:e+`${r=r.includes(\"-\")?r:r.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,\"-$&\").toLowerCase()}:${s};`}),\"\")}update(e,[r]){const{style:s}=e.element;if(void 0===this.ft)return this.ft=new Set(Object.keys(r)),this.render(r);for(const t of this.ft)null==r[t]&&(this.ft.delete(t),t.includes(\"-\")?s.removeProperty(t):s[t]=null);for(const t in r){const e=r[t];if(null!=e){this.ft.add(t);const r=\"string\"==typeof e&&e.endsWith(i);t.includes(\"-\")||r?s.setProperty(t,r?e.slice(0,-11):e,r?n:\"\"):s[t]=e}}return t}});export{o as styleMap};\n//# sourceMappingURL=style-map.js.map\n","/**\r\n * Geometry utilities for calculating positions, paths, and intersections\r\n * Wraps @xyflow/system utilities for Lit integration\r\n */\r\n\r\nimport { \r\n  getBezierPath as getSystemBezierPath,\r\n  getSmoothStepPath as getSystemSmoothStepPath,\r\n  getStraightPath as getSystemStraightPath,\r\n  Position\r\n} from '@xyflow/system';\r\nimport type { XYPosition } from '../core/types';\r\n\r\n/**\r\n * Calculate distance between two points\r\n */\r\nexport function getDistance(a: XYPosition, b: XYPosition): number {\r\n  return Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\r\n}\r\n\r\n/**\r\n * Calculate the center point between two positions\r\n */\r\nexport function getCenter(a: XYPosition, b: XYPosition): XYPosition {\r\n  return {\r\n    x: (a.x + b.x) / 2,\r\n    y: (a.y + b.y) / 2,\r\n  };\r\n}\r\n\r\n/**\r\n * Generate a bezier curve path between two points\r\n * Uses @xyflow/system's getBezierPath utility\r\n */\r\nexport function getBezierPath(params: {\r\n  sourceX: number;\r\n  sourceY: number;\r\n  sourcePosition?: Position;\r\n  targetX: number;\r\n  targetY: number;\r\n  targetPosition?: Position;\r\n  curvature?: number;\r\n}): [path: string, labelX: number, labelY: number, offsetX: number, offsetY: number] {\r\n  return getSystemBezierPath(params);\r\n}\r\n\r\n/**\r\n * Generate a smooth step path between two points\r\n * Uses @xyflow/system's getSmoothStepPath utility\r\n */\r\nexport function getSmoothStepPath(params: {\r\n  sourceX: number;\r\n  sourceY: number;\r\n  sourcePosition?: Position;\r\n  targetX: number;\r\n  targetY: number;\r\n  targetPosition?: Position;\r\n  borderRadius?: number;\r\n  offset?: number;\r\n}): [path: string, labelX: number, labelY: number, offsetX: number, offsetY: number] {\r\n  return getSystemSmoothStepPath(params);\r\n}\r\n\r\n/**\r\n * Generate a straight line path\r\n * Uses @xyflow/system's getStraightPath utility\r\n */\r\nexport function getStraightPath(params: {\r\n  sourceX: number;\r\n  sourceY: number;\r\n  targetX: number;\r\n  targetY: number;\r\n}): [path: string, labelX: number, labelY: number, offsetX: number, offsetY: number] {\r\n  return getSystemStraightPath(params);\r\n}\r\n\r\n/**\r\n * Check if a point is inside a rectangle\r\n */\r\nexport function isPointInRect(\r\n  point: XYPosition,\r\n  rect: { x: number; y: number; width: number; height: number }\r\n): boolean {\r\n  return (\r\n    point.x >= rect.x &&\r\n    point.x <= rect.x + rect.width &&\r\n    point.y >= rect.y &&\r\n    point.y <= rect.y + rect.height\r\n  );\r\n}\r\n\r\n// Re-export Position enum from @xyflow/system\r\nexport { Position };\r\n\r\n","/**\n * FlowCanvas - Main container component for the flow diagram\n * This is the root element that manages the viewport and renders nodes/edges\n */\n\nimport { LitElement, css } from 'lit';\nimport { html, svg, unsafeStatic } from 'lit/static-html.js';\nimport { customElement, property } from 'lit/decorators.js';\nimport { styleMap } from 'lit/directives/style-map.js';\nimport { FlowInstance } from '../core/flow-instance';\nimport type { Node, Edge, Viewport } from '../core/types';\nimport { getBezierPath, Position } from '../utils/geometry';\n\n@customElement('flow-canvas')\nexport class FlowCanvas extends LitElement {\n  protected createRenderRoot() {\n    return super.createRenderRoot();\n  }\n  static styles = css`\n    :host {\n      display: block;\n      width: 100%;\n      height: 100%;\n      position: relative;\n      overflow: hidden;\n      background: var(--flow-background-color, #fafafa);\n    }\n\n    .flow-container {\n      width: 100%;\n      height: 100%;\n      position: relative;\n      cursor: grab;\n    }\n\n    .flow-container.panning {\n      cursor: grabbing;\n    }\n\n    .flow-viewport {\n      width: 100%;\n      height: 100%;\n      position: relative;\n      transform-origin: 0 0;\n      will-change: transform;\n    }\n\n    .flow-nodes-layer {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n    }\n\n    .flow-edges-layer {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n       pointer-events: none;\n    }\n\n    .flow-labels-overlay {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n    }\n\n    .edge-label {\n      position: absolute;\n      transform: translate(-50%, -50%);\n      background: white;\n      border: 1px solid rgba(0, 0, 0, 0.1);\n      border-radius: 4px;\n      padding: 2px 6px;\n      font-size: 12px;\n      color: #333;\n      pointer-events: all;\n      white-space: nowrap;\n      user-select: none;\n    }\n  `;\n\n  @property({ type: Array }) nodes: Node[] = [];\n  @property({ type: Array }) edges: Edge[] = [];\n  @property({ type: Object }) viewport: Viewport = { x: 0, y: 0, zoom: 1 };\n  \n  // Node type registry (maps type name to tag name)\n  @property({ type: Object }) nodeTypes: Record<string, string> = {\n    'default': 'flow-node',\n    'shape': 'shape-node',\n    'erd-table': 'erd-table-node'\n  };\n\n  private connection: { \n    from?: { nodeId: string; handleId?: string }; \n    to?: { nodeId: string; handleId?: string }; \n    preview?: { x: number; y: number } \n  } | null = null;\n\n\n\n  private getNodeGeom(nodeId: string): { left: { x: number; y: number }; right: { x: number; y: number } } | null {\n    const el = this.renderRoot.querySelector(`flow-node[id=\"${CSS.escape(nodeId)}\"]`) as HTMLElement | null;\n    const viewportEl = this.renderRoot.querySelector('.flow-viewport') as HTMLElement | null;\n    if (!el || !viewportEl) return null;\n    const rect = el.getBoundingClientRect();\n    const vpRect = viewportEl.getBoundingClientRect();\n    const z = this.viewport.zoom || 1;\n    const x = (rect.left - vpRect.left - this.viewport.x) / z;\n    const y = (rect.top - vpRect.top - this.viewport.y) / z;\n    const w = rect.width / z;\n    const h = rect.height / z;\n    const cy = y + h / 2;\n    return { left: { x: x, y: cy }, right: { x: x + w, y: cy } };\n  }\n\n  /**\n   * Get handle position in canvas coordinates\n   */\n  private getHandleCanvasPosition(nodeId: string, handleId: string): { x: number; y: number } | null {\n    const nodeEl = this.renderRoot.querySelector(`[id=\"${CSS.escape(nodeId)}\"]`) as HTMLElement | null;\n    if (!nodeEl) return null;\n\n    // Find handle element in shadow root or light DOM\n    let handleEl: HTMLElement | null = null;\n    const shadowRoot = nodeEl.shadowRoot;\n    if (shadowRoot) {\n      handleEl = shadowRoot.querySelector(`[data-handle-id=\"${CSS.escape(handleId)}\"]`) as HTMLElement;\n    }\n    if (!handleEl) {\n      handleEl = nodeEl.querySelector(`[data-handle-id=\"${CSS.escape(handleId)}\"]`) as HTMLElement;\n    }\n    if (!handleEl) return null;\n\n    // Get node data\n    const node = this.nodes.find(n => n.id === nodeId);\n    if (!node) return null;\n\n    // For shape nodes, calculate handle position based on shape size and handle type\n    if (node.type === 'shape') {\n      console.log('getHandleCanvasPosition for shape node:', { nodeId, handleId, node });\n      return this.getShapeHandlePosition(node, handleId);\n    }\n\n    // For regular nodes, use the existing method\n    const nodeRect = nodeEl.getBoundingClientRect();\n    const handleRect = handleEl.getBoundingClientRect();\n    const zoom = this.viewport.zoom || 1;\n    \n    const offsetX = (handleRect.left + handleRect.width / 2 - nodeRect.left) / zoom;\n    const offsetY = (handleRect.top + handleRect.height / 2 - nodeRect.top) / zoom;\n    \n    return {\n      x: node.position.x + offsetX,\n      y: node.position.y + offsetY\n    };\n  }\n\n  /**\n   * Get handle position for shape nodes based on shape size and handle type\n   */\n  private getShapeHandlePosition(node: any, handleId: string): { x: number; y: number } | null {\n    const shapeData = node.data;\n    if (!shapeData) return null;\n\n    const size = shapeData.size || { width: 200, height: 200 };\n    const width = size.width;\n    const height = size.height;\n\n    // Parse handle ID to determine position\n    // Handle IDs are like: \"shape-1-source-right\", \"shape-1-target-left\", etc.\n    const parts = handleId.split('-');\n    const handleType = parts[parts.length - 1]; // Get last part (right, left, top, bottom)\n    \n    console.log('getShapeHandlePosition:', { handleId, parts, handleType, node: node.id, size });\n    \n    let offsetX = 0;\n    let offsetY = 0;\n\n    switch (handleType) {\n      case 'right':\n        offsetX = width;\n        offsetY = height / 2;\n        break;\n      case 'left':\n        offsetX = 0;\n        offsetY = height / 2;\n        break;\n      case 'top':\n        offsetX = width / 2;\n        offsetY = 0;\n        break;\n      case 'bottom':\n        offsetX = width / 2;\n        offsetY = height;\n        break;\n      default:\n        // Fallback to center\n        offsetX = width / 2;\n        offsetY = height / 2;\n    }\n\n    const result = {\n      x: node.position.x + offsetX,\n      y: node.position.y + offsetY\n    };\n    \n    console.log('getShapeHandlePosition result:', { \n      nodeId: node.id, \n      position: node.position, \n      offsetX, \n      offsetY, \n      result \n    });\n    \n    return result;\n  }\n\n  setNodes(nodes: Node[]) {\n    this.instance.setNodes(nodes);\n  }\n\n  setEdges(edges: Edge[]) {\n    this.instance.setEdges(edges);\n  }\n\n  /**\n   * Determine the best target handle for a shape node based on connection direction\n   */\n  private determineBestTargetHandle(sourceNodeId: string, targetNodeId: string): string {\n    const sourceNode = this.nodes.find(n => n.id === sourceNodeId);\n    const targetNode = this.nodes.find(n => n.id === targetNodeId);\n    \n    if (!sourceNode || !targetNode) return `${targetNodeId}-target-left`;\n    \n    // Calculate relative positions\n    const sourceX = sourceNode.position.x;\n    const sourceY = sourceNode.position.y;\n    const targetX = targetNode.position.x;\n    const targetY = targetNode.position.y;\n    \n    // Get target node dimensions\n    const targetData = targetNode.data as any;\n    const targetWidth = targetData?.size?.width || 200;\n    const targetHeight = targetData?.size?.height || 200;\n    \n    // Calculate center positions\n    const sourceCenterX = sourceX + (sourceNode.width || 150) / 2;\n    const sourceCenterY = sourceY + (sourceNode.height || 50) / 2;\n    const targetCenterX = targetX + targetWidth / 2;\n    const targetCenterY = targetY + targetHeight / 2;\n    \n    // Determine connection direction\n    const deltaX = targetCenterX - sourceCenterX;\n    const deltaY = targetCenterY - sourceCenterY;\n    \n    // Choose target handle based on direction\n    if (Math.abs(deltaX) > Math.abs(deltaY)) {\n      // Horizontal connection\n      return deltaX > 0 ? `${targetNodeId}-target-left` : `${targetNodeId}-target-right`;\n    } else {\n      // Vertical connection\n      return deltaY > 0 ? `${targetNodeId}-target-top` : `${targetNodeId}-target-bottom`;\n    }\n  }\n\n  private computeLabelCanvasPosition(edge: Edge): { x: number; y: number } | null {\n    const sourceNode = this.nodes.find(n => n.id === edge.source);\n    const targetNode = this.nodes.find(n => n.id === edge.target);\n    if (!sourceNode || !targetNode) return null;\n    \n    // Try to use specific handle positions if available\n    let sourceX: number, sourceY: number;\n    let targetX: number, targetY: number;\n\n    if (edge.sourceHandle) {\n      const handlePos = this.getHandleCanvasPosition(edge.source, edge.sourceHandle);\n      if (handlePos) {\n        sourceX = handlePos.x;\n        sourceY = handlePos.y;\n      } else {\n        // Fallback to node edge\n        const sourceWidth = sourceNode.measured?.width || sourceNode.width || 150;\n        const sourceHeight = sourceNode.measured?.height || sourceNode.height || 50;\n        sourceX = sourceNode.position.x + sourceWidth;\n        sourceY = sourceNode.position.y + sourceHeight / 2;\n      }\n    } else {\n      const sourceWidth = sourceNode.measured?.width || sourceNode.width || 150;\n      const sourceHeight = sourceNode.measured?.height || sourceNode.height || 50;\n      sourceX = sourceNode.position.x + sourceWidth;\n      sourceY = sourceNode.position.y + sourceHeight / 2;\n    }\n\n    if (edge.targetHandle) {\n      const handlePos = this.getHandleCanvasPosition(edge.target, edge.targetHandle);\n      if (handlePos) {\n        targetX = handlePos.x;\n        targetY = handlePos.y;\n      } else {\n        // Fallback to node edge\n        targetX = targetNode.position.x;\n        const targetHeight = targetNode.measured?.height || targetNode.height || 50;\n        targetY = targetNode.position.y + targetHeight / 2;\n      }\n    } else {\n      targetX = targetNode.position.x;\n      const targetHeight = targetNode.measured?.height || targetNode.height || 50;\n      targetY = targetNode.position.y + targetHeight / 2;\n    }\n    \n    const [, labelX, labelY] = getBezierPath({\n      sourceX,\n      sourceY,\n      sourcePosition: Position.Right,\n      targetX,\n      targetY,\n      targetPosition: Position.Left,\n    });\n    \n    return { x: labelX, y: labelY };\n  }\n\n  private computeStartLabelCanvasPosition(edge: Edge): { x: number; y: number } | null {\n    const sourceNode = this.nodes.find(n => n.id === edge.source);\n    if (!sourceNode) return null;\n    \n    let sourceX: number, sourceY: number;\n\n    if (edge.sourceHandle) {\n      const handlePos = this.getHandleCanvasPosition(edge.source, edge.sourceHandle);\n      if (handlePos) {\n        sourceX = handlePos.x;\n        sourceY = handlePos.y;\n      } else {\n        const sourceWidth = sourceNode.measured?.width || sourceNode.width || 150;\n        const sourceHeight = sourceNode.measured?.height || sourceNode.height || 50;\n        sourceX = sourceNode.position.x + sourceWidth;\n        sourceY = sourceNode.position.y + sourceHeight / 2;\n      }\n    } else {\n      const sourceWidth = sourceNode.measured?.width || sourceNode.width || 150;\n      const sourceHeight = sourceNode.measured?.height || sourceNode.height || 50;\n      sourceX = sourceNode.position.x + sourceWidth;\n      sourceY = sourceNode.position.y + sourceHeight / 2;\n    }\n    \n    return { x: sourceX + 12, y: sourceY - 10 };\n  }\n\n  private computeEndLabelCanvasPosition(edge: Edge): { x: number; y: number } | null {\n    const targetNode = this.nodes.find(n => n.id === edge.target);\n    if (!targetNode) return null;\n    \n    let targetX: number, targetY: number;\n\n    if (edge.targetHandle) {\n      const handlePos = this.getHandleCanvasPosition(edge.target, edge.targetHandle);\n      if (handlePos) {\n        targetX = handlePos.x;\n        targetY = handlePos.y;\n      } else {\n        const targetHeight = targetNode.measured?.height || targetNode.height || 50;\n        targetX = targetNode.position.x;\n        targetY = targetNode.position.y + targetHeight / 2;\n      }\n    } else {\n      const targetHeight = targetNode.measured?.height || targetNode.height || 50;\n      targetX = targetNode.position.x;\n      targetY = targetNode.position.y + targetHeight / 2;\n    }\n    \n    return { x: targetX - 12, y: targetY - 10 };\n  }\n\n  instance: FlowInstance;\n  private unsubscribe?: () => void;\n\n  constructor() {\n    super();\n    this.instance = new FlowInstance({ nodes: this.nodes, edges: this.edges });\n  }\n\n  firstUpdated() {\n    const container = this.renderRoot.querySelector('.flow-container') as HTMLElement;\n    if (container) {\n      this.instance.mount(container);\n      this.unsubscribe = this.instance.subscribe((state) => {\n        this.nodes = state.nodes;\n        this.edges = state.edges;\n        this.viewport = state.viewport;\n        this.requestUpdate();\n      });\n      container.addEventListener('mousemove', this.onMouseMove);\n      window.addEventListener('mouseup', this.onMouseUp);\n      \n      // Add selection event listeners\n      container.addEventListener('node-select', this.onNodeSelect as EventListener);\n      // Edge events come from light DOM, so listen on document\n      document.addEventListener('edge-select', this.onEdgeSelect as EventListener);\n    }\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.unsubscribe?.();\n    this.instance.destroy();\n    const container = this.renderRoot.querySelector('.flow-container') as HTMLElement | null;\n    container?.removeEventListener('mousemove', this.onMouseMove);\n    window.removeEventListener('mouseup', this.onMouseUp);\n    container?.removeEventListener('node-select', this.onNodeSelect as EventListener);\n    document.removeEventListener('edge-select', this.onEdgeSelect as EventListener);\n  }\n\n  /**\n   * Renders a node with dynamic tag name based on node type\n   * Falls back to 'flow-node' if type is not registered\n   */\n  private renderNode(node: Node) {\n    // Get the tag name for this node type, or use default 'flow-node'\n    const nodeType = node.type || 'default';\n    const tagName = this.nodeTypes[nodeType] || 'flow-node';\n    \n    // Use lit-html's unsafeStatic to render dynamic tag names\n    const tag = unsafeStatic(tagName);\n    \n    return html`\n      <${tag}\n        .id=${node.id}\n        .data=${node.data}\n        .position=${node.position}\n        .selected=${node.selected || false}\n        .draggable=${node.draggable !== false}\n        .connectable=${node.connectable !== false}\n        .resizable=${node.resizable || false}\n        .drag_handle_selector=${(node as any).drag_handle_selector || null}\n        .instance=${this.instance}\n        @handle-start=${this.onHandleStart}\n      ></${tag}>\n    `;\n  }\n\n  render() {\n    const transform = `translate(${this.viewport.x}px, ${this.viewport.y}px) scale(${this.viewport.zoom})`;\n    \n    return html`\n      <div class=\"flow-container\">\n        <slot name=\"background\"></slot>\n        <div \n          class=\"flow-viewport\" \n          style=${styleMap({ transform })}\n        >\n          <div class=\"flow-edges-layer\">\n            ${this.edges.map(edge => {\n              const sourceNode = this.nodes.find(n => n.id === edge.source);\n              const targetNode = this.nodes.find(n => n.id === edge.target);\n              \n              if (!sourceNode || !targetNode) return null;\n              \n              return html`\n                <flow-edge \n                  .id=${edge.id}\n                  .source=${edge.source}\n                  .target=${edge.target}\n                  .sourceHandle=${edge.sourceHandle}\n                  .targetHandle=${edge.targetHandle}\n                  .sourceNode=${sourceNode}\n                  .targetNode=${targetNode}\n                  .animated=${edge.animated || false}\n                  .label=${(edge as any).label || ''}\n                  .type=${edge.type || 'default'}\n                  .markerStart=${edge.markerStart}\n                  .markerEnd=${edge.markerEnd}\n                ></flow-edge>\n              `;\n            })}\n            ${this.renderPreviewEdge()}\n          </div>\n          <div class=\"flow-nodes-layer\">\n            ${this.nodes.map(node => this.renderNode(node))}\n          </div>\n          <div class=\"flow-labels-overlay\">\n            ${this.edges.map(edge => {\n              const labelHtml = (edge.data && (edge.data as any).labelHtml) as string | undefined;\n              const labelText = (edge.data && (edge.data as any).label) as string | undefined;\n              const hasCenter = !!labelHtml || !!labelText;\n              if (!hasCenter) return null;\n              const pos = this.computeLabelCanvasPosition(edge);\n              if (!pos) return null;\n              const style = `transform: translate(-50%, -50%) translate(${pos.x}px, ${pos.y}px);`;\n              return labelHtml\n                ? html`<div class=\"edge-label\" style=\"${style}\" .innerHTML=${labelHtml}></div>`\n                : html`<div class=\"edge-label\" style=\"${style}\">${labelText}</div>`;\n            })}\n            ${this.edges.map(edge => {\n              const startHtml = (edge.data && (edge.data as any).startLabelHtml) as string | undefined;\n              const startText = (edge.data && (edge.data as any).startLabel) as string | undefined;\n              if (!startHtml && !startText) return null;\n              const pos = this.computeStartLabelCanvasPosition(edge);\n              if (!pos) return null;\n              const style = `transform: translate(-50%, -50%) translate(${pos.x}px, ${pos.y}px);`;\n              return startHtml\n                ? html`<div class=\"edge-label\" style=\"${style}\" .innerHTML=${startHtml}></div>`\n                : html`<div class=\"edge-label\" style=\"${style}\">${startText}</div>`;\n            })}\n            ${this.edges.map(edge => {\n              const endHtml = (edge.data && (edge.data as any).endLabelHtml) as string | undefined;\n              const endText = (edge.data && (edge.data as any).endLabel) as string | undefined;\n              if (!endHtml && !endText) return null;\n              const pos = this.computeEndLabelCanvasPosition(edge);\n              if (!pos) return null;\n              const style = `transform: translate(-50%, -50%) translate(${pos.x}px, ${pos.y}px);`;\n              return endHtml\n                ? html`<div class=\"edge-label\" style=\"${style}\" .innerHTML=${endHtml}></div>`\n                : html`<div class=\"edge-label\" style=\"${style}\">${endText}</div>`;\n            })}\n          </div>\n        </div>\n        <slot></slot>\n      </div>\n    `;\n  }\n\n  private screenToCanvas(x: number, y: number) {\n    const container = this.renderRoot.querySelector('.flow-container') as HTMLElement | null;\n    if (!container) return { x, y };\n    const rect = container.getBoundingClientRect();\n    const vx = this.viewport.x;\n    const vy = this.viewport.y;\n    const z = this.viewport.zoom || 1;\n    return { x: (x - rect.left - vx) / z, y: (y - rect.top - vy) / z };\n  }\n\n  private onHandleStart = (e: CustomEvent<{ nodeId: string; type: 'source' | 'target'; handleId?: string }>) => {\n    const { nodeId, type, handleId } = e.detail;\n    // Always start a connection FROM this handle, regardless of its type\n    // The handle type will be determined by the connection direction\n    this.connection = { from: { nodeId, handleId } };\n  };\n\n  private onMouseMove = (e: MouseEvent) => {\n    if (!this.connection) return;\n    const p = this.screenToCanvas(e.clientX, e.clientY);\n    this.connection.preview = p;\n    this.requestUpdate();\n  };\n\n  private onMouseUp = (e: MouseEvent) => {\n    if (!this.connection) return;\n\n    const path = e.composedPath() as EventTarget[];\n    let targetEl: HTMLElement | null = null;\n    let targetHandleId: string | undefined;\n    \n    // Find target node element (can be flow-node or any custom node type)\n    for (const t of path) {\n      if (t instanceof HTMLElement) {\n        const tagName = t.tagName.toLowerCase();\n        // Check if it's a node element (flow-node or any registered custom node type)\n        if (tagName === 'flow-node' || Object.values(this.nodeTypes).some(tag => tag === tagName)) {\n          targetEl = t;\n          break;\n        }\n        // Check if it's a handle element\n        if (t.dataset.handleId) {\n          targetHandleId = t.dataset.handleId;\n        }\n      }\n    }\n    const targetId = targetEl?.getAttribute('id') || undefined;\n\n    // Handle connection completion - always from a source handle to a target handle\n    if (this.connection.from && targetId && targetId !== this.connection.from.nodeId) {\n      const newEdgeId = `e-${this.connection.from.nodeId}-${targetId}-${Date.now()}`;\n      const sourceNodeId = this.connection.from.nodeId;\n      const sourceHandleId = this.connection.from.handleId;\n      \n      // If no target handle was found, determine the best target handle for shape nodes\n      let finalTargetHandleId = targetHandleId;\n      if (!finalTargetHandleId) {\n        const targetNode = this.nodes.find(n => n.id === targetId);\n        if (targetNode && targetNode.type === 'shape') {\n          finalTargetHandleId = this.determineBestTargetHandle(sourceNodeId, targetId);\n          console.log('Auto-determined target handle:', { sourceNodeId, targetId, finalTargetHandleId });\n        }\n      }\n      \n      // Use the instance method which handles retry logic automatically\n      this.instance.addEdge({ \n        id: newEdgeId, \n        source: sourceNodeId, \n        target: targetId, \n        sourceHandle: sourceHandleId,\n        targetHandle: finalTargetHandleId,\n        data: {} \n      });\n    }\n\n    this.connection = null;\n    this.requestUpdate();\n  };\n\n  private onNodeSelect = (e: CustomEvent<{ nodeId: string; selected: boolean; node: any }>) => {\n    const { nodeId, selected, node } = e.detail;\n    \n    // Update the node selection state in the instance\n    this.instance.updateNode(nodeId, { selected });\n    \n    // Dispatch a higher-level selection event from flow-canvas\n    this.dispatchEvent(new CustomEvent('node-selected', {\n      detail: {\n        nodeId,\n        selected,\n        node,\n        allSelectedNodes: this.nodes.filter(n => n.selected)\n      },\n      bubbles: true,\n      composed: true\n    }));\n  };\n\n  private onEdgeSelect = (e: CustomEvent<{ edgeId: string; selected: boolean; edge: any }>) => {\n    const { edgeId, selected, edge } = e.detail;\n    \n    // Update the edge selection state in the instance\n    this.instance.updateEdge(edgeId, { selected });\n    \n    // Dispatch a higher-level selection event from flow-canvas\n    this.dispatchEvent(new CustomEvent('edge-selected', {\n      detail: {\n        edgeId,\n        selected,\n        edge,\n        allSelectedEdges: this.edges.filter(e => e.selected)\n      },\n      bubbles: true,\n      composed: true\n    }));\n  };\n\n  private renderPreviewEdge() {\n    if (!this.connection || !this.connection.preview) return null;\n\n    const preview = this.connection.preview;\n    const nodeFrom = this.connection.from ? this.nodes.find(n => n.id === this.connection!.from!.nodeId) : null;\n    const nodeTo = this.connection.to ? this.nodes.find(n => n.id === this.connection!.to!.nodeId) : null;\n\n    if (nodeFrom) {\n      return html`\n        <flow-edge\n          .id=${'preview'}\n          .source=${nodeFrom.id}\n          .target=${'__preview__'}\n          .sourceHandle=${this.connection.from?.handleId}\n          .sourceNode=${{ ...nodeFrom, position: nodeFrom.position } as any}\n          .targetNode=${{ id: '__preview__', position: { x: preview.x, y: preview.y }, width: 1, height: 1, data: {} } as any}\n          .animated=${true}\n          .label=${''}\n        ></flow-edge>\n      `;\n    }\n\n    if (nodeTo) {\n      return html`\n        <flow-edge\n          .id=${'preview'}\n          .source=${'__preview__'}\n          .target=${nodeTo.id}\n          .sourceNode=${{ id: '__preview__', position: { x: preview.x, y: preview.y }, width: 1, height: 1, data: {} } as any}\n          .targetHandle=${this.connection.to?.handleId}\n          .targetNode=${{ ...nodeTo, position: nodeTo.position } as any}\n          .animated=${true}\n          .label=${''}\n        ></flow-edge>\n      `;\n    }\n\n    return null;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'flow-canvas': FlowCanvas;\n  }\n}\n\n","/**\r\n * NodeResizer - A modular resize component that can be added to any node\r\n * Inspired by React Flow's NodeResizer component\r\n */\r\n\r\nimport { LitElement, html, css } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\n\r\n@customElement('node-resizer')\r\nexport class NodeResizer extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      pointer-events: none;\r\n      z-index: 10;\r\n    }\r\n\r\n    .resize-handle {\r\n      position: absolute;\r\n      background: var(--flow-node-selected-color, #1a73e8);\r\n      border: 2px solid #fff;\r\n      border-radius: 2px;\r\n      opacity: 0;\r\n      transition: opacity 0.2s ease;\r\n      pointer-events: auto;\r\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\r\n    }\r\n\r\n    .resize-handle:hover {\r\n      opacity: 1;\r\n    }\r\n\r\n    :host([visible]) .resize-handle {\r\n      opacity: 1;\r\n    }\r\n\r\n    .resize-handle.nw {\r\n      top: -8px;\r\n      left: -8px;\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: nw-resize;\r\n    }\r\n\r\n    .resize-handle.ne {\r\n      top: -8px;\r\n      right: -8px;\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: ne-resize;\r\n    }\r\n\r\n    .resize-handle.sw {\r\n      bottom: -8px;\r\n      left: -8px;\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: sw-resize;\r\n    }\r\n\r\n    .resize-handle.se {\r\n      bottom: -8px;\r\n      right: -8px;\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: se-resize;\r\n    }\r\n\r\n    .resize-handle.n {\r\n      top: -8px;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: n-resize;\r\n    }\r\n\r\n    .resize-handle.s {\r\n      bottom: -8px;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: s-resize;\r\n    }\r\n\r\n    .resize-handle.w {\r\n      top: 50%;\r\n      left: -8px;\r\n      transform: translateY(-50%);\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: w-resize;\r\n    }\r\n\r\n    .resize-handle.e {\r\n      top: 50%;\r\n      right: -8px;\r\n      transform: translateY(-50%);\r\n      width: 12px;\r\n      height: 12px;\r\n      cursor: e-resize;\r\n    }\r\n\r\n    .resize-border {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      border: 1px dashed var(--flow-node-selected-color, #1a73e8);\r\n      opacity: 0;\r\n      pointer-events: none;\r\n    }\r\n\r\n    :host([visible]) .resize-border {\r\n      opacity: 1;\r\n    }\r\n  `;\r\n\r\n  @property({ type: Boolean, reflect: true }) visible = false;\r\n  @property({ type: Number }) minWidth = 10;\r\n  @property({ type: Number }) minHeight = 10;\r\n  @property({ type: Number }) maxWidth = Number.MAX_VALUE;\r\n  @property({ type: Number }) maxHeight = Number.MAX_VALUE;\r\n  @property({ type: Boolean }) keepAspectRatio = false;\r\n\r\n  private isResizing = false;\r\n  private resizeStart = { x: 0, y: 0, width: 0, height: 0 };\r\n  private resizeHandle = '';\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.addEventListener('mousedown', this.handleMouseDown);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    this.removeEventListener('mousedown', this.handleMouseDown);\r\n    this.cleanup();\r\n  }\r\n\r\n  private cleanup() {\r\n    document.removeEventListener('mousemove', this.handleMouseMove);\r\n    document.removeEventListener('mouseup', this.handleMouseUp);\r\n  }\r\n\r\n  private handleMouseDown = (e: MouseEvent) => {\r\n    const target = e.target as HTMLElement;\r\n    console.log('NodeResizer handleMouseDown:', target, target.classList);\r\n    \r\n    // Check if the target is a resize handle\r\n    // If target is the host element, check if the event originated from a resize handle in shadow DOM\r\n    let isResizeHandle = target.classList.contains('resize-handle');\r\n    \r\n    if (!isResizeHandle && target === this) {\r\n      // If target is the host element, check if the event came from a resize handle\r\n      const path = e.composedPath();\r\n      isResizeHandle = path.some(el => \r\n        el instanceof HTMLElement && el.classList.contains('resize-handle')\r\n      );\r\n    }\r\n    \r\n    console.log('Is resize handle:', isResizeHandle);\r\n    if (!isResizeHandle) return;\r\n\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    e.stopImmediatePropagation();\r\n\r\n    this.isResizing = true;\r\n    \r\n    // Get the parent element (host of the shadow root)\r\n    const parentElement = (this.getRootNode() as ShadowRoot).host as HTMLElement;\r\n    \r\n    this.resizeStart = {\r\n      x: e.clientX,\r\n      y: e.clientY,\r\n      width: parentElement?.offsetWidth || 0,\r\n      height: parentElement?.offsetHeight || 0\r\n    };\r\n    // Get the handle direction from the actual resize handle element\r\n    let resizeHandleEl: HTMLElement | null = null;\r\n    \r\n    if (target.classList.contains('resize-handle')) {\r\n      resizeHandleEl = target;\r\n    } else if (target === this) {\r\n      // Find the resize handle in the composed path\r\n      const path = e.composedPath();\r\n      resizeHandleEl = path.find(el => \r\n        el instanceof HTMLElement && el.classList.contains('resize-handle')\r\n      ) as HTMLElement || null;\r\n    }\r\n    \r\n    if (resizeHandleEl) {\r\n      const classes = Array.from(resizeHandleEl.classList);\r\n      this.resizeHandle = classes.find(cls => cls !== 'resize-handle') || '';\r\n      console.log('Resize handle direction:', this.resizeHandle);\r\n    }\r\n\r\n    document.addEventListener('mousemove', this.handleMouseMove);\r\n    document.addEventListener('mouseup', this.handleMouseUp);\r\n\r\n    console.log({\r\n        width: this.resizeStart.width,\r\n        height: this.resizeStart.height\r\n      })\r\n\r\n    // Dispatch resize start event\r\n    this.dispatchEvent(new CustomEvent('resize-start', {\r\n      detail: {\r\n        width: this.resizeStart.width,\r\n        height: this.resizeStart.height\r\n      },\r\n      bubbles: true,\r\n      composed: true\r\n    }));\r\n  };\r\n\r\n  private handleMouseMove = (e: MouseEvent) => {\r\n    if (!this.isResizing) return;\r\n    \r\n    // Get the parent element (host of the shadow root)\r\n    const parentElement = (this.getRootNode() as ShadowRoot).host as HTMLElement;\r\n    if (!parentElement) return;\r\n    \r\n    console.log('NodeResizer handleMouseMove:', e);\r\n\r\n    const deltaX = e.clientX - this.resizeStart.x;\r\n    const deltaY = e.clientY - this.resizeStart.y;\r\n\r\n    let newWidth = this.resizeStart.width;\r\n    let newHeight = this.resizeStart.height;\r\n\r\n    // Calculate new dimensions based on handle direction\r\n    switch (this.resizeHandle) {\r\n      case 'nw':\r\n        newWidth = this.resizeStart.width - deltaX;\r\n        newHeight = this.resizeStart.height - deltaY;\r\n        break;\r\n      case 'ne':\r\n        newWidth = this.resizeStart.width + deltaX;\r\n        newHeight = this.resizeStart.height - deltaY;\r\n        break;\r\n      case 'sw':\r\n        newWidth = this.resizeStart.width - deltaX;\r\n        newHeight = this.resizeStart.height + deltaY;\r\n        break;\r\n      case 'se':\r\n        newWidth = this.resizeStart.width + deltaX;\r\n        newHeight = this.resizeStart.height + deltaY;\r\n        break;\r\n      case 'n':\r\n        newHeight = this.resizeStart.height - deltaY;\r\n        break;\r\n      case 's':\r\n        newHeight = this.resizeStart.height + deltaY;\r\n        break;\r\n      case 'w':\r\n        newWidth = this.resizeStart.width - deltaX;\r\n        break;\r\n      case 'e':\r\n        newWidth = this.resizeStart.width + deltaX;\r\n        break;\r\n    }\r\n\r\n    // Apply constraints\r\n    newWidth = Math.max(this.minWidth, Math.min(this.maxWidth, newWidth));\r\n    newHeight = Math.max(this.minHeight, Math.min(this.maxHeight, newHeight));\r\n\r\n    // Keep aspect ratio if enabled\r\n    if (this.keepAspectRatio) {\r\n      const aspectRatio = this.resizeStart.width / this.resizeStart.height;\r\n      if (this.resizeHandle.includes('w') || this.resizeHandle.includes('e')) {\r\n        newHeight = newWidth / aspectRatio;\r\n      } else {\r\n        newWidth = newHeight * aspectRatio;\r\n      }\r\n    }\r\n\r\n    // Apply new dimensions to parent element\r\n    parentElement.style.width = `${newWidth}px`;\r\n    parentElement.style.height = `${newHeight}px`;\r\n\r\n    // Dispatch resize event\r\n    this.dispatchEvent(new CustomEvent('resize', {\r\n      detail: {\r\n        width: newWidth,\r\n        height: newHeight,\r\n        handle: this.resizeHandle\r\n      },\r\n      bubbles: true,\r\n      composed: true\r\n    }));\r\n  };\r\n\r\n  private handleMouseUp = () => {\r\n    if (!this.isResizing) return;\r\n\r\n    this.isResizing = false;\r\n    this.cleanup();\r\n\r\n    // Get the parent element for final dimensions\r\n    const parentElement = (this.getRootNode() as ShadowRoot).host as HTMLElement;\r\n    \r\n    // Dispatch resize end event\r\n    this.dispatchEvent(new CustomEvent('resize-end', {\r\n      detail: {\r\n        width: parentElement?.offsetWidth || 0,\r\n        height: parentElement?.offsetHeight || 0\r\n      },\r\n      bubbles: true,\r\n      composed: true\r\n    }));\r\n  };\r\n\r\n  render() {\r\n    if (!this.visible) return html``;\r\n\r\n    return html`\r\n      <div class=\"resize-border\"></div>\r\n      <div class=\"resize-handle nw\"></div>\r\n      <div class=\"resize-handle ne\"></div>\r\n      <div class=\"resize-handle sw\"></div>\r\n      <div class=\"resize-handle se\"></div>\r\n      <div class=\"resize-handle n\"></div>\r\n      <div class=\"resize-handle s\"></div>\r\n      <div class=\"resize-handle w\"></div>\r\n      <div class=\"resize-handle e\"></div>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'node-resizer': NodeResizer;\r\n  }\r\n}\r\n","/**\r\n * FlowNode - Basic node component\r\n * Represents a draggable node in the flow diagram\r\n */\r\n\r\nimport { LitElement, html, css, CSSResult } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\nimport type { XYPosition } from '../core/types';\r\nimport type { FlowInstance } from '../core/flow-instance';\r\nimport './node-resizer';\r\n\r\n@customElement('flow-node')\r\nexport class FlowNode extends LitElement {\r\n  static styles: CSSResult | CSSResult[] = css`\r\n    :host {\r\n      position: absolute;\r\n      border: 1px solid var(--flow-node-border, #ddd);\r\n      border-radius: 8px;\r\n      background: var(--flow-node-background, white);\r\n      padding: 10px 20px;\r\n      cursor: grab;\r\n      user-select: none;\r\n      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n      transition: box-shadow 0.2s;\r\n      transform-origin: 0 0;\r\n      will-change: transform;\r\n      pointer-events: auto;\r\n    }\r\n\r\n    :host([dragging]) {\r\n      cursor: grabbing;\r\n      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.25);\r\n    }\r\n\r\n    :host(:hover) {\r\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);\r\n    }\r\n\r\n    :host([selected]) {\r\n      border-color: var(--flow-node-selected-border, #1a73e8);\r\n      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.3);\r\n    }\r\n\r\n    .node-content {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n    }\r\n\r\n    .handle {\r\n      position: absolute;\r\n      width: 10px;\r\n      height: 10px;\r\n      border-radius: 50%;\r\n      background: var(--flow-handle-bg, #fff);\r\n      border: 1px solid var(--flow-handle-border, #1a73e8);\r\n      box-shadow: 0 0 0 1px rgba(26, 115, 232, 0.15);\r\n      cursor: crosshair;\r\n      pointer-events: auto;\r\n    }\r\n\r\n    .handle.source {\r\n      right: -5px;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n    }\r\n\r\n    .handle.target {\r\n      left: -5px;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n    }\r\n  `;\r\n\r\n  @property({ type: String, reflect: true }) id = '';\r\n  @property({ type: Object }) data: any = {};\r\n  @property({ type: Object }) position: XYPosition = { x: 0, y: 0 };\r\n  @property({ type: Boolean, reflect: true }) selected = false;\r\n  @property({ type: Boolean, reflect: true }) dragging = false;\r\n  @property({ type: Boolean }) draggable = true;\r\n  @property({ type: Object }) instance?: FlowInstance;\r\n  @property({ type: Boolean }) resizable = false;\r\n\r\n  private isDragging = false;\r\n  private dragStart: XYPosition = { x: 0, y: 0 };\r\n  private nodeStart: XYPosition = { x: 0, y: 0 };\r\n  private lastMeasured: { width: number; height: number } | null = null;\r\n\r\n  firstUpdated() {\r\n    if (this.draggable) {\r\n      this.addEventListener('mousedown', this.handleMouseDown);\r\n    }\r\n    this.addEventListener('click', this.handleClick);\r\n    if (this.resizable) {\r\n      this.addEventListener('resize', this.handleResize as EventListener);\r\n      this.addEventListener('resize-end', this.handleResizeEnd as EventListener);\r\n    }\r\n    this.updateMeasuredSize();\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    this.removeEventListener('mousedown', this.handleMouseDown);\r\n    this.removeEventListener('click', this.handleClick);\r\n    if (this.resizable) {\r\n      this.removeEventListener('resize', this.handleResize as EventListener);\r\n      this.removeEventListener('resize-end', this.handleResizeEnd as EventListener);\r\n    }\r\n    this.cleanup();\r\n  }\r\n\r\n  private handleClick = (e: MouseEvent) => {\r\n    e.stopPropagation();\r\n    if (!this.isDragging && this.instance) {\r\n      // Toggle selection\r\n      const newSelected = !this.selected;\r\n      this.instance.updateNode(this.id, { selected: newSelected });\r\n      \r\n      // Dispatch selection event\r\n      this.dispatchEvent(new CustomEvent('node-select', {\r\n        detail: { \r\n          nodeId: this.id, \r\n          selected: newSelected,\r\n          node: {\r\n            id: this.id,\r\n            data: this.data,\r\n            position: this.position,\r\n            selected: newSelected\r\n          }\r\n        },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n    }\r\n  };\r\n\r\n  private handleResize = (e: Event) => {\r\n    const { width, height } = (e as CustomEvent).detail;\r\n    \r\n    // Update node dimensions in the instance\r\n    if (this.instance) {\r\n      this.instance.updateNode(this.id, { \r\n        width: width,\r\n        height: height,\r\n        measured: { width, height }\r\n      });\r\n    }\r\n  };\r\n\r\n  private handleResizeEnd = (e: Event) => {\r\n    const { width, height } = (e as CustomEvent).detail;\r\n    \r\n    // Final update with new dimensions\r\n    if (this.instance) {\r\n      this.instance.updateNode(this.id, { \r\n        width: width,\r\n        height: height,\r\n        measured: { width, height }\r\n      });\r\n    }\r\n\r\n    // Dispatch resize end event\r\n    this.dispatchEvent(new CustomEvent('node-resize-end', {\r\n      detail: {\r\n        nodeId: this.id,\r\n        width: width,\r\n        height: height\r\n      },\r\n      bubbles: true,\r\n      composed: true\r\n    }));\r\n  };\r\n\r\n  private handleMouseDown = (e: MouseEvent) => {\r\n    if (!this.draggable || e.button !== 0) return;\r\n    \r\n    // Check if the event is coming from a resize handle or node-resizer\r\n    const target = e.target as HTMLElement;\r\n    \r\n    // Check if the event originated from a resize handle or node-resizer\r\n    const isFromResizeHandle = target.classList.contains('resize-handle') || \r\n                              target.tagName === 'NODE-RESIZER' ||\r\n                              target.closest('node-resizer') !== null;\r\n    \r\n    if (isFromResizeHandle) {\r\n      return; // Don't start dragging if clicking on resize handle\r\n    }\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    this.isDragging = false;\r\n    this.dragStart = { x: e.clientX, y: e.clientY };\r\n    this.nodeStart = { ...this.position };\r\n\r\n    document.addEventListener('mousemove', this.handleMouseMove);\r\n    document.addEventListener('mouseup', this.handleMouseUp);\r\n  };\r\n\r\n  private handleMouseMove = (e: MouseEvent) => {\r\n    const dx = e.clientX - this.dragStart.x;\r\n    const dy = e.clientY - this.dragStart.y;\r\n    \r\n    // Start dragging if moved more than 3px\r\n    if (!this.isDragging && (Math.abs(dx) > 3 || Math.abs(dy) > 3)) {\r\n      this.isDragging = true;\r\n      this.dragging = true;\r\n      if (this.instance) {\r\n        this.instance.updateNode(this.id, { dragging: true });\r\n      }\r\n    }\r\n\r\n    if (this.isDragging && this.instance) {\r\n      const viewport = this.instance.getViewport();\r\n      const newPosition = {\r\n        x: this.nodeStart.x + dx / viewport.zoom,\r\n        y: this.nodeStart.y + dy / viewport.zoom\r\n      };\r\n      \r\n      this.instance.updateNode(this.id, { position: newPosition });\r\n    }\r\n  };\r\n\r\n  private handleMouseUp = () => {\r\n    if (this.isDragging && this.instance) {\r\n      this.instance.updateNode(this.id, { dragging: false });\r\n    }\r\n    \r\n    this.cleanup();\r\n    \r\n    // Small delay to prevent click event after drag\r\n    setTimeout(() => {\r\n      this.isDragging = false;\r\n      this.dragging = false;\r\n    }, 50);\r\n  };\r\n\r\n  private cleanup() {\r\n    document.removeEventListener('mousemove', this.handleMouseMove);\r\n    document.removeEventListener('mouseup', this.handleMouseUp);\r\n  }\r\n\r\n  render() {\r\n    return html`\r\n      <div class=\"node-container\">\r\n        <div class=\"node-content\">\r\n          ${this.data?.label || 'Node'}\r\n        </div>\r\n        <div \r\n          class=\"handle target\" \r\n          data-handle=\"target\" \r\n          data-node-id=${this.id}\r\n          @mousedown=${this.onHandleMouseDown('target')}\r\n        ></div>\r\n        <div \r\n          class=\"handle source\" \r\n          data-handle=\"source\" \r\n          data-node-id=${this.id}\r\n          @mousedown=${this.onHandleMouseDown('source')}\r\n        ></div>\r\n      </div>\r\n      ${this.resizable ? html`\r\n        <node-resizer\r\n          .visible=${this.selected}\r\n          min-width=\"50\"\r\n          min-height=\"30\"\r\n          max-width=\"500\"\r\n          max-height=\"300\"\r\n        ></node-resizer>\r\n      ` : ''}\r\n    `;\r\n  }\r\n\r\n  updated(changedProperties: Map<string | number | symbol, unknown>) {\r\n    super.updated(changedProperties);\r\n    this.style.transform = `translate(${this.position.x}px, ${this.position.y}px)`;\r\n    this.updateMeasuredSize();\r\n    \r\n    if (changedProperties.has('resizable')) {\r\n      console.log('FlowNode resizable changed:', this.resizable);\r\n    }\r\n  }\r\n\r\n  private updateMeasuredSize() {\r\n    if (!this.instance) return;\r\n    const rect = this.getBoundingClientRect();\r\n    const zoom = this.instance.getViewport().zoom || 1;\r\n    const width = rect.width / zoom;\r\n    const height = rect.height / zoom;\r\n\r\n    const changed =\r\n      !this.lastMeasured ||\r\n      Math.abs(this.lastMeasured.width - width) > 0.5 ||\r\n      Math.abs(this.lastMeasured.height - height) > 0.5;\r\n\r\n    if (changed) {\r\n      this.lastMeasured = { width, height };\r\n      this.instance.updateNode(this.id, { measured: { width, height }, width, height });\r\n    }\r\n  }\r\n\r\n  private onHandleMouseDown(type: 'source' | 'target') {\r\n    return (e: MouseEvent) => {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      this.dispatchEvent(new CustomEvent('handle-start', {\r\n        detail: { nodeId: this.id, type },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n    };\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'flow-node': FlowNode;\r\n  }\r\n}\r\n\r\n","/**\r\n * FlowEdge - Edge component for connecting nodes\r\n * Renders SVG paths between nodes\r\n */\r\n\r\nimport { LitElement, html, css, svg } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\nimport { getBezierPath, getSmoothStepPath, getStraightPath, Position } from '../utils/geometry';\r\nimport type { Node, MarkerSpec, EdgeType } from '../core/types';\r\n\r\n@customElement('flow-edge')\r\nexport class FlowEdge extends LitElement {\r\n  // Render in light DOM so marker defs in parent shadow root are addressable\r\n  /*\r\n  protected createRenderRoot() {\r\n    return this;\r\n  }\r\n  */\r\n  static styles = css`\r\n    :host {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n\r\n    svg {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n      overflow: visible;\r\n    }\r\n\r\n    .edge-path {\r\n      fill: none;\r\n      stroke: var(--flow-edge-color, #b1b1b7);\r\n      stroke-width: 3;\r\n      cursor: pointer;\r\n      pointer-events: stroke;\r\n    }\r\n\r\n    .edge-path:hover {\r\n      stroke: var(--flow-edge-selected-color, #1a73e8);\r\n    }\r\n\r\n    .edge-path.selected {\r\n      stroke: var(--flow-edge-selected-color, #1a73e8);\r\n    }\r\n\r\n    .edge-path.animated {\r\n      stroke-dasharray: 5;\r\n      animation: dashdraw 0.5s linear infinite;\r\n    }\r\n\r\n    .edge-label {\r\n      pointer-events: none;\r\n      user-select: none;\r\n      fill: #333;\r\n      font-size: 12px;\r\n    }\r\n\r\n    @keyframes dashdraw {\r\n      to {\r\n        stroke-dashoffset: -10;\r\n      }\r\n    }\r\n  `;\r\n\r\n  @property({ type: String }) id = '';\r\n  @property({ type: String }) source = '';\r\n  @property({ type: String }) target = '';\r\n  @property({ type: String }) sourceHandle?: string;\r\n  @property({ type: String }) targetHandle?: string;\r\n  @property({ type: Object }) sourceNode?: Node;\r\n  @property({ type: Object }) targetNode?: Node;\r\n  @property({ type: Boolean }) animated = false;\r\n  @property({ type: Boolean }) selected = false;\r\n  @property({ type: String }) label = '';\r\n  @property({ type: String }) type: EdgeType = 'default';\r\n  @property({ type: Object }) markerStart?: MarkerSpec | string;\r\n  @property({ type: Object }) markerEnd?: MarkerSpec | string;\r\n\r\n  private markerHandleHalf = 5; // half of node handle diameter (10px)\r\n\r\n  /**\r\n   * Create marker ID from marker spec\r\n   */\r\n  private getMarkerId(spec: MarkerSpec | string | undefined): string | undefined {\r\n    if (!spec) return undefined;\r\n    if (typeof spec === 'string') return spec;\r\n    \r\n    const key = this.normalizeMarkerSpec(spec);\r\n    return `marker-${this.hashString(key)}`;\r\n  }\r\n\r\n  /**\r\n   * Create marker SVG from marker spec\r\n   */\r\n  private createMarkerSVG(id: string, spec: MarkerSpec): string {\r\n    if (spec.type === 'custom') {\r\n      const width = spec.width ?? 10;\r\n      const height = spec.height ?? 10;\r\n      const refX = (spec.refX ?? width) + this.markerHandleHalf;\r\n      const refY = spec.refY ?? height / 2;\r\n      const color = spec.color ?? 'currentColor';\r\n      const orient = spec.orient ?? 'auto';\r\n      return `<marker id=\"${id}\" markerWidth=\"${width}\" markerHeight=\"${height}\" refX=\"${refX}\" refY=\"${refY}\" orient=\"${orient}\" markerUnits=\"userSpaceOnUse\"><path d=\"${spec.path}\" fill=\"${color}\" stroke=\"${color}\"/></marker>`;\r\n    }\r\n    \r\n    const width = spec.width ?? 10;\r\n    const height = spec.height ?? 10;\r\n    const orient = spec.orient ?? 'auto';\r\n    const color = spec.color ?? 'currentColor';\r\n    const refX = (spec.type === 'ArrowClosed' ? width : width) + this.markerHandleHalf;\r\n    const refY = height / 2;\r\n    \r\n    if (spec.type === 'ArrowClosed') {\r\n      // Triangle pointing right with tip at (width, height/2)\r\n      const path = `M0,0 L${width},${refY} L0,${height} Z`;\r\n      return `<marker id=\"${id}\" markerWidth=\"${width}\" markerHeight=\"${height}\" refX=\"${refX}\" refY=\"${refY}\" orient=\"${orient}\" markerUnits=\"userSpaceOnUse\"><path d=\"${path}\" fill=\"${color}\"/></marker>`;\r\n    }\r\n    \r\n    // Arrow (open) -> V shape stroke\r\n    const path = `M0,0 L${width},${refY} L0,${height}`;\r\n    return `<marker id=\"${id}\" markerWidth=\"${width}\" markerHeight=\"${height}\" refX=\"${refX}\" refY=\"${refY}\" orient=\"${orient}\" markerUnits=\"userSpaceOnUse\"><path d=\"${path}\" fill=\"none\" stroke=\"${color}\" stroke-width=\"2\"/></marker>`;\r\n  }\r\n\r\n  /**\r\n   * Normalize marker spec to a string key for caching\r\n   */\r\n  private normalizeMarkerSpec(spec: MarkerSpec): string {\r\n    if (spec.type === 'custom') {\r\n      const { path, width = 20, height = 20, refX = 20, refY = 10, orient = 'auto', color = 'currentColor' } = spec;\r\n      return `custom|p=${path}|w=${width}|h=${height}|rx=${refX}|ry=${refY}|o=${orient}|c=${color}`;\r\n    }\r\n    const { width = 20, height = 20, orient = 'auto', color = 'currentColor' } = spec;\r\n    return `builtin|${spec.type}|w=${width}|h=${height}|o=${orient}|c=${color}`;\r\n  }\r\n\r\n  /**\r\n   * Simple hash function for generating unique IDs\r\n   */\r\n  private hashString(input: string): string {\r\n    let h = 0;\r\n    for (let i = 0; i < input.length; i++) {\r\n      h = (h << 5) - h + input.charCodeAt(i);\r\n      h |= 0;\r\n    }\r\n    return Math.abs(h).toString(36);\r\n  }\r\n\r\n  /**\r\n   * Get path based on edge type\r\n   */\r\n  private getPathForType(source: any, target: any): [path: string, labelX: number, labelY: number, offsetX: number, offsetY: number] {\r\n    const sourceX = source.x;\r\n    const sourceY = source.y;\r\n    const targetX = target.x;\r\n    const targetY = target.y;\r\n    const sourcePosition = source.position;\r\n    const targetPosition = target.position;\r\n\r\n    switch (this.type) {\r\n      case 'straight':\r\n        return getStraightPath({\r\n          sourceX,\r\n          sourceY,\r\n          targetX,\r\n          targetY,\r\n        });\r\n      \r\n      case 'smoothstep':\r\n        return getSmoothStepPath({\r\n          sourceX,\r\n          sourceY,\r\n          sourcePosition,\r\n          targetX,\r\n          targetY,\r\n          targetPosition,\r\n        });\r\n      \r\n      case 'step':\r\n        return getSmoothStepPath({\r\n          sourceX,\r\n          sourceY,\r\n          sourcePosition,\r\n          targetX,\r\n          targetY,\r\n          targetPosition,\r\n          borderRadius: 0, // Step edges have no border radius\r\n        });\r\n      \r\n      case 'simplebezier':\r\n        return getBezierPath({\r\n          sourceX,\r\n          sourceY,\r\n          sourcePosition,\r\n          targetX,\r\n          targetY,\r\n          targetPosition,\r\n          curvature: 0.5, // Simple bezier with fixed curvature\r\n        });\r\n      \r\n      case 'default':\r\n      default:\r\n        return getBezierPath({\r\n          sourceX,\r\n          sourceY,\r\n          sourcePosition,\r\n          targetX,\r\n          targetY,\r\n          targetPosition,\r\n        });\r\n    }\r\n  }\r\n\r\n  /** Returns the ShadowRoot of the parent flow-canvas */\r\n  private getFlowCanvasRoot(): ShadowRoot | null {\r\n    const root = this.getRootNode();\r\n    return root instanceof ShadowRoot ? root : null;\r\n  }\r\n\r\n  /** Returns the flow-canvas host element (if available) */\r\n  private getFlowCanvasHost(): HTMLElement | null {\r\n    const root = this.getFlowCanvasRoot();\r\n    // root.host will be the <flow-canvas> instance\r\n    return (root && (root as any).host) || null;\r\n  }\r\n\r\n  /**\r\n   * Find a specific handle element within a node\r\n   */\r\n  private findHandleElement(nodeId: string, handleId: string): HTMLElement | null {\r\n    // Look up the node element by id inside the flow-canvas shadowRoot\r\n    const canvasRoot = this.getFlowCanvasRoot();\r\n    if (!canvasRoot) return null;\r\n\r\n    const node = canvasRoot.querySelector(`[id=\"${CSS.escape(nodeId)}\"]`) as HTMLElement | null;\r\n    if (!node) return null; // node not rendered yet\r\n\r\n    // Look in shadow root first, then light DOM\r\n    const shadowRoot = node.shadowRoot;\r\n    let handle: HTMLElement | null = null;\r\n    \r\n    if (shadowRoot) {\r\n      handle = shadowRoot.querySelector(`[data-handle-id=\"${CSS.escape(handleId)}\"]`) as HTMLElement;\r\n    }\r\n    \r\n    if (!handle) {\r\n      handle = node.querySelector(`[data-handle-id=\"${CSS.escape(handleId)}\"]`) as HTMLElement;\r\n    }\r\n    \r\n    return handle;\r\n  }\r\n\r\n  /**\r\n   * Get the canvas coordinates of a specific handle\r\n   */\r\n  private getHandlePosition(nodeId: string, handleId: string): { x: number; y: number } | null {\r\n    const handleEl = this.findHandleElement(nodeId, handleId);\r\n    if (!handleEl) return null;\r\n\r\n    // Get the node element\r\n    const canvasRoot = this.getFlowCanvasRoot();\r\n    if (!canvasRoot) return null;\r\n    \r\n    const nodeEl = canvasRoot.querySelector(`[id=\"${CSS.escape(nodeId)}\"]`) as HTMLElement | null;\r\n    if (!nodeEl) return null;\r\n\r\n    // Get handle's offset relative to node\r\n    // Handles are positioned absolutely within nodes\r\n    const nodeRect = nodeEl.getBoundingClientRect();\r\n    const handleRect = handleEl.getBoundingClientRect();\r\n    \r\n    // Get node's canvas position from its position property\r\n    // Since nodeEl is already transformed by viewport, we need the original position\r\n    const node = this.sourceNode?.id === nodeId ? this.sourceNode : this.targetNode;\r\n    if (!node) return null;\r\n\r\n    // Calculate handle offset within the node (in unscaled pixels)\r\n    const nodeWidth = node.measured?.width || node.width || 150;\r\n    const nodeHeight = node.measured?.height || node.height || 50;\r\n    \r\n    // Get viewport to calculate scale factor\r\n    const flowCanvas = this.getFlowCanvasHost() as any;\r\n    const viewport = flowCanvas?.viewport || { x: 0, y: 0, zoom: 1 };\r\n    const zoom = viewport.zoom || 1;\r\n    \r\n    // Calculate offset from node's top-left in canvas coordinates\r\n    const offsetX = (handleRect.left + handleRect.width / 2 - nodeRect.left) / zoom;\r\n    const offsetY = (handleRect.top + handleRect.height / 2 - nodeRect.top) / zoom;\r\n    \r\n    return {\r\n      x: node.position.x + offsetX,\r\n      y: node.position.y + offsetY\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the source position (handle or node edge)\r\n   */\r\n  private getSourcePosition(): { x: number; y: number; position: Position } {\r\n    // Try to get specific handle position\r\n    if (this.sourceHandle && this.sourceNode) {\r\n      const handlePos = this.getHandlePosition(this.sourceNode.id, this.sourceHandle);\r\n      if (handlePos) {\r\n        return { ...handlePos, position: Position.Right };\r\n      }\r\n    }\r\n\r\n    // Fall back to node right edge center\r\n    const sourceWidth = this.sourceNode!.measured?.width || this.sourceNode!.width || 150;\r\n    const sourceHeight = this.sourceNode!.measured?.height || this.sourceNode!.height || 50;\r\n    return {\r\n      x: this.sourceNode!.position.x + sourceWidth,\r\n      y: this.sourceNode!.position.y + sourceHeight / 2,\r\n      position: Position.Right\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the target position (handle or node edge)\r\n   */\r\n  private getTargetPosition(): { x: number; y: number; position: Position } {\r\n    // Try to get specific handle position\r\n    if (this.targetHandle && this.targetNode) {\r\n      const handlePos = this.getHandlePosition(this.targetNode.id, this.targetHandle);\r\n      if (handlePos) {\r\n        return { ...handlePos, position: Position.Left };\r\n      }\r\n    }\r\n\r\n    // Fall back to node left edge center\r\n    const targetHeight = this.targetNode!.measured?.height || this.targetNode!.height || 50;\r\n    return {\r\n      x: this.targetNode!.position.x,\r\n      y: this.targetNode!.position.y + targetHeight / 2,\r\n      position: Position.Left\r\n    };\r\n  }\r\n\r\n  render() {\r\n    if (!this.sourceNode || !this.targetNode) {\r\n      return html``;\r\n    }\r\n\r\n    // Get source and target positions (handles or node edges)\r\n    const source = this.getSourcePosition();\r\n    const target = this.getTargetPosition();\r\n\r\n    // Get path based on edge type\r\n    const [path, labelX, labelY, offsetX, offsetY] = this.getPathForType(source, target);\r\n\r\n    const pathClasses = [\r\n      'edge-path',\r\n      this.animated && 'animated',\r\n      this.selected && 'selected'\r\n    ].filter(Boolean).join(' ');\r\n    \r\n    // Create markers from specs\r\n    const markerStartId = this.getMarkerId(this.markerStart);\r\n    const markerEndId = this.getMarkerId(this.markerEnd);\r\n    \r\n    const markerStart = markerStartId ? `url(#${markerStartId})` : undefined;\r\n    const markerEnd = markerEndId ? `url(#${markerEndId})` : undefined;\r\n\r\n    const dashAttr = this.animated ? '5' : '';\r\n\r\n    return html`\r\n      <svg style=\"position:absolute; top:0; left:0; width:100%; height:100%; overflow:visible\">\r\n        <defs>\r\n          ${markerStartId && typeof this.markerStart === 'object' ? \r\n            svg`<marker id=\"${markerStartId}\" markerWidth=\"${this.markerStart.width || 10}\" markerHeight=\"${this.markerStart.height || 10}\" refX=\"${((this.markerStart.type === 'custom' ? (this.markerStart as any).refX : undefined) || this.markerStart.width || 10) + this.markerHandleHalf}\" refY=\"${(this.markerStart.type === 'custom' ? (this.markerStart as any).refY : undefined) || (this.markerStart.height || 10) / 2}\" orient=\"${this.markerStart.orient || 'auto'}\" markerUnits=\"userSpaceOnUse\">\r\n              ${this.markerStart.type === 'custom' ? \r\n                svg`<path d=\"${(this.markerStart as any).path}\" fill=\"${this.markerStart.color || 'currentColor'}\" stroke=\"${this.markerStart.color || 'currentColor'}\"/>` :\r\n                this.markerStart.type === 'ArrowClosed' ?\r\n                  svg`<path d=\"M0,0 L${this.markerStart.width || 10},${(this.markerStart.height || 10) / 2} L0,${this.markerStart.height || 10} Z\" fill=\"${this.markerStart.color || 'currentColor'}\"/>` :\r\n                  svg`<path d=\"M0,0 L${this.markerStart.width || 10},${(this.markerStart.height || 10) / 2} L0,${this.markerStart.height || 10}\" fill=\"none\" stroke=\"${this.markerStart.color || 'currentColor'}\" stroke-width=\"2\"/>`\r\n              }\r\n            </marker>` : \r\n            ''}\r\n          ${markerEndId && typeof this.markerEnd === 'object' ? \r\n            svg`<marker id=\"${markerEndId}\" markerWidth=\"${this.markerEnd.width || 10}\" markerHeight=\"${this.markerEnd.height || 10}\" refX=\"${((this.markerEnd.type === 'custom' ? (this.markerEnd as any).refX : undefined) || this.markerEnd.width || 10) + this.markerHandleHalf}\" refY=\"${(this.markerEnd.type === 'custom' ? (this.markerEnd as any).refY : undefined) || (this.markerEnd.height || 10) / 2}\" orient=\"${this.markerEnd.orient || 'auto'}\" markerUnits=\"userSpaceOnUse\">\r\n              ${this.markerEnd.type === 'custom' ? \r\n                svg`<path d=\"${(this.markerEnd as any).path}\" fill=\"${this.markerEnd.color || 'currentColor'}\" stroke=\"${this.markerEnd.color || 'currentColor'}\"/>` :\r\n                this.markerEnd.type === 'ArrowClosed' ?\r\n                  svg`<path d=\"M0,0 L${this.markerEnd.width || 10},${(this.markerEnd.height || 10) / 2} L0,${this.markerEnd.height || 10} Z\" fill=\"${this.markerEnd.color || 'currentColor'}\"/>` :\r\n                  svg`<path d=\"M0,0 L${this.markerEnd.width || 10},${(this.markerEnd.height || 10) / 2} L0,${this.markerEnd.height || 10}\" fill=\"none\" stroke=\"${this.markerEnd.color || 'currentColor'}\" stroke-width=\"2\"/>`\r\n              }\r\n            </marker>` : \r\n            ''}\r\n        </defs>\r\n        ${svg`\r\n          <path \r\n            class=\"${pathClasses}\"\r\n            d=\"${path}\"\r\n            stroke-dasharray=\"${dashAttr}\"\r\n            marker-start=\"${markerStart ?? ''}\"\r\n            marker-end=\"${markerEnd ?? ''}\"\r\n            @click=${this.handleClick}\r\n          />\r\n          ${this.label ? svg`\r\n            <text \r\n              x=\"${labelX}\" \r\n              y=\"${labelY}\" \r\n              text-anchor=\"middle\"\r\n              dy=\"-5\"\r\n              fill=\"#333\"\r\n              style=\"user-select:none; pointer-events:none; font-size:12px;\"\r\n            >\r\n              ${this.label}\r\n            </text>\r\n          ` : ''}\r\n        `}\r\n      </svg>\r\n    `;\r\n  }\r\n\r\n  private handleClick(e: MouseEvent) {\r\n    console.log('handleClick', e);\r\n    e.stopPropagation();\r\n    \r\n    // Toggle selection\r\n    const newSelected = !this.selected;\r\n    this.selected = newSelected;\r\n    \r\n    // Dispatch selection event\r\n    this.dispatchEvent(new CustomEvent('edge-select', {\r\n      detail: { \r\n        edgeId: this.id,\r\n        selected: newSelected,\r\n        edge: {\r\n          id: this.id,\r\n          source: this.source,\r\n          target: this.target,\r\n          sourceHandle: this.sourceHandle,\r\n          targetHandle: this.targetHandle,\r\n          label: this.label,\r\n          animated: this.animated,\r\n          selected: newSelected\r\n        }\r\n      },\r\n      bubbles: true,\r\n      composed: true\r\n    }));\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'flow-edge': FlowEdge;\r\n  }\r\n}\r\n\r\n","/**\r\n * FlowBackground - Background pattern component\r\n * Provides dots or lines pattern for the flow canvas\r\n */\r\n\r\nimport { LitElement, html, css, svg } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\n\r\nexport type BackgroundVariant = 'dots' | 'lines' | 'cross';\r\n\r\n@customElement('flow-background')\r\nexport class FlowBackground extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      position: absolute;\r\n      inset: 0;\r\n      pointer-events: none;\r\n      z-index: 0;\r\n    }\r\n\r\n    svg {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  `;\r\n\r\n  @property({ type: String }) variant: BackgroundVariant = 'dots';\r\n  @property({ type: Number }) gap = 20;\r\n  @property({ type: String }) color = '#ddd';\r\n  @property({ type: Number }) size = 1;\r\n\r\n  render() {\r\n    const patternId = `flow-bg-pattern-${Math.random().toString(36).substr(2, 9)}`;\r\n    \r\n    return html`\r\n      <svg>\r\n        <defs>\r\n          ${this.variant === 'dots' ? this.renderDotsPattern(patternId) : this.renderLinesPattern(patternId)}\r\n        </defs>\r\n        <rect width=\"100%\" height=\"100%\" fill=\"url(#${patternId})\" />\r\n      </svg>\r\n    `;\r\n  }\r\n\r\n  private renderDotsPattern(id: string) {\r\n    return svg`\r\n      <pattern id=\"${id}\" x=\"0\" y=\"0\" width=\"${this.gap}\" height=\"${this.gap}\" patternUnits=\"userSpaceOnUse\">\r\n        <circle cx=\"${this.size}\" cy=\"${this.size}\" r=\"${this.size}\" fill=\"${this.color}\" />\r\n      </pattern>\r\n    `;\r\n  }\r\n\r\n  private renderLinesPattern(id: string) {\r\n    return svg`\r\n      <pattern id=\"${id}\" x=\"0\" y=\"0\" width=\"${this.gap}\" height=\"${this.gap}\" patternUnits=\"userSpaceOnUse\">\r\n        <path d=\"M ${this.gap} 0 L 0 0 0 ${this.gap}\" fill=\"none\" stroke=\"${this.color}\" stroke-width=\"${this.size}\" />\r\n      </pattern>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'flow-background': FlowBackground;\r\n  }\r\n}\r\n\r\n","/**\r\n * FlowMinimap - Miniature overview component\r\n * Shows a small overview of the entire flow with viewport indicator\r\n */\r\n\r\nimport { LitElement, html, css } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\n\r\n@customElement('flow-minimap')\r\nexport class FlowMinimap extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      position: absolute;\r\n      bottom: 20px;\r\n      right: 20px;\r\n      width: 200px;\r\n      height: 150px;\r\n      background: white;\r\n      border: 1px solid #ddd;\r\n      border-radius: 8px;\r\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n      overflow: hidden;\r\n      z-index: 10;\r\n    }\r\n\r\n    .minimap-container {\r\n      width: 100%;\r\n      height: 100%;\r\n      position: relative;\r\n    }\r\n\r\n    .viewport-indicator {\r\n      position: absolute;\r\n      border: 2px solid #1a73e8;\r\n      background: rgba(26, 115, 232, 0.1);\r\n      pointer-events: none;\r\n    }\r\n  `;\r\n\r\n  @property({ type: Number }) width = 200;\r\n  @property({ type: Number }) height = 150;\r\n\r\n  render() {\r\n    return html`\r\n      <div class=\"minimap-container\">\r\n        <div class=\"viewport-indicator\"></div>\r\n        <slot></slot>\r\n      </div>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'flow-minimap': FlowMinimap;\r\n  }\r\n}\r\n\r\n","/**\r\n * FlowControls - Zoom and pan controls component\r\n * Provides UI buttons for viewport manipulation\r\n */\r\n\r\nimport { LitElement, html, css } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\nimport type { FlowInstance } from '../core/flow-instance';\r\n\r\n@customElement('flow-controls')\r\nexport class FlowControls extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      position: absolute;\r\n      bottom: 20px;\r\n      left: 20px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n      z-index: 10;\r\n    }\r\n\r\n    button {\r\n      width: 36px;\r\n      height: 36px;\r\n      border: 1px solid #ddd;\r\n      border-radius: 4px;\r\n      background: white;\r\n      cursor: pointer;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      font-size: 18px;\r\n      transition: all 0.2s;\r\n    }\r\n\r\n    button:hover {\r\n      background: #f5f5f5;\r\n      border-color: #999;\r\n    }\r\n\r\n    button:active {\r\n      background: #e0e0e0;\r\n    }\r\n\r\n    .divider {\r\n      height: 1px;\r\n      background: #ddd;\r\n      margin: 4px 0;\r\n    }\r\n  `;\r\n\r\n  @property({ type: Object }) instance?: FlowInstance;\r\n\r\n  render() {\r\n    return html`\r\n      <button @click=${this.handleZoomIn} title=\"Zoom In\">+</button>\r\n      <button @click=${this.handleZoomOut} title=\"Zoom Out\">−</button>\r\n      <div class=\"divider\"></div>\r\n      <button @click=${this.handleFitView} title=\"Fit View\">⛶</button>\r\n    `;\r\n  }\r\n\r\n  private handleZoomIn = () => {\r\n    this.instance?.zoomIn();\r\n  };\r\n\r\n  private handleZoomOut = () => {\r\n    this.instance?.zoomOut();\r\n  };\r\n\r\n  private handleFitView = () => {\r\n    this.instance?.fitView();\r\n  };\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'flow-controls': FlowControls;\r\n  }\r\n}\r\n\r\n","/**\r\n * ERDTableNode - Database table node with field-level handles\r\n * Example of a custom node type for ERD diagrams\r\n */\r\n\r\nimport { html, css, CSSResult } from 'lit';\r\nimport { customElement } from 'lit/decorators.js';\r\nimport { FlowNode } from '../flow-node';\r\nimport '../node-resizer';\r\n\r\nexport interface ERDField {\r\n  name: string;\r\n  type: string;\r\n  key?: 'PK' | 'FK' | 'UK';\r\n  nullable?: boolean;\r\n}\r\n\r\nexport interface ERDTableData {\r\n  tableName: string;\r\n  fields: ERDField[];\r\n  color?: string;\r\n  size?: { width?: number; height?: number };\r\n}\r\n\r\n@customElement('erd-table-node')\r\nexport class ERDTableNode extends FlowNode {\r\n  static styles: CSSResult | CSSResult[] = [\r\n    ...(Array.isArray(super.styles) ? super.styles : [super.styles]),\r\n    css`\r\n      :host {\r\n        padding: 0;\r\n        min-width: 200px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        background: var(--erd-table-bg, white);\r\n      }\r\n\r\n      .table-header {\r\n        background: var(--erd-table-header-bg, #2563eb);\r\n        color: white;\r\n        padding: 12px 16px;\r\n        font-weight: 600;\r\n        border-radius: 8px 8px 0 0;\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n      }\r\n\r\n      .table-icon {\r\n        font-size: 18px;\r\n      }\r\n\r\n      .table-body {\r\n        padding: 0;\r\n        overflow: auto;\r\n      }\r\n\r\n      .field-row {\r\n        display: grid;\r\n        grid-template-columns: 30px 1fr auto auto;\r\n        gap: 8px;\r\n        padding: 10px 16px;\r\n        border-bottom: 1px solid var(--erd-border, #e5e7eb);\r\n        align-items: center;\r\n        position: relative;\r\n        background: white;\r\n        transition: background 0.2s;\r\n      }\r\n\r\n      .field-row:hover {\r\n        background: var(--erd-row-hover, #f3f4f6);\r\n      }\r\n\r\n      .field-row:last-child {\r\n        border-bottom: none;\r\n        border-radius: 0 0 8px 8px;\r\n      }\r\n\r\n      .field-key {\r\n        font-size: 10px;\r\n        font-weight: 700;\r\n        color: var(--erd-key-color, #dc2626);\r\n      }\r\n\r\n      .field-name {\r\n        font-weight: 500;\r\n        color: var(--erd-text, #1f2937);\r\n      }\r\n\r\n      .field-type {\r\n        font-size: 11px;\r\n        color: var(--erd-type-color, #6b7280);\r\n        text-transform: uppercase;\r\n      }\r\n\r\n      .field-nullable {\r\n        font-size: 10px;\r\n        color: #9ca3af;\r\n      }\r\n\r\n      /* Handles for each field */\r\n      .field-handle {\r\n        position: absolute;\r\n        width: 10px;\r\n        height: 10px;\r\n        border-radius: 50%;\r\n        background: var(--flow-handle-bg, #f1f1f1);\r\n        cursor: crosshair;\r\n        pointer-events: auto;\r\n        z-index: 10;\r\n        transition: all 0.2s;\r\n      }\r\n\r\n      .field-handle.left {\r\n        left: 3px;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n      }\r\n\r\n      .field-handle.right {\r\n        right: 3px;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n      }\r\n\r\n      .field-handle:hover {\r\n        background: var(--flow-handle-border, #2563eb);\r\n        transform: translateY(-50%) scale(1.3);\r\n      }\r\n    `\r\n  ];\r\n\r\n  // Apply initial size from data.size exactly once\r\n  private appliedInitialSize = false;\r\n\r\n  firstUpdated() {\r\n    // Apply initial size before base measures, so measured size reflects it\r\n    const data = this.data as ERDTableData | undefined;\r\n    const w = data?.size?.width;\r\n    const h = data?.size?.height;\r\n    if ((typeof w === 'number' && w > 0) || (typeof h === 'number' && h > 0)) {\r\n      if (typeof w === 'number' && w > 0) this.style.width = `${w}px`;\r\n      if (typeof h === 'number' && h > 0) this.style.height = `${h}px`;\r\n      if (this.instance) {\r\n        this.instance.updateNode(this.id, {\r\n          width: typeof w === 'number' && w > 0 ? w : (this as any).width,\r\n          height: typeof h === 'number' && h > 0 ? h : (this as any).height,\r\n        });\r\n      }\r\n      this.appliedInitialSize = true;\r\n    }\r\n    super.firstUpdated();\r\n  }\r\n\r\n  updated(changedProperties: Map<string | number | symbol, unknown>) {\r\n    // No-op; initial sizing is handled in firstUpdated before measurement\r\n    super.updated(changedProperties as any);\r\n  }\r\n\r\n  private onFieldHandleMouseDown(fieldName: string, side: 'left' | 'right') {\r\n    return (e: MouseEvent) => {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      \r\n      // Generate unique handle ID\r\n      const handleId = `${this.id}-${fieldName}-${side}`;\r\n      \r\n      // Dispatch handle-start event with field information\r\n      this.dispatchEvent(new CustomEvent('handle-start', {\r\n        detail: { \r\n          nodeId: this.id, \r\n          type: side === 'left' ? 'target' : 'source',\r\n          handleId,\r\n          fieldName\r\n        },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const tableData = this.data as ERDTableData;\r\n    const tableName = tableData?.tableName || 'Table';\r\n    const fields = tableData?.fields || [];\r\n\r\n    return html`\r\n      <div class=\"table-header\" style=\"${tableData.color ? `background: ${tableData.color}` : ''}\">\r\n        <span class=\"table-icon\">📊</span>\r\n        <span>${tableName}</span>\r\n      </div>\r\n      \r\n      <div class=\"table-body\">\r\n        ${fields.map(field => html`\r\n          <div class=\"field-row\" data-field=\"${field.name}\">\r\n            <div class=\"field-key\">\r\n              ${field.key || ''}\r\n            </div>\r\n            <div class=\"field-name\">${field.name}</div>\r\n            <div class=\"field-type\">${field.type}</div>\r\n            <div class=\"field-nullable\">\r\n              ${field.nullable ? 'NULL' : ''}\r\n            </div>\r\n            \r\n            <!-- Left handle (input) for this field -->\r\n            <div \r\n              class=\"field-handle left\"\r\n              data-handle=\"target\"\r\n              data-field=\"${field.name}\"\r\n              data-handle-id=\"${this.id}-${field.name}-left\"\r\n              @mousedown=${this.onFieldHandleMouseDown(field.name, 'left')}\r\n            ></div>\r\n            \r\n            <!-- Right handle (output) for this field -->\r\n            <div \r\n              class=\"field-handle right\"\r\n              data-handle=\"source\"\r\n              data-field=\"${field.name}\"\r\n              data-handle-id=\"${this.id}-${field.name}-right\"\r\n              @mousedown=${this.onFieldHandleMouseDown(field.name, 'right')}\r\n            ></div>\r\n          </div>\r\n        `)}\r\n      </div>\r\n      ${this.resizable ? html`\r\n        <node-resizer\r\n          .visible=${this.selected}\r\n          min-width=\"150\"\r\n          min-height=\"80\"\r\n          max-width=\"500\"\r\n          max-height=\"400\"\r\n        ></node-resizer>\r\n      ` : ''}\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'erd-table-node': ERDTableNode;\r\n  }\r\n}\r\n\r\n","/**\r\n * Basic shape definitions for Lit Flow\r\n */\r\n\r\nimport type { ShapeDefinition } from '../types';\r\n\r\nexport const basicShapes: ShapeDefinition[] = [\r\n  {\r\n    type: 'circle',\r\n    name: 'Circle',\r\n    category: 'basic',\r\n    path: 'M 100 100 m -95 0 a 95 95 0 1 1 190 0 a 95 95 0 1 1 -190 0',\r\n    viewBox: '0 0 200 200',\r\n    defaultSize: { width: 200, height: 200 },\r\n    centerPoint: { x: 100, y: 100 }\r\n  },\r\n  {\r\n    type: 'rectangle',\r\n    name: 'Rectangle',\r\n    category: 'basic',\r\n    path: 'M 5 5 L 195 5 L 195 195 L 5 195 Z',\r\n    viewBox: '0 0 200 200',\r\n    defaultSize: { width: 200, height: 200 },\r\n    centerPoint: { x: 100, y: 100 }\r\n  },\r\n  {\r\n    type: 'diamond',\r\n    name: 'Diamond',\r\n    category: 'basic',\r\n    path: 'M 100 5 L 195 100 L 100 195 L 5 100 Z',\r\n    viewBox: '0 0 200 200',\r\n    defaultSize: { width: 200, height: 200 },\r\n    centerPoint: { x: 100, y: 100 }\r\n  },\r\n  {\r\n    type: 'triangle',\r\n    name: 'Triangle',\r\n    category: 'basic',\r\n    path: 'M 100 5 L 195 195 L 5 195 Z',\r\n    viewBox: '0 0 200 200',\r\n    defaultSize: { width: 200, height: 200 },\r\n    centerPoint: { x: 100, y: 100 }\r\n  }\r\n];\r\n","/**\r\n * Geometric shape definitions for Lit Flow\r\n */\r\n\r\nimport type { ShapeDefinition } from '../types';\r\n\r\nexport const geometricShapes: ShapeDefinition[] = [\r\n  {\r\n    type: 'hexagon',\r\n    name: 'Hexagon',\r\n    category: 'geometric',\r\n    path: 'M 100 5 L 175 52 L 175 148 L 100 195 L 25 148 L 25 52 Z',\r\n    viewBox: '0 0 200 200',\r\n    defaultSize: { width: 200, height: 200 },\r\n    centerPoint: { x: 100, y: 100 }\r\n  },\r\n  {\r\n    type: 'octagon',\r\n    name: 'Octagon',\r\n    category: 'geometric',\r\n    path: 'M 100 5 L 175 25 L 195 100 L 175 175 L 100 195 L 25 175 L 5 100 L 25 25 Z',\r\n    viewBox: '0 0 200 200',\r\n    defaultSize: { width: 200, height: 200 },\r\n    centerPoint: { x: 100, y: 100 }\r\n  }\r\n];\r\n","/**\r\n * Symbolic shape definitions for Lit Flow\r\n */\r\n\r\nimport type { ShapeDefinition } from '../types';\r\n\r\nexport const symbolicShapes: ShapeDefinition[] = [\r\n  {\r\n    type: 'heart',\r\n    name: 'Heart',\r\n    category: 'symbolic',\r\n    path: 'M 100 185 C 100 185, 10 95, 10 50 C 10 25, 35 5, 60 5 C 80 5, 100 25, 100 50 C 100 25, 120 5, 140 5 C 165 5, 190 25, 190 50 C 190 95, 100 185, 100 185 Z',\r\n    viewBox: '0 0 200 200',\r\n    defaultSize: { width: 200, height: 200 },\r\n    centerPoint: { x: 100, y: 100 }\r\n  }\r\n];\r\n","/**\r\n * Shape Registry - Centralized shape definitions and management\r\n */\r\n\r\nimport type { ShapeType, ShapeDefinition } from './types';\r\nimport { basicShapes } from './shapes/basic-shapes';\r\nimport { geometricShapes } from './shapes/geometric-shapes';\r\nimport { symbolicShapes } from './shapes/symbolic-shapes';\r\n\r\nexport class ShapeRegistry {\r\n  private static shapes = new Map<ShapeType, ShapeDefinition>();\r\n\r\n  /**\r\n   * Initialize the registry with default shapes\r\n   */\r\n  static initialize(): void {\r\n    // Register all default shapes\r\n    const allShapes = [...basicShapes, ...geometricShapes, ...symbolicShapes];\r\n    allShapes.forEach(shape => {\r\n      this.shapes.set(shape.type, shape);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Register a new shape definition\r\n   */\r\n  static register(definition: ShapeDefinition): void {\r\n    this.shapes.set(definition.type, definition);\r\n  }\r\n\r\n  /**\r\n   * Get a shape definition by type\r\n   */\r\n  static get(shapeType: ShapeType): ShapeDefinition | undefined {\r\n    return this.shapes.get(shapeType);\r\n  }\r\n\r\n  /**\r\n   * Get all registered shapes\r\n   */\r\n  static getAll(): ShapeDefinition[] {\r\n    return Array.from(this.shapes.values());\r\n  }\r\n\r\n  /**\r\n   * Get shapes by category\r\n   */\r\n  static getByCategory(category: string): ShapeDefinition[] {\r\n    return Array.from(this.shapes.values()).filter(shape => shape.category === category);\r\n  }\r\n\r\n  /**\r\n   * Check if a shape type is registered\r\n   */\r\n  static has(shapeType: ShapeType): boolean {\r\n    return this.shapes.has(shapeType);\r\n  }\r\n\r\n  /**\r\n   * Get all available shape types\r\n   */\r\n  static getShapeTypes(): ShapeType[] {\r\n    return Array.from(this.shapes.keys());\r\n  }\r\n\r\n  /**\r\n   * Clear all registered shapes\r\n   */\r\n  static clear(): void {\r\n    this.shapes.clear();\r\n  }\r\n\r\n  /**\r\n   * Get shape count\r\n   */\r\n  static getCount(): number {\r\n    return this.shapes.size;\r\n  }\r\n}\r\n\r\n// Initialize the registry when the module is loaded\r\nShapeRegistry.initialize();\r\n","/**\r\n * ShapeNode - Component for rendering shape-based nodes\r\n * Uses a centralized Shape component that renders different SVG paths based on shape type\r\n */\r\n\r\nimport { LitElement, html, css } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\nimport type { ShapeNodeData, ShapeNodeDataDirect } from './types';\r\nimport { ShapeRegistry } from './shape-registry';\r\nimport '../node-resizer';\r\n\r\n@customElement('shape-node')\r\nexport class ShapeNode extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      position: absolute;\r\n      display: block;\r\n      pointer-events: auto;\r\n      transform-origin: 0 0;\r\n      will-change: transform;\r\n      transform: translate(var(--position-x, 0px), var(--position-y, 0px));\r\n    }\r\n\r\n    .shape-node {\r\n      position: relative;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      cursor: grab;\r\n      user-select: none;\r\n      pointer-events: auto;\r\n      width: var(--shape-width, 200px);\r\n      height: var(--shape-height, 200px);\r\n    }\r\n\r\n    .shape-node:active {\r\n      cursor: grabbing;\r\n    }\r\n\r\n    .shape-node.selected {\r\n      outline: 2px solid var(--flow-node-selected-color, #1a73e8);\r\n      outline-offset: 2px;\r\n    }\r\n\r\n    :host([dragging]) .shape-node {\r\n      cursor: grabbing;\r\n      filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.25));\r\n    }\r\n\r\n    .shape-svg {\r\n      display: block;\r\n      transition: transform 0.2s ease;\r\n      pointer-events: none;\r\n    }\r\n\r\n    .shape-content {\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n      pointer-events: none;\r\n      z-index: 1;\r\n    }\r\n\r\n    .shape-node:hover .shape-svg {\r\n      transform: scale(1.05);\r\n    }\r\n\r\n    .unknown-shape {\r\n      width: 100px;\r\n      height: 100px;\r\n      background: #f0f0f0;\r\n      border: 2px dashed #ccc;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      color: #666;\r\n      font-size: 12px;\r\n      pointer-events: none;\r\n    }\r\n\r\n    .handle {\r\n      position: absolute;\r\n      width: 10px;\r\n      height: 10px;\r\n      border-radius: 50%;\r\n      background: var(--flow-handle-bg, #fff);\r\n      border: 1px solid var(--flow-handle-border, #1a73e8);\r\n      box-shadow: 0 0 0 1px rgba(26, 115, 232, 0.15);\r\n      cursor: crosshair;\r\n      pointer-events: auto;\r\n      z-index: 10;\r\n      opacity: 0;\r\n      transition: opacity 0.2s ease;\r\n    }\r\n\r\n    .handle:hover {\r\n      opacity: 1;\r\n      transform: scale(1.2);\r\n    }\r\n\r\n    .handle.source {\r\n      right: -5px;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n    }\r\n\r\n    .handle.target {\r\n      left: -5px;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n    }\r\n\r\n    .handle.top {\r\n      top: -5px;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n    }\r\n\r\n    .handle.bottom {\r\n      bottom: -5px;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n    }\r\n\r\n    .shape-node:hover .handle {\r\n      opacity: 1;\r\n    }\r\n\r\n    .shape-label {\r\n      position: absolute;\r\n      top: 50%;\r\n      left: 50%;\r\n      transform: translate(-50%, -50%);\r\n      background: rgba(255, 255, 255, 0.9);\r\n      border: 1px solid rgba(0, 0, 0, 0.1);\r\n      border-radius: 4px;\r\n      padding: 2px 6px;\r\n      font-size: 12px;\r\n      color: #333;\r\n      white-space: nowrap;\r\n      user-select: none;\r\n      pointer-events: none;\r\n      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n      z-index: 5;\r\n    }\r\n\r\n    .shape-label.editable {\r\n      pointer-events: auto;\r\n      cursor: text;\r\n    }\r\n\r\n    .shape-label.editable:hover {\r\n      background: rgba(255, 255, 255, 1);\r\n      border-color: var(--flow-node-selected-color, #1a73e8);\r\n    }\r\n\r\n    .handle:active {\r\n      opacity: 1;\r\n      transform: scale(1.3);\r\n    }\r\n  `;\r\n\r\n  @property({ type: String, reflect: true }) id = '';\r\n  @property({ type: Object }) data!: ShapeNodeDataDirect;\r\n  @property({ \r\n    type: Object, \r\n    hasChanged: (newVal: { x: number; y: number }, oldVal: { x: number; y: number }) => {\r\n      return !oldVal || newVal.x !== oldVal.x || newVal.y !== oldVal.y;\r\n    }\r\n  }) position!: { x: number; y: number };\r\n  @property({ type: Boolean, reflect: true }) selected = false;\r\n  @property({ type: Boolean, reflect: true }) dragging = false;\r\n  @property({ type: Boolean }) draggable = true;\r\n  @property({ type: Boolean }) connectable = true;\r\n  @property({ type: Object }) instance: any = null;\r\n  @property({ type: Boolean }) resizable = false;\r\n\r\n  private isDragging = false;\r\n  private dragStart = { x: 0, y: 0 };\r\n  private nodeStart = { x: 0, y: 0 };\r\n\r\n  updated(changedProperties: Map<string | number | symbol, unknown>) {\r\n    super.updated(changedProperties);\r\n    \r\n    // Handle property changes if needed\r\n    if (changedProperties.has('position') && !this.isDragging) {\r\n      // Position updated from outside (not during dragging)\r\n      // This can be used for future features like animation\r\n    }\r\n    \r\n    if (changedProperties.has('resizable')) {\r\n      console.log('ShapeNode resizable changed:', this.resizable);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the shape definition from the registry\r\n   */\r\n  private getShapeDefinition() {\r\n    if (!this.data?.type) {\r\n      return undefined;\r\n    }\r\n    return ShapeRegistry.get(this.data.type);\r\n  }\r\n\r\n  /**\r\n   * Render the SVG shape\r\n   */\r\n  private renderShape() {\r\n    const shapeDef = this.getShapeDefinition();\r\n    if (!shapeDef) {\r\n      return html`\r\n        <div class=\"unknown-shape\">\r\n          Unknown shape: ${this.data?.type || 'undefined'}\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    const config = this.data;\r\n    const size = config.size || shapeDef.defaultSize;\r\n    const fillColor = config.backgroundColor || config.color || '#ffffff';\r\n    const strokeColor = config.strokeColor || '#000000';\r\n    const strokeWidth = config.strokeWidth || 2;\r\n    const rotation = config.rotation || 0;\r\n\r\n    return html`\r\n      <svg \r\n        class=\"shape-svg\"\r\n        width=\"${size.width}\" \r\n        height=\"${size.height}\" \r\n        viewBox=\"${shapeDef.viewBox}\"\r\n        style=\"transform: rotate(${rotation}deg)\"\r\n      >\r\n        <path \r\n          d=\"${shapeDef.path}\" \r\n          fill=\"${fillColor}\"\r\n          stroke=\"${strokeColor}\"\r\n          stroke-width=\"${strokeWidth}\"\r\n        />\r\n      </svg>\r\n    `;\r\n  }\r\n\r\n  /**\r\n   * Render gradient definitions if needed\r\n   */\r\n  private renderGradients() {\r\n    const config = this.data;\r\n    if (config && 'gradient' in config && config.gradient) {\r\n      const gradientId = `gradient-${this.data.type}-${Math.random().toString(36).substr(2, 9)}`;\r\n      const gradient = config.gradient;\r\n      \r\n      if (gradient.type === 'linear') {\r\n        return html`\r\n          <defs>\r\n            <linearGradient id=\"${gradientId}\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n              ${gradient.colors.map((color, index) => \r\n                html`<stop offset=\"${(index / (gradient.colors.length - 1)) * 100}%\" stop-color=\"${color}\"/>`\r\n              )}\r\n            </linearGradient>\r\n          </defs>\r\n        `;\r\n      } else if (gradient.type === 'radial') {\r\n        return html`\r\n          <defs>\r\n            <radialGradient id=\"${gradientId}\" cx=\"50%\" cy=\"50%\" r=\"50%\">\r\n              ${gradient.colors.map((color, index) => \r\n                html`<stop offset=\"${(index / (gradient.colors.length - 1)) * 100}%\" stop-color=\"${color}\"/>`\r\n              )}\r\n            </radialGradient>\r\n          </defs>\r\n        `;\r\n      }\r\n    }\r\n    return html``;\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.addEventListener('click', this.handleClick);\r\n    this.addEventListener('mousedown', this.handleMouseDown);\r\n    if (this.resizable) {\r\n      this.addEventListener('resize', this.handleResize as EventListener);\r\n      this.addEventListener('resize-end', this.handleResizeEnd as EventListener);\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    super.disconnectedCallback();\r\n    this.removeEventListener('click', this.handleClick);\r\n    this.removeEventListener('mousedown', this.handleMouseDown);\r\n    if (this.resizable) {\r\n      this.removeEventListener('resize', this.handleResize as EventListener);\r\n      this.removeEventListener('resize-end', this.handleResizeEnd as EventListener);\r\n    }\r\n    this.cleanup();\r\n  }\r\n\r\n  private cleanup() {\r\n    document.removeEventListener('mousemove', this.handleMouseMove);\r\n    document.removeEventListener('mouseup', this.handleMouseUp);\r\n  }\r\n\r\n  /**\r\n   * Handle click events\r\n   */\r\n  private handleClick = (e: MouseEvent) => {\r\n    e.stopPropagation();\r\n    if (!this.isDragging && this.instance) {\r\n      // Toggle selection\r\n      const newSelected = !this.selected;\r\n      this.instance.updateNode(this.id, { selected: newSelected });\r\n      \r\n      // Dispatch selection event\r\n      this.dispatchEvent(new CustomEvent('node-select', {\r\n        detail: {\r\n          nodeId: this.id,\r\n          selected: newSelected,\r\n          node: {\r\n            id: this.id,\r\n            data: this.data,\r\n            position: this.position,\r\n            selected: newSelected\r\n          }\r\n        },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n    }\r\n  };\r\n\r\n  private handleResize = (e: Event) => {\r\n    const { width, height } = (e as CustomEvent).detail;\r\n    \r\n    // Update the shape data with new size\r\n    if (this.data && this.instance) {\r\n      const updatedData = {\r\n        ...this.data,\r\n        size: { width, height }\r\n      };\r\n      \r\n      this.instance.updateNode(this.id, { \r\n        data: updatedData,\r\n        width: width,\r\n        height: height,\r\n        measured: { width, height }\r\n      });\r\n    }\r\n  };\r\n\r\n  private handleResizeEnd = (e: Event) => {\r\n    const { width, height } = (e as CustomEvent).detail;\r\n    \r\n    // Final update with new dimensions\r\n    if (this.data && this.instance) {\r\n      const updatedData = {\r\n        ...this.data,\r\n        size: { width, height }\r\n      };\r\n      \r\n      this.instance.updateNode(this.id, { \r\n        data: updatedData,\r\n        width: width,\r\n        height: height,\r\n        measured: { width, height }\r\n      });\r\n    }\r\n\r\n    // Dispatch resize end event\r\n    this.dispatchEvent(new CustomEvent('node-resize-end', {\r\n      detail: {\r\n        nodeId: this.id,\r\n        width: width,\r\n        height: height\r\n      },\r\n      bubbles: true,\r\n      composed: true\r\n    }));\r\n  };\r\n\r\n  private handleMouseDown = (e: MouseEvent) => {\r\n    if (!this.draggable || e.button !== 0) return;\r\n    \r\n    // Check if the event is coming from a resize handle or node-resizer\r\n    const target = e.target as HTMLElement;\r\n    \r\n    // Check if the event originated from a resize handle or node-resizer\r\n    const isFromResizeHandle = target.classList.contains('resize-handle') || \r\n                              target.tagName === 'NODE-RESIZER' ||\r\n                              target.closest('node-resizer') !== null;\r\n    \r\n    if (isFromResizeHandle) {\r\n      return; // Don't start dragging if clicking on resize handle\r\n    }\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    this.isDragging = false;\r\n    this.dragStart = { x: e.clientX, y: e.clientY };\r\n    this.nodeStart = { ...this.position };\r\n\r\n    document.addEventListener('mousemove', this.handleMouseMove);\r\n    document.addEventListener('mouseup', this.handleMouseUp);\r\n  };\r\n\r\n  private handleMouseMove = (e: MouseEvent) => {\r\n    const dx = e.clientX - this.dragStart.x;\r\n    const dy = e.clientY - this.dragStart.y;\r\n    \r\n    // Start dragging if moved more than 3px\r\n    if (!this.isDragging && (Math.abs(dx) > 3 || Math.abs(dy) > 3)) {\r\n      this.isDragging = true;\r\n      if (this.instance) {\r\n        this.instance.updateNode(this.id, { dragging: true });\r\n      }\r\n    }\r\n\r\n    if (this.isDragging && this.instance) {\r\n      const viewport = this.instance.getViewport();\r\n      const newPosition = {\r\n        x: this.nodeStart.x + dx / viewport.zoom,\r\n        y: this.nodeStart.y + dy / viewport.zoom\r\n      };\r\n      \r\n      this.instance.updateNode(this.id, { position: newPosition });\r\n    }\r\n  };\r\n\r\n  private handleMouseUp = () => {\r\n    console.log('handleMouseUp');\r\n    if (this.isDragging && this.instance) {\r\n      this.instance.updateNode(this.id, { dragging: false });\r\n    }\r\n    \r\n    this.isDragging = false;\r\n    this.cleanup();\r\n  };\r\n\r\n  private handleHandleStart = (e: MouseEvent) => {\r\n    console.log('handleHandleStart', e);\r\n    e.stopPropagation();\r\n    this.isDragging = false;\r\n    \r\n    const handle = e.target as HTMLElement;\r\n    const handleId = handle.dataset.handleId;\r\n    const handleType = handle.dataset.handleType;\r\n    \r\n    if (handleType && handleId) {\r\n      this.dispatchEvent(new CustomEvent('handle-start', {\r\n        detail: {\r\n          nodeId: this.id,\r\n          handleId: handleId,\r\n          handleType: handleType,\r\n          position: this.position\r\n        },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n    }\r\n  };\r\n\r\n  render() {\r\n    // Set CSS custom properties on the host element\r\n    this.style.setProperty('--position-x', `${this.position.x}px`);\r\n    this.style.setProperty('--position-y', `${this.position.y}px`);\r\n    \r\n    // Set shape dimensions\r\n    const shapeDef = this.getShapeDefinition();\r\n    const config = this.data;\r\n    const size = config?.size || shapeDef?.defaultSize || { width: 200, height: 200 };\r\n    this.style.setProperty('--shape-width', `${size.width}px`);\r\n    this.style.setProperty('--shape-height', `${size.height}px`);\r\n    \r\n    return html`\r\n      <div class=\"shape-node ${this.selected ? 'selected' : ''}\">\r\n        ${this.renderGradients()}\r\n        ${this.renderShape()}\r\n        <div class=\"shape-content\">\r\n          <slot></slot>\r\n        </div>\r\n        ${this.connectable ? this.renderHandles() : ''}\r\n        ${this.renderLabel()}\r\n      </div>\r\n      ${this.resizable ? html`\r\n        <node-resizer\r\n          .visible=${this.selected}\r\n          min-width=\"50\"\r\n          min-height=\"50\"\r\n          max-width=\"500\"\r\n          max-height=\"500\"\r\n        ></node-resizer>\r\n      ` : ''}\r\n    `;\r\n  }\r\n\r\n  private renderHandles() {\r\n    const nodeId = this.id;\r\n    return html`\r\n      <div \r\n        class=\"handle source\" \r\n        data-handle=\"source\" \r\n        data-node-id=\"${nodeId}\"\r\n        data-handle-id=\"${nodeId}-source-right\"\r\n        data-handle-type=\"source\"\r\n        @mousedown=${this.handleHandleStart}\r\n      ></div>\r\n      <div \r\n        class=\"handle target\" \r\n        data-handle=\"target\" \r\n        data-node-id=\"${nodeId}\"\r\n        data-handle-id=\"${nodeId}-target-left\"\r\n        data-handle-type=\"target\"\r\n        @mousedown=${this.handleHandleStart}\r\n      ></div>\r\n      <div \r\n        class=\"handle top\" \r\n        data-handle=\"source\" \r\n        data-node-id=\"${nodeId}\"\r\n        data-handle-id=\"${nodeId}-source-top\"\r\n        data-handle-type=\"source\"\r\n        @mousedown=${this.handleHandleStart}\r\n      ></div>\r\n      <div \r\n        class=\"handle bottom\" \r\n        data-handle=\"target\" \r\n        data-node-id=\"${nodeId}\"\r\n        data-handle-id=\"${nodeId}-target-bottom\"\r\n        data-handle-type=\"target\"\r\n        @mousedown=${this.handleHandleStart}\r\n      ></div>\r\n    `;\r\n  }\r\n\r\n  private renderLabel() {\r\n    const shapeConfig = this.data;\r\n    if (!shapeConfig) return '';\r\n\r\n    // Get the label - use provided label or default to shape type\r\n    const label = shapeConfig.label || shapeConfig.type;\r\n    \r\n    return html`\r\n      <div class=\"shape-label\">\r\n        ${label}\r\n      </div>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'shape-node': ShapeNode;\r\n  }\r\n}\r\n","/**\r\n * Base Node UI components (Lit)\r\n * Similar to React Flow UI Base Node: header, content, footer wrappers\r\n */\r\n\r\nimport { LitElement, html, css } from 'lit';\r\nimport { customElement, property } from 'lit/decorators.js';\r\n\r\n@customElement('base-node')\r\nexport class BaseNode extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      display: block;\r\n      border: 1px solid var(--flow-node-border, #e5e7eb);\r\n      border-radius: 8px;\r\n      background: var(--flow-node-background, #ffffff);\r\n      color: var(--flow-node-foreground, #111827);\r\n      overflow: hidden;\r\n    }\r\n  `;\r\n\r\n  render() {\r\n    return html`<slot></slot>`;\r\n  }\r\n}\r\n\r\n@customElement('base-node-header')\r\nexport class BaseNodeHeader extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      padding: 10px 12px;\r\n      background: var(--base-node-header-bg, #f9fafb);\r\n      border-bottom: 1px solid var(--flow-node-border, #e5e7eb);\r\n      font-weight: 600;\r\n    }\r\n  `;\r\n  render() {\r\n    return html`<slot></slot>`;\r\n  }\r\n}\r\n\r\n@customElement('base-node-header-title')\r\nexport class BaseNodeHeaderTitle extends LitElement {\r\n  static styles = css`\r\n    :host { display: contents; }\r\n    .title {\r\n      font-size: 14px;\r\n      font-weight: 600;\r\n      color: var(--base-node-title, #111827);\r\n    }\r\n  `;\r\n  render() {\r\n    return html`<span class=\"title\"><slot></slot></span>`;\r\n  }\r\n}\r\n\r\n@customElement('base-node-content')\r\nexport class BaseNodeContent extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      display: block;\r\n      padding: 12px;\r\n    }\r\n  `;\r\n  render() {\r\n    return html`<slot></slot>`;\r\n  }\r\n}\r\n\r\n@customElement('base-node-footer')\r\nexport class BaseNodeFooter extends LitElement {\r\n  static styles = css`\r\n    :host {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      padding: 10px 12px;\r\n      background: var(--base-node-footer-bg, #fafafa);\r\n      border-top: 1px solid var(--flow-node-border, #e5e7eb);\r\n    }\r\n  `;\r\n  render() {\r\n    return html`<slot></slot>`;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'base-node': BaseNode;\r\n    'base-node-header': BaseNodeHeader;\r\n    'base-node-header-title': BaseNodeHeaderTitle;\r\n    'base-node-content': BaseNodeContent;\r\n    'base-node-footer': BaseNodeFooter;\r\n  }\r\n}\r\n\r\n\r\n","/**\r\n * NodeMixin - Provides core node functionality without inheritance\r\n * Can be applied to any LitElement to add node behavior\r\n * \r\n * Features:\r\n * - Dragging and positioning\r\n * - Selection handling\r\n * - Resizing with configurable constraints\r\n * - Event dispatching for all interactions\r\n * \r\n * Usage:\r\n * \r\n * The mixin automatically appends the resizer to the DOM when resizable=true and selected=true.\r\n * Components can use any render method - the resizer will be automatically added.\r\n * \r\n * ```typescript\r\n * @customElement('my-node')\r\n * export class MyNode extends NodeMixin(LitElement) {\r\n *   constructor() {\r\n *     super();\r\n *     this.resizable = true;\r\n *     this.minWidth = 100;\r\n *     this.minHeight = 50;\r\n *   }\r\n * \r\n *   // Any render method works - resizer is automatically appended\r\n *   render() {\r\n *     return html`<div>My node content</div>`;\r\n *   }\r\n * }\r\n * ```\r\n * \r\n * To restrict dragging to a specific element (e.g., only header):\r\n * ```typescript\r\n * @customElement('my-node')\r\n * export class MyNode extends NodeMixin(LitElement) {\r\n *   constructor() {\r\n *     super();\r\n *     this.drag_handle_selector = '.node-header'; // Only header can be used to drag\r\n *   }\r\n * \r\n *   render() {\r\n *     return html`\r\n *       <div class=\"node-header\">Header - drag from here</div>\r\n *       <div class=\"node-body\">\r\n *         Body content - interactive elements here won't trigger dragging\r\n *       </div>\r\n *     `;\r\n *   }\r\n * }\r\n * ```\r\n * \r\n * For manual control, you can also use:\r\n * ```typescript\r\n * render() {\r\n *   return html`\r\n *     <div>My node content</div>\r\n *     ${this.getResizer()}\r\n *   `;\r\n * }\r\n * ```\r\n */\r\n\r\nimport { LitElement, html, css, render } from 'lit';\r\nimport { property } from 'lit/decorators.js';\r\n\r\nexport interface NodeMixinInterface {\r\n  id: string;\r\n  position: { x: number; y: number };\r\n  data: any;\r\n  selected: boolean;\r\n  dragging: boolean;\r\n  instance: any;\r\n  resizable: boolean;\r\n  draggable: boolean;\r\n  drag_handle_selector: string | null;\r\n  connectable: boolean;\r\n  minWidth: number;\r\n  maxWidth: number;\r\n  minHeight: number;\r\n  maxHeight: number;\r\n  keepAspectRatio: boolean;\r\n  maxInitialHeight: number;\r\n  renderComponent(): any;\r\n  getResizer(): any;\r\n  adjustHeightToContent(): void;\r\n  notifyHandlesUpdated(options?: { handleIds?: string[]; updateDimensions?: boolean }): Promise<void>;\r\n}\r\n\r\nexport const NodeMixin = <T extends Constructor<LitElement>>(superClass: T) => {\r\n  class NodeMixinClass extends superClass {\r\n    static get styles() {\r\n      return [css`\r\n      :host {\r\n        position: absolute;\r\n        cursor: var(--node-cursor, grab);\r\n        user-select: none;\r\n        transform-origin: 0 0;\r\n        will-change: transform;\r\n        pointer-events: auto;\r\n        border: var(--node-border, 1px solid #ddd);\r\n        border-radius: var(--node-border-radius, 8px);\r\n        background: var(--node-background, white);\r\n        box-shadow: var(--node-shadow, 0 1px 3px rgba(0, 0, 0, 0.1));\r\n        transition: var(--node-transition, box-shadow 0.2s);\r\n      }\r\n\r\n      /* When drag_handle_selector is set, default cursor is normal (not grab) */\r\n      :host([data-drag-handle-selector]) {\r\n        cursor: default;\r\n      }\r\n\r\n      :host(:hover) {\r\n        box-shadow: var(--node-hover-shadow, 0 4px 6px rgba(0, 0, 0, 0.15));\r\n      }\r\n\r\n      :host([dragging]) {\r\n        cursor: var(--node-dragging-cursor, grabbing);\r\n        box-shadow: var(--node-dragging-shadow, 0 8px 16px rgba(0, 0, 0, 0.25));\r\n      }\r\n\r\n      :host([selected]) {\r\n        border-color: var(--node-selected-border, #1a73e8);\r\n        box-shadow: var(--node-selected-shadow, 0 0 0 2px rgba(26, 115, 232, 0.3));\r\n      }\r\n\r\n      /* Resizer styles - matching existing components */\r\n      .resize-border {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        border: var(--resize-border-style, 1px dashed var(--node-selected-border, #1a73e8));\r\n        border-radius: var(--node-border-radius, 8px);\r\n        opacity: var(--resize-border-opacity, 0);\r\n        pointer-events: none;\r\n        transition: var(--resize-transition, opacity 0.2s ease);\r\n      }\r\n\r\n      :host([selected]) .resize-border {\r\n        opacity: var(--resize-border-opacity-selected, 1);\r\n      }\r\n\r\n      .resize-handle {\r\n        position: absolute;\r\n        background: var(--resize-handle-background, var(--node-selected-border, #1a73e8));\r\n        border: var(--resize-handle-border, 2px solid #fff);\r\n        border-radius: var(--resize-handle-border-radius, 2px);\r\n        width: var(--resize-handle-size, 12px);\r\n        height: var(--resize-handle-size, 12px);\r\n        opacity: var(--resize-handle-opacity, 0);\r\n        transition: var(--resize-transition, opacity 0.2s ease);\r\n        pointer-events: auto;\r\n        box-shadow: var(--resize-handle-shadow, 0 2px 4px rgba(0, 0, 0, 0.2));\r\n        z-index: 10;\r\n      }\r\n\r\n      .resize-handle:hover {\r\n        opacity: var(--resize-handle-opacity-hover, 1);\r\n      }\r\n\r\n      :host([selected]) .resize-handle {\r\n        opacity: var(--resize-handle-opacity-selected, 1);\r\n      }\r\n\r\n      .resize-handle.nw {\r\n        top: var(--resize-handle-offset, -8px);\r\n        left: var(--resize-handle-offset, -8px);\r\n        cursor: nw-resize;\r\n      }\r\n\r\n      .resize-handle.ne {\r\n        top: var(--resize-handle-offset, -8px);\r\n        right: var(--resize-handle-offset, -8px);\r\n        cursor: ne-resize;\r\n      }\r\n\r\n      .resize-handle.sw {\r\n        bottom: var(--resize-handle-offset, -8px);\r\n        left: var(--resize-handle-offset, -8px);\r\n        cursor: sw-resize;\r\n      }\r\n\r\n      .resize-handle.se {\r\n        bottom: var(--resize-handle-offset, -8px);\r\n        right: var(--resize-handle-offset, -8px);\r\n        cursor: se-resize;\r\n      }\r\n\r\n      .resize-handle.n {\r\n        top: var(--resize-handle-offset, -8px);\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        cursor: n-resize;\r\n      }\r\n\r\n      .resize-handle.s {\r\n        bottom: var(--resize-handle-offset, -8px);\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        cursor: s-resize;\r\n      }\r\n\r\n      .resize-handle.w {\r\n        top: 50%;\r\n        left: var(--resize-handle-offset, -8px);\r\n        transform: translateY(-50%);\r\n        cursor: w-resize;\r\n      }\r\n\r\n      .resize-handle.e {\r\n        top: 50%;\r\n        right: var(--resize-handle-offset, -8px);\r\n        transform: translateY(-50%);\r\n        cursor: e-resize;\r\n      }\r\n      `];\r\n    }\r\n\r\n    @property({ type: String, reflect: true }) id = '';\r\n    @property({ type: Object }) position = { x: 0, y: 0 };\r\n    @property({ type: Object }) data = {};\r\n    @property({ type: Boolean, reflect: true }) selected = false;\r\n    @property({ type: Boolean, reflect: true }) dragging = false;\r\n    @property({ type: Object }) instance: any = null;\r\n    @property({ type: Boolean }) resizable = false;\r\n    @property({ type: Boolean }) draggable = true;\r\n    @property({ type: String }) drag_handle_selector: string | null = null;\r\n    @property({ type: Boolean }) connectable = true;\r\n    @property({ type: Number }) minWidth = 10;\r\n    @property({ type: Number }) maxWidth = Number.MAX_VALUE;\r\n    @property({ type: Number }) minHeight = 10;\r\n    @property({ type: Number }) maxHeight = Number.MAX_VALUE;\r\n    @property({ type: Boolean }) keepAspectRatio = false;\r\n    @property({ type: Number }) maxInitialHeight = 0; // 0 = no initial height limit, otherwise sets max height if content exceeds\r\n\r\n    private isDragging = false;\r\n    private dragStart = { x: 0, y: 0 };\r\n    private nodeStart = { x: 0, y: 0 };\r\n    \r\n    // Resizer state\r\n    private isResizing = false;\r\n    private resizeStart = { x: 0, y: 0, width: 0, height: 0 };\r\n    private resizeHandle = '';\r\n    \r\n    // Drag handle element reference\r\n    private dragHandleElement: HTMLElement | null = null;\r\n\r\n    connectedCallback() {\r\n      super.connectedCallback();\r\n      // Only attach mousedown to entire node if no drag_handle_selector is set\r\n      if (this.draggable && !this.drag_handle_selector) {\r\n        this.addEventListener('mousedown', this.handleMouseDown);\r\n      }\r\n      this.addEventListener('click', this.handleClick);\r\n      // Add global click handler for deselection\r\n      document.addEventListener('click', this.handleGlobalClick);\r\n      // Resizer functionality is now handled directly in the mixin\r\n    }\r\n\r\n    disconnectedCallback() {\r\n      super.disconnectedCallback();\r\n      this.removeEventListener('mousedown', this.handleMouseDown);\r\n      this.removeEventListener('click', this.handleClick);\r\n      document.removeEventListener('click', this.handleGlobalClick);\r\n      // Clean up drag handle listener\r\n      this.removeDragHandleListener();\r\n      // Resizer functionality is now handled directly in the mixin\r\n      this.cleanup();\r\n    }\r\n\r\n\r\n    private handleClick = (e: MouseEvent) => {\r\n      e.stopPropagation();\r\n      if (!this.isDragging) {\r\n        const newSelected = !this.selected;\r\n        this.selected = newSelected;\r\n        \r\n        // Update instance if available\r\n        if (this.instance) {\r\n          this.instance.updateNode(this.id, { selected: newSelected });\r\n        }\r\n        \r\n        this.dispatchEvent(new CustomEvent('node-select', {\r\n          detail: { \r\n            nodeId: this.id, \r\n            selected: newSelected,\r\n            node: {\r\n              id: this.id,\r\n              data: this.data,\r\n              position: this.position,\r\n              selected: newSelected\r\n            }\r\n          },\r\n          bubbles: true,\r\n          composed: true\r\n        }));\r\n      }\r\n    };\r\n\r\n    private handleMouseDown = (e: MouseEvent) => {\r\n      if (e.button !== 0) return;\r\n      \r\n      const target = e.target as HTMLElement;\r\n      \r\n      // Check if the target is a resize handle or if it's inside a resize handle\r\n      const isFromResizeHandle = target.classList.contains('resize-handle') || \r\n                                target.closest('.resize-handle') !== null;\r\n      \r\n      if (isFromResizeHandle) {\r\n        this.handleResizeStart(e);\r\n        return;\r\n      }\r\n      \r\n      if (!this.draggable) return;\r\n      \r\n      // If drag_handle_selector is set, the listener is only on the drag handle element\r\n      // So if we reach here, it means the click was on the drag handle or node (if no selector set)\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      this.isDragging = false;\r\n      this.dragStart = { x: e.clientX, y: e.clientY };\r\n      this.nodeStart = { ...this.position };\r\n\r\n      document.addEventListener('mousemove', this.handleMouseMove);\r\n      document.addEventListener('mouseup', this.handleMouseUp);\r\n    };\r\n\r\n    private handleMouseMove = (e: MouseEvent) => {\r\n      if (this.isResizing) {\r\n        this.handleResizeMove(e);\r\n        return;\r\n      }\r\n      \r\n      const dx = e.clientX - this.dragStart.x;\r\n      const dy = e.clientY - this.dragStart.y;\r\n      \r\n      if (!this.isDragging && (Math.abs(dx) > 3 || Math.abs(dy) > 3)) {\r\n        this.isDragging = true;\r\n        this.dragging = true;\r\n        // Update cursor on drag handle element if it exists\r\n        if (this.dragHandleElement) {\r\n          this.dragHandleElement.style.cursor = 'grabbing';\r\n        }\r\n        if (this.instance) {\r\n          this.instance.updateNode(this.id, { dragging: true });\r\n        }\r\n      }\r\n\r\n      if (this.isDragging && this.instance) {\r\n        const viewport = this.instance.getViewport();\r\n        const newPosition = {\r\n          x: this.nodeStart.x + dx / viewport.zoom,\r\n          y: this.nodeStart.y + dy / viewport.zoom\r\n        };\r\n        \r\n        this.instance.updateNode(this.id, { position: newPosition });\r\n      }\r\n    };\r\n\r\n    private handleMouseUp = () => {\r\n      if (this.isDragging && this.instance) {\r\n        this.instance.updateNode(this.id, { dragging: false });\r\n      }\r\n      \r\n      // Restore cursor on drag handle element when dragging ends\r\n      if (this.dragHandleElement && this.isDragging) {\r\n        this.dragHandleElement.style.cursor = 'grab';\r\n      }\r\n      \r\n      if (this.isResizing) {\r\n        this.handleResizeEnd();\r\n      }\r\n      \r\n      this.cleanup();\r\n      setTimeout(() => {\r\n        this.isDragging = false;\r\n        this.dragging = false;\r\n        this.isResizing = false;\r\n      }, 50);\r\n    };\r\n\r\n    private handleResizeStart = (e: MouseEvent, handle?: string) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      e.stopImmediatePropagation();\r\n\r\n      this.isResizing = true;\r\n      \r\n      // Get the actual computed dimensions, accounting for any CSS transforms\r\n      const rect = this.getBoundingClientRect();\r\n      const computedStyle = getComputedStyle(this);\r\n      \r\n      // Use the computed width/height if available, otherwise use the bounding rect\r\n      let width = parseFloat(computedStyle.width);\r\n      let height = parseFloat(computedStyle.height);\r\n      \r\n      // If computed values are not available or are 0, use the bounding rect\r\n      if (!width || width === 0) {\r\n        width = rect.width;\r\n      }\r\n      if (!height || height === 0) {\r\n        height = rect.height;\r\n      }\r\n      \r\n      this.resizeStart = {\r\n        x: e.clientX,\r\n        y: e.clientY,\r\n        width: width,\r\n        height: height\r\n      };\r\n\r\n      // Use the provided handle or try to detect it\r\n      if (handle) {\r\n        this.resizeHandle = handle;\r\n      } else {\r\n        // Get the handle direction from the target element\r\n        let target = e.target as HTMLElement;\r\n        \r\n        // If the target is not a resize handle, find the closest one\r\n        if (!target.classList.contains('resize-handle')) {\r\n          const resizeHandle = target.closest('.resize-handle') as HTMLElement;\r\n          if (resizeHandle) {\r\n            target = resizeHandle;\r\n          }\r\n        }\r\n        \r\n        const classes = Array.from(target.classList);\r\n        this.resizeHandle = classes.find(cls => cls !== 'resize-handle') || '';\r\n      }\r\n\r\n      // console.log('Resize started with handle:', this.resizeHandle);\r\n\r\n      document.addEventListener('mousemove', this.handleMouseMove);\r\n      document.addEventListener('mouseup', this.handleMouseUp);\r\n\r\n      // Dispatch resize start event\r\n      this.dispatchEvent(new CustomEvent('resize-start', {\r\n        detail: {\r\n          width: this.resizeStart.width,\r\n          height: this.resizeStart.height\r\n        },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n    };\r\n\r\n    private handleResizeMove = (e: MouseEvent) => {\r\n      if (!this.isResizing) return;\r\n\r\n      const deltaX = e.clientX - this.resizeStart.x;\r\n      const deltaY = e.clientY - this.resizeStart.y;\r\n\r\n      // console.log('Resizing with handle:', this.resizeHandle, 'delta:', deltaX, deltaY);\r\n\r\n      let newWidth = this.resizeStart.width;\r\n      let newHeight = this.resizeStart.height;\r\n\r\n      // Calculate new dimensions based on handle direction\r\n      switch (this.resizeHandle) {\r\n        case 'nw':\r\n          newWidth = this.resizeStart.width - deltaX;\r\n          newHeight = this.resizeStart.height - deltaY;\r\n          break;\r\n        case 'ne':\r\n          newWidth = this.resizeStart.width + deltaX;\r\n          newHeight = this.resizeStart.height - deltaY;\r\n          break;\r\n        case 'sw':\r\n          newWidth = this.resizeStart.width - deltaX;\r\n          newHeight = this.resizeStart.height + deltaY;\r\n          break;\r\n        case 'se':\r\n          newWidth = this.resizeStart.width + deltaX;\r\n          newHeight = this.resizeStart.height + deltaY;\r\n          break;\r\n        case 'n':\r\n          newHeight = this.resizeStart.height - deltaY;\r\n          break;\r\n        case 's':\r\n          newHeight = this.resizeStart.height + deltaY;\r\n          break;\r\n        case 'w':\r\n          newWidth = this.resizeStart.width - deltaX;\r\n          break;\r\n        case 'e':\r\n          newWidth = this.resizeStart.width + deltaX;\r\n          break;\r\n      }\r\n\r\n      // Apply constraints\r\n      newWidth = Math.max(this.minWidth, Math.min(this.maxWidth, newWidth));\r\n      newHeight = Math.max(this.minHeight, Math.min(this.maxHeight, newHeight));\r\n\r\n      // Keep aspect ratio if enabled\r\n      if (this.keepAspectRatio) {\r\n        const aspectRatio = this.resizeStart.width / this.resizeStart.height;\r\n        if (this.resizeHandle.includes('w') || this.resizeHandle.includes('e')) {\r\n          newHeight = newWidth / aspectRatio;\r\n        } else {\r\n          newWidth = newHeight * aspectRatio;\r\n        }\r\n      }\r\n\r\n      // Apply new dimensions\r\n      this.style.width = `${newWidth}px`;\r\n      this.style.height = `${newHeight}px`;\r\n\r\n      // Dispatch resize event\r\n      this.dispatchEvent(new CustomEvent('resize', {\r\n        detail: {\r\n          width: newWidth,\r\n          height: newHeight,\r\n          handle: this.resizeHandle\r\n        },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n\r\n      // Update instance if available\r\n      if (this.instance) {\r\n        this.instance.updateNode(this.id, { \r\n          width: newWidth,\r\n          height: newHeight,\r\n          measured: { width: newWidth, height: newHeight }\r\n        });\r\n      }\r\n    };\r\n\r\n    private handleResizeEnd = () => {\r\n      if (!this.isResizing) return;\r\n\r\n      // console.log('Resize ending - final dimensions:', this.offsetWidth, this.offsetHeight);\r\n      this.isResizing = false;\r\n\r\n      // Dispatch resize end event\r\n      this.dispatchEvent(new CustomEvent('resize-end', {\r\n        detail: {\r\n          width: this.offsetWidth,\r\n          height: this.offsetHeight\r\n        },\r\n        bubbles: true,\r\n        composed: true\r\n      }));\r\n\r\n      // Update instance if available\r\n      if (this.instance) {\r\n        this.instance.updateNode(this.id, { \r\n          width: this.offsetWidth,\r\n          height: this.offsetHeight,\r\n          measured: { width: this.offsetWidth, height: this.offsetHeight }\r\n        });\r\n      }\r\n    };\r\n\r\n    private handleGlobalClick = (e: MouseEvent) => {\r\n      // Check if the click is outside this node\r\n      const target = e.target as HTMLElement;\r\n      const isNodeClick = target.closest(this.tagName.toLowerCase()) !== null;\r\n      \r\n      if (!isNodeClick) {\r\n        // Deselect this node if it's selected\r\n        if (this.selected) {\r\n          this.selected = false;\r\n          \r\n          // Update instance if available\r\n          if (this.instance) {\r\n            this.instance.updateNode(this.id, { selected: false });\r\n          }\r\n          \r\n          // Dispatch deselection event\r\n          this.dispatchEvent(new CustomEvent('node-deselect', {\r\n            detail: { \r\n              nodeId: this.id, \r\n              selected: false,\r\n              node: {\r\n                id: this.id,\r\n                data: this.data,\r\n                position: this.position,\r\n                selected: false\r\n              }\r\n            },\r\n            bubbles: true,\r\n            composed: true\r\n          }));\r\n        }\r\n      }\r\n    };\r\n\r\n    private cleanup() {\r\n      document.removeEventListener('mousemove', this.handleMouseMove);\r\n      document.removeEventListener('mouseup', this.handleMouseUp);\r\n    }\r\n\r\n    /**\r\n     * Renders the resizer handles and border when the node is resizable and selected\r\n     * This is now called automatically by the mixin's render method\r\n     */\r\n    private renderResizer() {\r\n      if (!this.resizable || !this.selected) {\r\n        return html``;\r\n      }\r\n      return html`\r\n        <div class=\"resize-border\"></div>\r\n        <div class=\"resize-handle nw\" @mousedown=${this.handleResizeHandleClick('nw')}></div>\r\n        <div class=\"resize-handle ne\" @mousedown=${this.handleResizeHandleClick('ne')}></div>\r\n        <div class=\"resize-handle sw\" @mousedown=${this.handleResizeHandleClick('sw')}></div>\r\n        <div class=\"resize-handle se\" @mousedown=${this.handleResizeHandleClick('se')}></div>\r\n        <div class=\"resize-handle n\" @mousedown=${this.handleResizeHandleClick('n')}></div>\r\n        <div class=\"resize-handle s\" @mousedown=${this.handleResizeHandleClick('s')}></div>\r\n        <div class=\"resize-handle w\" @mousedown=${this.handleResizeHandleClick('w')}></div>\r\n        <div class=\"resize-handle e\" @mousedown=${this.handleResizeHandleClick('e')}></div>\r\n      `;\r\n    }\r\n\r\n    /**\r\n     * Helper method to get just the resizer HTML\r\n     * Use this in components that override render() method\r\n     */\r\n    protected getResizer() {\r\n      return this.renderResizer();\r\n    }\r\n\r\n    /**\r\n     * Automatically append resizer to DOM after rendering\r\n     * This works even when components override render() method\r\n     */\r\n    firstUpdated() {\r\n      this.appendResizerToDOM();\r\n      \r\n      // Set data attribute for CSS cursor styling\r\n      if (this.drag_handle_selector) {\r\n        this.setAttribute('data-drag-handle-selector', '');\r\n      }\r\n      \r\n      // Wait for DOM to be fully rendered before attaching drag handle listener\r\n      Promise.resolve().then(() => {\r\n        this.attachDragHandleListener();\r\n        this.adjustHeightToContent();\r\n      });\r\n    }\r\n\r\n    updated(changedProperties: Map<string | number | symbol, unknown>) {\r\n      super.updated(changedProperties);\r\n      // Apply transform for positioning\r\n      this.style.transform = `translate(${this.position.x}px, ${this.position.y}px)`;\r\n      \r\n      // Adjust height to content if maxInitialHeight changed (only if not resizing)\r\n      if (changedProperties.has('maxInitialHeight') && !this.isResizing) {\r\n        // Wait a tick for content to render, then adjust height\r\n        Promise.resolve().then(() => {\r\n          this.adjustHeightToContent();\r\n        });\r\n      }\r\n      \r\n      // Re-append resizer if resizable or selected state changed\r\n      if (changedProperties.has('resizable') || changedProperties.has('selected')) {\r\n        this.appendResizerToDOM();\r\n      }\r\n      \r\n      // Re-attach drag handle listener if drag_handle_selector or draggable changed\r\n      if (changedProperties.has('drag_handle_selector') || changedProperties.has('draggable')) {\r\n        Promise.resolve().then(() => {\r\n          this.attachDragHandleListener();\r\n        });\r\n      }\r\n      \r\n      // Update cursor style based on drag_handle_selector\r\n      if (changedProperties.has('drag_handle_selector')) {\r\n        if (this.drag_handle_selector) {\r\n          this.setAttribute('data-drag-handle-selector', '');\r\n        } else {\r\n          this.removeAttribute('data-drag-handle-selector');\r\n        }\r\n      }\r\n    }\r\n\r\n    private appendResizerToDOM() {\r\n      // Remove existing resizer if it exists\r\n      this.removeExistingResizer();\r\n      \r\n      // Only append resizer if resizable and selected\r\n      if (this.resizable && this.selected) {\r\n        const resizerTemplate = this.renderResizer();\r\n        if (resizerTemplate) {\r\n          // Create a container for the resizer\r\n          const resizerContainer = document.createElement('div');\r\n          resizerContainer.className = 'mixin-resizer-container';\r\n          resizerContainer.style.cssText = `\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            right: 0;\r\n            bottom: 0;\r\n            pointer-events: none;\r\n            z-index: 10;\r\n          `;\r\n          \r\n          // Append to shadow DOM\r\n          this.shadowRoot?.appendChild(resizerContainer);\r\n          \r\n          // Render the resizer content using Lit's render function\r\n          render(resizerTemplate, resizerContainer);\r\n        }\r\n      }\r\n    }\r\n\r\n    private removeExistingResizer() {\r\n      const existingResizer = this.shadowRoot?.querySelector('.mixin-resizer-container');\r\n      if (existingResizer) {\r\n        existingResizer.remove();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Attach mousedown listener to the drag handle element if drag_handle_selector is set\r\n     */\r\n    private attachDragHandleListener() {\r\n      // Remove existing listener first\r\n      this.removeDragHandleListener();\r\n      \r\n      // Only attach if draggable and drag_handle_selector is set\r\n      if (!this.draggable || !this.drag_handle_selector) {\r\n        return;\r\n      }\r\n      \r\n      const shadowRoot = this.shadowRoot;\r\n      if (!shadowRoot) {\r\n        // Shadow root not ready yet, try again after a short delay\r\n        setTimeout(() => this.attachDragHandleListener(), 0);\r\n        return;\r\n      }\r\n      \r\n      // Find the drag handle element in shadow root\r\n      const dragHandleElement = shadowRoot.querySelector(this.drag_handle_selector) as HTMLElement;\r\n      \r\n      if (dragHandleElement) {\r\n        this.dragHandleElement = dragHandleElement;\r\n        // Attach the mousedown listener directly to the drag handle element\r\n        dragHandleElement.addEventListener('mousedown', this.handleMouseDown);\r\n        \r\n        // Set cursor style on the drag handle - it will show grab cursor\r\n        dragHandleElement.style.cursor = 'grab';\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Remove mousedown listener from the drag handle element\r\n     */\r\n    private removeDragHandleListener() {\r\n      if (this.dragHandleElement) {\r\n        this.dragHandleElement.removeEventListener('mousedown', this.handleMouseDown);\r\n        this.dragHandleElement.style.cursor = '';\r\n        this.dragHandleElement = null;\r\n      }\r\n    }\r\n\r\n    private handleResizeHandleClick = (handle: string) => {\r\n      return (e: MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n        this.handleResizeStart(e, handle);\r\n      };\r\n    };\r\n\r\n    /**\r\n     * Adjusts node height to fit content up to maxInitialHeight\r\n     * If maxInitialHeight is 0, this method does nothing\r\n     * If content height > maxInitialHeight: sets height to maxInitialHeight (content will scroll)\r\n     * If content height <= maxInitialHeight: doesn't set height (lets it fit to content)\r\n     * Called automatically in firstUpdated, but can be called manually after content loads\r\n     */\r\n    protected adjustHeightToContent() {\r\n      // Only apply logic if maxInitialHeight is set (> 0)\r\n      if (this.maxInitialHeight <= 0) return;\r\n      \r\n      // Don't adjust if currently resizing or if instance/node not ready\r\n      if (!this.instance || !this.id || this.isResizing) return;\r\n      \r\n      // Temporarily remove height constraint to measure actual content height\r\n      const originalHeight = this.style.height;\r\n      this.style.height = 'auto';\r\n      \r\n      // Force a reflow to ensure content is measured\r\n      this.offsetHeight;\r\n      \r\n      // Measure the actual content height (scrollHeight includes all content)\r\n      const contentHeight = this.scrollHeight || this.getBoundingClientRect().height;\r\n      \r\n      // Only set height if content exceeds maxInitialHeight\r\n      if (contentHeight > this.maxInitialHeight) {\r\n        // Content exceeds limit - set height to maxInitialHeight\r\n        this.style.height = `${this.maxInitialHeight}px`;\r\n        \r\n        // Update instance with calculated height\r\n        this.instance.updateNode(this.id, {\r\n          height: this.maxInitialHeight,\r\n          measured: { \r\n            width: this.offsetWidth || this.getBoundingClientRect().width,\r\n            height: this.maxInitialHeight \r\n          }\r\n        });\r\n      } else {\r\n        // Content fits within limit - don't set height, let it fit naturally\r\n        // But restore original height style if it was set\r\n        if (originalHeight) {\r\n          this.style.height = originalHeight;\r\n        } else {\r\n          // Clear height to let content determine size\r\n          this.style.height = '';\r\n        }\r\n        \r\n        // Update instance with actual content height\r\n        if (contentHeight > 0) {\r\n          this.instance.updateNode(this.id, {\r\n            height: contentHeight,\r\n            measured: { \r\n              width: this.offsetWidth || this.getBoundingClientRect().width,\r\n              height: contentHeight \r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Notifies the flow instance that handles have been dynamically added/updated\r\n     * Call this after using Lit's render() to add handles dynamically (e.g., after API data loads)\r\n     * \r\n     * This method:\r\n     * 1. Waits for DOM update to complete\r\n     * 2. Updates node dimensions to trigger handle position recalculation\r\n     * 3. Dispatches a custom event for flow canvas to listen to\r\n     * \r\n     * @example\r\n     * ```typescript\r\n     * async loadFields() {\r\n     *   const fields = await fetchFields();\r\n     *   const container = this.shadowRoot.querySelector('.fields-container');\r\n     *   render(fieldsTemplate, container);\r\n     *   \r\n     *   // Notify flow instance after handles are rendered\r\n     *   this.notifyHandlesUpdated();\r\n     * }\r\n     * ```\r\n     */\r\n    protected async notifyHandlesUpdated(options?: {\r\n      /** Optional list of handle IDs that were added/updated */\r\n      handleIds?: string[];\r\n      /** Whether to update node dimensions (default: true) */\r\n      updateDimensions?: boolean;\r\n    }) {\r\n      const { handleIds, updateDimensions = true } = options || {};\r\n      \r\n      // Wait for any pending DOM updates\r\n      await this.updateComplete;\r\n      \r\n      // Small delay to ensure handles are fully rendered in the DOM\r\n      await new Promise(resolve => setTimeout(resolve, 0));\r\n      \r\n      if (this.instance && this.id) {\r\n        // Update node dimensions to trigger flow canvas recalculation\r\n        // This forces the flow canvas to recalculate handle positions\r\n        if (updateDimensions) {\r\n          const rect = this.getBoundingClientRect();\r\n          const currentWidth = rect.width;\r\n          const currentHeight = rect.height;\r\n          \r\n          this.instance.updateNode(this.id, {\r\n            width: currentWidth,\r\n            height: currentHeight,\r\n            measured: { width: currentWidth, height: currentHeight }\r\n          });\r\n        }\r\n        \r\n        // Dispatch custom event that flow canvas can listen to\r\n        this.dispatchEvent(new CustomEvent('node-handles-updated', {\r\n          detail: { \r\n            nodeId: this.id,\r\n            handleIds: handleIds || [],\r\n            timestamp: Date.now()\r\n          },\r\n          bubbles: true,\r\n          composed: true\r\n        }));\r\n      }\r\n    }\r\n  }\r\n\r\n  return NodeMixinClass as any;\r\n};\r\n\r\ntype Constructor<T = {}> = new (...args: any[]) => T;\r\n"],"names":["noop","dispatch","i","n","_","t","Dispatch","parseTypenames","typenames","types","name","typename","callback","T","get","set","copy","type","that","args","c","xhtml","namespaces","namespace","prefix","creatorInherit","document","uri","creatorFixed","fullname","creator","none","selector","selection_select","select","groups","m","subgroups","j","group","subgroup","node","subnode","Selection","array","x","empty","selectorAll","arrayAll","selection_selectAll","parents","matcher","childMatcher","find","childFind","match","childFirst","selection_selectChild","filter","children","childrenFilter","selection_selectChildren","selection_filter","sparse","update","selection_enter","EnterNode","parent","datum","child","next","constant$2","bindIndex","enter","exit","data","groupLength","dataLength","bindKey","key","nodeByKeyValue","keyValues","keyValue","selection_data","value","bind","constant","arraylike","enterGroup","updateGroup","exitGroup","i0","i1","previous","selection_exit","selection_join","onenter","onupdate","onexit","selection_merge","context","selection","groups0","groups1","m0","m1","merges","group0","group1","merge","selection_order","selection_sort","compare","ascending","compareNode","a","b","sortgroups","sortgroup","selection_call","selection_nodes","selection_node","selection_size","size","selection_empty","selection_each","attrRemove","attrRemoveNS","attrConstant","attrConstantNS","attrFunction","v","attrFunctionNS","selection_attr","defaultView","styleRemove","styleConstant","priority","styleFunction","selection_style","styleValue","propertyRemove","propertyConstant","propertyFunction","selection_property","classArray","string","classList","ClassList","classedAdd","names","list","classedRemove","classedTrue","classedFalse","classedFunction","selection_classed","textRemove","textConstant","textFunction","selection_text","htmlRemove","htmlConstant","htmlFunction","selection_html","raise","selection_raise","lower","selection_lower","selection_append","create","constantNull","selection_insert","before","remove","selection_remove","selection_cloneShallow","clone","selection_cloneDeep","selection_clone","deep","selection_datum","contextListener","listener","event","onRemove","on","o","onAdd","options","selection_on","dispatchEvent","params","window","dispatchConstant","dispatchFunction","selection_dispatch","selection_iterator","root","selection_selection","sourceEvent","pointer","svg","point","rect","nonpassivecapture","noevent$1","dragDisable","view","noevent","yesdrag","noclick","define","constructor","factory","prototype","extend","definition","Color","darker","brighter","reI","reN","reP","reHex","reRgbInteger","reRgbPercent","reRgbaInteger","reRgbaPercent","reHslPercent","reHslaPercent","named","color","channels","color_formatHex","color_formatHex8","color_formatHsl","color_formatRgb","hslConvert","format","l","rgbn","Rgb","rgba","hsla","r","g","rgbConvert","rgb","opacity","k","clampi","clampa","rgb_formatHex","rgb_formatHex8","rgb_formatRgb","hex","h","s","Hsl","min","max","hsl","m2","hsl2rgb","clamph","clampt","constant$1","linear","d","exponential","y","gamma","nogamma","interpolateRgb","rgbGamma","start","end","colorRgb","numberArray","isNumberArray","genericArray","nb","na","date","interpolateNumber","object","reA","reB","zero","one","interpolateString","bi","am","bm","bs","q","number","interpolate$1","degrees","identity","decompose","e","f","scaleX","scaleY","skewX","svgNode","parseCss","parseSvg","interpolateTransform","parse","pxComma","pxParen","degParen","pop","translate","xa","ya","xb","yb","rotate","scale","interpolateTransformCss","interpolateTransformSvg","epsilon2","cosh","sinh","tanh","interpolateZoom","zoomRho","rho","rho2","rho4","zoom","p0","p1","ux0","uy0","w0","ux1","uy1","w1","dx","dy","d2","S","d1","b0","b1","r0","r1","coshr0","u","_1","_2","_4","frame","timeout","interval","pokeDelay","taskHead","taskTail","clockLast","clockNow","clockSkew","clock","setFrame","now","clearNow","Timer","timer","delay","time","sleep","timerFlush","wake","nap","poke","t0","t1","t2","elapsed","emptyOn","emptyTween","CREATED","SCHEDULED","STARTING","STARTED","RUNNING","ENDING","ENDED","schedule","id","index","timing","schedules","init","self","tween","stop","tick","interrupt","active","selection_interrupt","tweenRemove","tween0","tween1","tweenFunction","transition_tween","tweenValue","transition","interpolate","value1","string00","string1","interpolate0","string0","string10","transition_attr","attrInterpolate","attrInterpolateNS","attrTweenNS","attrTween","transition_attrTween","delayFunction","delayConstant","transition_delay","durationFunction","durationConstant","transition_duration","easeConstant","transition_ease","easeVarying","transition_easeVarying","transition_filter","Transition","transition_merge","onFunction","on0","on1","sit","transition_on","removeFunction","transition_remove","transition_select","transition_selectAll","inherit","transition_selection","styleNull","style","styleMaybeRemove","listener0","transition_style","styleInterpolate","styleTween","transition_styleTween","transition_text","textInterpolate","textTween","transition_textTween","transition_transition","id0","id1","newId","transition_end","resolve","reject","cancel","selection_prototype","cubicInOut","defaultTiming","easeCubicInOut","selection_transition","ZoomEvent","target","transform","Transform","location","nopropagation","defaultFilter","defaultExtent","defaultTransform","defaultWheelDelta","defaultTouchable","defaultConstrain","extent","translateExtent","dx0","dx1","dy0","dy1","constrain","wheelDelta","touchable","scaleExtent","duration","listeners","touchstarting","touchfirst","touchending","touchDelay","wheelDelay","clickDistance2","tapDistance","wheeled","mousedowned","dblclicked","touchstarted","touchmoved","touchended","collection","gesture","p","k0","k1","centroid","w","clean","Gesture","wheelidled","currentTarget","mousemoved","mouseupped","x0","y0","dragEnable","touches","started","l0","l1","dp","dl","ConnectionMode","PanOnScrollMode","SelectionMode","ConnectionLineType","MarkerType","Position","clamp","val","isNumeric","isMacOs","getBezierEdgeCenter","sourceX","sourceY","targetX","targetY","sourceControlX","sourceControlY","targetControlX","targetControlY","centerX","centerY","offsetX","offsetY","calculateControlOffset","distance","curvature","getControlWithCurvature","pos","x1","y1","x2","y2","getBezierPath","sourcePosition","targetPosition","labelX","labelY","getEdgeCenter","xOffset","yOffset","getStraightPath","handleDirections","getDirection","source","getPoints","center","offset","stepPosition","sourceDir","targetDir","sourceGapped","targetGapped","dir","dirAccessor","currDir","points","sourceGapOffset","targetGapOffset","defaultOffsetX","defaultOffsetY","verticalSplit","horizontalSplit","sourceTarget","targetSource","diff","gapOffset","dirAccessorOpposite","isSameDir","sourceGtTargetOppo","sourceLtTargetOppo","sourceGapPoint","targetGapPoint","maxXDistance","maxYDistance","getBend","bendSize","xDir","yDir","getSmoothStepPath","borderRadius","res","segment","viewChanged","prevViewport","eventViewport","transformToViewport","viewportToTransform","zoomIdentity","isWrappedWithClass","className","isRightClickPan","panOnDrag","usedButton","defaultEase","getD3Transition","ease","onEnd","hasDuration","factor","createPanOnScrollHandler","zoomPanValues","noWheelClassName","d3Selection","d3Zoom","panOnScrollMode","panOnScrollSpeed","zoomOnPinch","onPanZoomStart","onPanZoom","onPanZoomEnd","currentZoom","pinchDelta","deltaNormalize","deltaX","deltaY","nextViewport","createZoomOnScrollHandler","preventScrolling","d3ZoomHandler","isWheel","preventZoom","hasNoWheelClass","createPanZoomStartHandler","onDraggingChange","viewport","createPanZoomHandler","onPaneContextMenu","onTransformChange","createPanZoomEndHandler","panOnScroll","createFilter","zoomActivationKeyPressed","zoomOnScroll","zoomOnDoubleClick","userSelectionActive","noPanClassName","lib","connectionInProgress","zoomScroll","pinchZoom","isWheelEvent","buttonAllowed","XYPanZoom","domNode","minZoom","maxZoom","paneClickDistance","bbox","d3ZoomInstance","setViewportConstrained","d3DblClickZoomHandler","setTransform","destroy","wheelHandler","startHandler","panZoomHandler","panZoomEndHandler","nextTransform","contrainedTransform","setViewport","syncViewport","currentTransform","getViewport","zoomTransform","scaleTo","scaleBy","setScaleExtent","setTranslateExtent","setClickDistance","validDistance","ResizeControlVariant","FlowInstance","container","isDragging","_event","_viewport","_t","nodes","edges","updates","edge","newZoom","minX","minY","maxX","maxY","width","height","bounds","containerWidth","containerHeight","padding","zoomX","zoomY","internalNode","nodeId","nodeEl","nodeIds","retryCount","maxRetries","allNodeIds","uniqueNodeIds","createStore","initialState","state","updateLookups","n$5","$","E","A","C","P","V","N","H","I","L","M","R","z","B","i$1","getDistance","getCenter","getSystemBezierPath","getSystemSmoothStepPath","getSystemStraightPath","isPointInRect","FlowCanvas","LitElement","handleId","path","targetEl","targetHandleId","tagName","tag","targetId","newEdgeId","sourceNodeId","sourceHandleId","finalTargetHandleId","targetNode","selected","edgeId","el","viewportEl","vpRect","cy","handleEl","shadowRoot","nodeRect","handleRect","shapeData","parts","handleType","result","targetNodeId","sourceNode","targetData","targetWidth","targetHeight","sourceCenterX","sourceCenterY","targetCenterX","targetCenterY","handlePos","sourceWidth","sourceHeight","nodeType","unsafeStatic","html","styleMap","labelHtml","labelText","startHtml","startText","endHtml","endText","vx","vy","preview","nodeFrom","nodeTo","css","__decorateClass","property","customElement","NodeResizer","isResizeHandle","parentElement","resizeHandleEl","classes","cls","newWidth","newHeight","aspectRatio","FlowNode","newSelected","newPosition","changedProperties","FlowEdge","spec","refX","refY","orient","input","canvasRoot","handle","pathClasses","markerStartId","markerEndId","markerStart","markerEnd","dashAttr","FlowBackground","patternId","FlowMinimap","FlowControls","ERDTableNode","fieldName","side","tableData","tableName","fields","field","__superGet","basicShapes","geometricShapes","symbolicShapes","_ShapeRegistry","shape","shapeType","category","ShapeRegistry","ShapeNode","updatedData","shapeDef","config","fillColor","strokeColor","strokeWidth","rotation","gradientId","gradient","shapeConfig","label","newVal","oldVal","BaseNode","BaseNodeHeader","BaseNodeHeaderTitle","BaseNodeContent","BaseNodeFooter","NodeMixin","superClass","NodeMixinClass","computedStyle","resizeHandle","resizerTemplate","resizerContainer","render","existingResizer","dragHandleElement","originalHeight","contentHeight","handleIds","updateDimensions","currentWidth","currentHeight"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,105,106,107,108,109,110,111,112,113]}